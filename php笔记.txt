

一、PHP 语法

    1、基本的 PHP 语法

     PHP 脚本可以放在文档中的任何位置。

     PHP 脚本以 <?php 开始，以 ?> 结束：

             <?php
               // PHP 代码
             ?>


     下面，我们提供了一个简单的 PHP 文件实例，它可以向浏览器输出文本 "Hello World!"：

     实例
     <!DOCTYPE html> 
     <html> 
     <body> 

     <h1>My first PHP page</h1> 

     <?php 
     echo "Hello World!"; 
     ?> 

     </body> 
     </html>

     PHP 中的每个代码行都必须以分号结束。分号是一种分隔符，用于把指令集区分开来。

     通过 PHP，有两种在浏览器输出文本的基础指令：echo 和 print。

           
     2、PHP 中的注释

           实例
           <!DOCTYPE html>
           <html>
           <body>

           <?php
           // 这是 PHP 单行注释

           /*
           这是 
           PHP 多行
           注释
           */
           ?>

           </body>
           </html>


-------------------------------------------------------------------------------------------------------------------------------------------


二、PHP 变量

变量是用于存储信息的"容器"：

        实例
             <?php
              $x=5;
              $y=6;
              $z=$x+$y;
              echo $z;
             ?>

  注意：变量是用于存储数据的容器。


1、PHP 变量

    与代数类似，可以给 PHP 变量赋予某个值（x=5）或者表达式（z=x+y）。

    变量可以是很短的名称（如 x 和 y）或者更具描述性的名称（如 age、carname、totalvolume）。

    PHP 变量规则：

       变量以 $ 符号开始，后面跟着变量的名称

       变量名必须以字母或者下划线字符开始

       变量名只能包含字母数字字符以及下划线（A-z、0-9 和 _ ）

       变量名不能包含空格

       变量名是区分大小写的（$y 和 $Y 是两个不同的变量）

   注意：PHP 语句和 PHP 变量都是区分大小写的。
   

2、创建（声明）PHP 变量

     PHP 没有声明变量的命令。

     变量在您第一次赋值给它的时候被创建：

     实例
       <?php
        $txt="Hello world!";
        $x=5;
        $y=10.5;
       ?>

     在上面的语句执行中，变量 txt 将保存值 Hello world!，且变量 x 将保存值 5。

     注释：当您赋一个文本值给变量时，请在文本值两侧加上引号。


3、PHP 是一门弱类型语言

     在上面的实例中，我们注意到，不必向 PHP 声明该变量的数据类型。

     PHP 会根据变量的值，自动把变量转换为正确的数据类型。

     在强类型的编程语言中，我们必须在使用变量前先声明（定义）变量的类型和名称。


4、PHP 变量作用域

     变量的作用域是脚本中变量可被引用/使用的部分。

     PHP 有四种不同的变量作用域：

        local
        global
        static
        parameter


5、局部和全局作用域

     在所有函数外部定义的变量，拥有全局作用域。除了函数外，全局变量可以被脚本中的任何部分访问，要在一个函数中访问一个全局变量，需要使用 global 关键字。

     在 PHP 函数内部声明的变量是局部变量，仅能在函数内部访问：

     实例：

        <?php 
          $x=5; // 全局变量 

          function myTest() 
          { 
              $y=10; // 局部变量 
              echo "<p>测试函数内变量:<p>"; 
              echo "变量 x 为: $x"; 
              echo "<br>"; 
              echo "变量 y 为: $y"; 
          }  

          myTest(); 

          echo "<p>测试函数外变量:<p>"; 
          echo "变量 x 为: $x"; 
          echo "<br>"; 
          echo "变量 y 为: $y"; 
        ?> 

    运行结果：

        测试函数内变量:

          变量 x 为: 
          变量 y 为: 10

          测试函数外变量:

          变量 x 为: 5
          变量 y 为:


在以上实例中 myTest() 函数定义了 $x 和 $y 变量。 $x 变量在函数外声明，所以它是全局变量 ， $y 变量在函数内声明所以它是局部变量。

当我们调用myTest()函数并输出两个变量的值, 函数将会输出局部变量 $y 的值，但是不能输出 $x 的值，因为 $x 变量在函数外定义，无法在函数内使用，如果要在一个函数中访问一个全局变量，需要使用 global 关键字。

然后我们在myTest()函数外输出两个变量的值，函数将会输出全局部变量 $x 的值，但是不能输出 $y 的值，因为 $y 变量在函数中定义，属于局部变量。


     注意：你可以在不同函数中使用相同的变量名称，因为这些函数内定义的变量名是局部变量，只作用于该函数内。


6、PHP global 关键字

      global 关键字用于函数内访问全局变量。

      在函数内调用函数外定义的全局变量，我们需要在函数中的变量前加上 global 关键字：

      实例：
        <?php 
         $x=5; 
         $y=10; 

         function myTest() 
         { 
             global $x,$y; 
             $y=$x+$y; 
         } 

         myTest(); 
         echo $y; // 输出 15 
        ?> 

       运行结果：15

PHP 将所有全局变量存储在一个名为 $GLOBALS[index] 的数组中。 index 保存变量的名称。这个数组可以在函数内部访问，也可以直接用来更新全局变量。

上面的实例可以写成这样：

       实例：
        <?php
         $x=5;
         $y=10;
 
         function myTest()
         {
             $GLOBALS['y']=$GLOBALS['x']+$GLOBALS['y'];
         } 
 
         myTest();
         echo $y;
        ?>


7、Static 作用域

    当一个函数完成时，它的所有变量通常都会被删除。然而，有时候您希望某个局部变量不要被删除。

    要做到这一点，请在您第一次声明变量时使用 static 关键字：

       实例：
       <?php
         function myTest()
         {
             static $x=0;
             echo $x;
             $x++;
         }
 
         myTest();
         myTest();
         myTest();
       ?>

    然后，每次调用该函数时，该变量将会保留着函数前一次被调用时的值。

    注释：该变量仍然是函数的局部变量。


8、参数作用域

    参数是通过调用代码将值传递给函数的局部变量。

    参数是在参数列表中声明的，作为函数声明的一部分：

    实例：
      <?php
       function myTest($x)
       {
           echo $x;
       }
       myTest(5);
      ?>


总结：
         1、定义在函数外部的就是全局变量，它的作用域从定义处一直到文件结尾。

         2、函数内定义的变量就是局部变量，它的作用域为函数定义范围内。

         3、函数之间存在作用域互不影响。

         4、函数内访问全局变量需要 global 关键字或者使用 $GLOBALS[index] 数组



在 php 中函数是有独立的作用域，所以局部变量会覆盖全局变量，即使局部变量中没有全局变量相同的变量，也会被覆盖。如下：

     <?php
        $a=5;
        $b=3;
        function t()
        {
            echo $a-$b; // 输出 0
        }
        t();
      ?>

要想在函数中直接使用全局变量可以通过 global 关键字声明或者通过 php 中自定义的 $GLOBALS 数组获取:

   <?php
     $a=5;
     $b=3;
     function t1()
     {  
         global $a,$b;
         echo $a-$b;  // 输出 2
     }
     t1();

     echo PHP_EOL;

     function t2()
     {
         echo $GLOBALS['a']-$GLOBALS['b'];  // 输出 2
     }
     t2();
   ?>

-------------------------------------------------------------------------------------------------------------------------------------------


三、PHP 5 echo 和 print 语句

在 PHP 中有两个基本的输出方式： echo 和 print。

1、PHP echo 和 print 语句

      echo 和 print 区别:

             echo - 可以输出一个或多个字符串

             print - 只允许输出一个字符串，返回值总为 1
 
      提示：echo 输出的速度比 print 快， echo 没有返回值，print有返回值1。


2、PHP echo 语句

      echo 是一个语言结构，使用的时候可以不用加括号，也可以加上括号： echo 或 echo()。

      显示字符串

     （1）下面的实例演示了如何使用 echo 命令输出字符串（字符串可以包含 HTML 标签）：
                
               <?php

                  echo "<h2>PHP 很有趣!</h2>";

                  echo "Hello world!<br>";

                  echo "我要学 PHP!<br>";

                  echo "这是一个", "字符串，", "使用了", "多个", "参数。";
                ?>

     （2）下面的实例演示了如何使用 echo 命令输出变量和字符串：

                <?php

                  $txt1="学习 PHP";

                  $txt2="RUNOOB.COM";

                  $cars=array("Volvo","BMW","Toyota");

                  echo $txt1;

                  echo "<br>";

                  echo "在 $txt2 学习 PHP ";

                  echo "<br>";

                  echo "我车的品牌是 {$cars[0]}";
                ?>




3、PHP print 语句

     print 同样是一个语言结构，可以使用括号，也可以不使用括号： print 或 print()。

    （1）下面的实例演示了如何使用 print 命令输出字符串（字符串可以包含 HTML 标签）：

      <?php
        print "<h2>PHP 很有趣!</h2>";
        print "Hello world!<br>";
        print "我要学习 PHP!";
      ?>

    （2）下面的实例演示了如何使用 print 命令输出变量和字符串：

           <?php
                  $txt1="学习 PHP";

                  $txt2="RUNOOB.COM";

                  $cars=array("Volvo","BMW","Toyota");

                  print $txt1;

                  print "<br>";

                  print "在 $txt2 学习 PHP ";

                  print "<br>";

                  print "我车的品牌是 {$cars[0]}";
             ?>


-------------------------------------------------------------------------------------------------------------------------------------------

四、PHP EOF(heredoc) 使用说明

      PHP EOF(heredoc)是一种在命令行shell（如sh、csh、ksh、bash、PowerShell和zsh）和程序语言（像Perl、PHP、Python和Ruby）里定义一个字串的方法。

      使用概述：

          1. 必须后接分号，否则编译通不过。

          2. EOF 可以用任意其它字符代替，只需保证结束标识与开始标识一致。

          3. 结束标识必须顶格独自占一行(即必须从行首开始，前后不能衔接任何空白和字符)。

          4. 开始标识可以不带引号或带单双引号，不带引号与带双引号效果一致，解释内嵌的变量和转义符号，带单引号则不解释内嵌的变量和转义符号。

          5. 当内容需要内嵌引号（单引号或双引号）时，不需要加转义符，本身对单双引号转义，此处相当与q和qq的用法。


      实例
          <?php
             echo <<<EOF
                <h1>我的第一个标题</h1>
                <p>我的第一个段落。</p>
             EOF;
             // 结束需要独立一行且前后不能空格
          ?>


      注意：
          1.以 <<<EOF 开始标记开始，以 EOF 结束标记结束，结束标记必须顶头写，不能有缩进和空格，且在结束标记末尾要有分号 。

          2.开始标记和结束标记相同，比如常用大写的 EOT、EOD、EOF 来表示，但是不只限于那几个(也可以用：JSON、HTML等)，只要保证开始标记和结束标记不在正文中出现即可。

          3.位于开始标记和结束标记之间的变量可以被正常解析，但是函数则不可以。在 heredoc 中，变量不需要用连接符 . 或 , 来拼接，如下：

                   实例1
                   <?php
                     $name="runoob";
                     $a= <<<EOF
                          "abc"$name
                          "123"
                      EOF;
                      // 结束需要独立一行且前后不能空格
                      echo $a;
                   ?>




       1.PHP 定界符 EOF 的作用就是按照原样，包括换行格式什么的，输出在其内部的东西；

       2.在 PHP 定界符 EOF 中的任何特殊字符都不需要转义；

       3.PHP 定界符 EOF


        实例2:
              <?php
                  $name="变量会被解析";

                  $a=<<<EOF

                  $name<br><a>html格式会被解析</a><br/>双引号和Html格式外的其他内容都不会被解析

                  "双引号外所有被排列好的格式都会被保留"

                  "但是双引号内会保留转义符的转义效果,比如table:\t和换行：\n下一行"

                  EOF;

                  echo $a;
               ?> 


           运行结果：

               变量会被解析

               html格式会被解析

               双引号和Html格式外的其他内容都不会被解析 "双引号外所有被排列好的格式都会被保留" "但是双引号内会保留转义符的转义效果,比如table:	和换行： 下一行"


-------------------------------------------------------------------------------------------------------------------------------------------


五、PHP 5 数据类型
      
              String（字符串）, 

              Integer（整型）, 

              Float（浮点型）,

              Boolean（布尔型）,

              Array（数组）,

              Object（对象）, 

              NULL（空值）。


    1、PHP 字符串

          一个字符串是一串字符的序列，就像 "Hello world!"。

          你可以将任何文本放在单引号和双引号中：

            实例：
            <!DOCTYPE html>
            <html>
            <body>
                <?php 
                   $x = "Hello world!";
                   echo $x;
                   echo "<br>"; 
                   $x = 'Hello world!';
                   echo $x;
                ?>
             </body>
             </html>


     2、PHP 整型

          整数是一个没有小数的数字。

               整数规则:

                  整数必须至少有一个数字 (0-9)

                  整数不能包含逗号或空格

                  整数是没有小数点的

                  整数可以是正数或负数

                  整型可以用三种格式来指定：十进制， 十六进制（ 以 0x 为前缀）或八进制（前缀为 0）。

          在以下实例中我们将测试不同的数字。

          PHP var_dump() 函数返回变量的数据类型和值：

                        <!DOCTYPE html>
                        <html>
                        <body>
                              <?php 
                              $x = 5985;
                              var_dump($x);
                              echo "<br>"; 
                              $x = -345; // 负数
                              var_dump($x);
                              echo "<br>"; 
                              $x = 0x8C; // 十六进制数
                              var_dump($x);
                              echo "<br>";
                              $x = 047; // 八进制数
                              var_dump($x);
                              ?>   
                        </body>
                        </html>

                 运行结果：
                         int(5985) 
                         int(-345) 
                         int(140) 
                         int(39)
      

         #################################################################

            额外知识：

               ① PHP var_dump() 函数

                     var_dump() 函数用于输出变量的相关信息。

                     var_dump() 函数显示关于一个或多个表达式的结构信息，包括表达式的类型与值。数组将递归展开值，通过缩进显示其结构。

                     PHP 版本要求: PHP 4, PHP 5, PHP 7

                    语法：void var_dump ( mixed $expression [, mixed $... ] )

                    参数说明：

                              $expression: 你要输出的变量。   

                    返回值：没有返回值。    


                    实例1：
                             <?php
                                  $a = array(1, 2, array("a", "b", "c"));

                                  var_dump($a);
                              ?>

                             输出结果为：

                                  array(3) {
                                    [0]=>
                                    int(1)
                                    [1]=>
                                    int(2)
                                    [2]=>
                                    array(3) {
                                      [0]=>
                                      string(1) "a"
                                      [1]=>
                                      string(1) "b"
                                      [2]=>
                                      string(1) "c"
                                    }
                                  }

                    实例2：

                              <?php
                                  $b = 3.1;

                                  $c = true;

                                  var_dump($b, $c);
                              ?>

                              输出结果为：

                                  float(3.1)
                                  bool(true)



         #################################################################

    
     3、PHP 浮点型

          浮点数是带小数部分的数字，或是指数形式。

          在以下实例中我们将测试不同的数字。 PHP var_dump() 函数返回变量的数据类型和值：

           实例：
               <?php 

                  $x = 10.365;

                  var_dump($x);

                  echo "<br>"; 

                  $x = 2.4e3;

                  var_dump($x);

                  echo "<br>"; 

                  $x = 8E-5;

                  var_dump($x);
                ?>

            运行结果：
                  float(10.365) 
                  float(2400) 
                  float(8.0E-5)


        
     4、PHP 布尔型

           布尔型可以是 TRUE 或 FALSE。

                 $x=true;

                 $y=false;

              布尔型通常用于条件判断。在接下来的章节中你会学到更多关于条件控制的教程。

 
     5、PHP 数组

          数组可以在一个变量中存储多个值。

          在以下实例中创建了一个数组， 然后使用 PHP var_dump() 函数返回数组的数据类型和值：

             <!DOCTYPE html>
             <html>
             <body>
                 <?php 
                     $cars=array("Volvo","BMW","Toyota");
                     var_dump($cars);
                  ?>   
             </body>
             </html>

           运行结果：              
                array(3) { [0]=> string(5) "Volvo" [1]=> string(3) "BMW" [2]=> string(6) "Toyota" }


     6、PHP 对象

          对象数据类型也可以用于存储数据。

          在 PHP 中，对象必须声明。

          首先，你必须使用class关键字声明类对象。类是可以包含属性和方法的结构。

          然后我们在类中定义数据类型，然后在实例化的类中使用数据类型：

<!DOCTYPE html>
<html>
<body>

<?php
class Car
{
    var $color;
    function __construct($color="green") {
      $this->color = $color;
    }
    function what_color() {
      return $this->color;
    }
}

function print_vars($obj) {
   foreach (get_object_vars($obj) as $prop => $val) {
     echo "\t$prop = $val\n";
   }
}

// 实例一个对象
$herbie = new Car("white");

// 显示 herbie 属性
echo "\therbie: Properties\n";
print_vars($herbie);
echo "what_color:". $herbie->what_color();   //对象调用自己的方法

?>  

</body>
</html>


运行结果：herbie: Properties color = white

以上实例中PHP关键字this就是指向当前对象实例的指针，不指向任何其他对象或类。



     7、PHP NULL 值

           NULL 值表示变量没有值。NULL 是数据类型为 NULL 的值。

           NULL 值指明一个变量是否为空值。 同样可用于数据空值和NULL值的区别。

           可以通过设置变量值为 NULL 来清空变量数据：

           实例：

                  <!DOCTYPE html>
                  <html>
                  <body>
                      <?php
                          $x="Hello world!";
                          $x=null;
                          var_dump($x);
                       ?>
                  </body>
                  </html>
     
            运行结果:  NULL


       ###############################################################################

          额外笔记：
                    var_dump():

                         var_dump() 方法，判断一个变量的类型与长度，并输出变量的数值，如果变量有值，则输出是变量的值，并返回数据类型。显示关于一个或多个表达式的结构信息，包括表达式的类型与值。数组将递归展开值，通过缩进显示其结构。

                         格式：
                               var_dump ( mixed expression [, mixed expression [, ...]] )

                    注意：用保证 var_dump 中的变量必须是存在的，如果变量不存在则返回 NULL。该函数有输出的功能，因此不必加其它的输出函数。


                    echo，print，print_r，var_dump 的区别:

                         1.echo

                                 输出一个或者多个字符串。

                         2.print

                                 和 echo 一样，速度 比 echo 慢。

                         3.print_r

                                 打印关于变量的易于理解的信息,如果给出的是 string、integer 或 float，将打印变量值本身。如果给出的是 array，将会按照一定格式显示键和元素。object 与数组类似。 记住，print_r() 将把数组的指针移到最后边。使用 reset() 可让指针回到开始处。

                         4.var_dump

                                 此函数显示关于一个或多个表达式的结构信息，包括表达式的类型与值。数组将递归展开值，通过缩进显示其结构。

                         5.var_dump 和 print_r 的区别

                                 var_dump 返回表达式的类型与值而 print_r 仅返回结果，相比调试代码使用 var_dump 更便于阅读。


        ###############################################################################



-------------------------------------------------------------------------------------------------------------------------------------------

 六、PHP 5 常量

             常量值被定义后，在脚本的其他任何地方都不能被改变。


      1、PHP 常量

             常量是一个简单值的标识符。该值在脚本中不能改变。

             一个常量由英文字母、下划线、和数字组成,但数字不能作为首字母出现。 (常量名不需要加 $ 修饰符)。

             注意： 常量在整个脚本中都可以使用。


      2、设置 PHP 常量

             设置常量，使用 define() 函数，函数语法如下：

                  bool define ( string $name , mixed $value [, bool $case_insensitive = false ] )

                       该函数有三个参数:

                            name：必选参数，常量名称，即标志符。

                            value：必选参数，常量的值。

                            case_insensitive ：可选参数，如果设置为 TRUE，该常量则大小写不敏感。默认是大小写敏感的


             ①以下实例我们创建一个 区分大小写的常量, 常量值为 "欢迎访问 Runoob.com"：

                  实例
                         <?php

                            // 区分大小写的常量名

                            define("GREETING", "欢迎访问 Runoob.com");

                            echo GREETING;    // 输出 "欢迎访问 Runoob.com"

                            echo '<br>';

                            echo greeting;   // 输出 "greeting"

                         ?>

             ②以下实例我们创建一个 不区分大小写的常量, 常量值为 "欢迎访问 Runoob.com"：

                  实例
                        <?php

                            // 不区分大小写的常量名

                            define("GREETING", "欢迎访问 Runoob.com", true);

                            echo greeting;  // 输出 "欢迎访问 Runoob.com"
                        ?>

      3、常量是全局的

               常量在定义后，默认是全局变量，可以在整个运行的脚本的任何地方使用。

               以下实例演示了在函数内使用常量，即便常量定义在函数外也可以正常使用常量。

                 实例
                 <?php
                    define("GREETING", "欢迎访问 Runoob.com");
 
                    function myTest() {
                       echo GREETING;
                    }
 
                    myTest();    // 输出 "欢迎访问 Runoob.com"
                 ?>


-------------------------------------------------------------------------------------------------------------------------------------------


  七、PHP 字符串变量
 
         字符串变量用于存储并处理文本。

       1、PHP 中的字符串变量

           字符串变量用于包含有字符的值。

           在创建字符串之后，我们就可以对它进行操作了。您可以直接在函数中使用字符串，或者把它存储在变量中。

           在下面的实例中，我们创建一个名为 txt 的字符串变量，并赋值为 "Hello world!" 。然后我们输出 txt 变量的值：

                                          <?php 
                                             $txt="Hello world!"; 
                                             echo $txt; 
                                          ?>


                                   运行结果：Hello world!


	    注释：当您赋一个文本值给变量时，请记得给文本值加上单引号或者双引号。 


       2、PHP 并置运算符

            在 PHP 中，只有一个字符串运算符。

            并置运算符 (.) 用于把两个字符串值连接起来。

            下面的实例演示了如何将两个字符串变量连接在一起：

                     <?php 
                           $txt1="Hello world!"; 

                           $txt2="What a nice day!"; 

                           echo $txt1 . " " . $txt2; 
                      ?>


              上面的代码将输出：Hello world! What a nice day!

              提示：在上面的代码中，我们已经使用了两次并置运算符。这是由于我们需要在两个字符串之间插入一个空格


       3、PHP strlen() 函数

            有时知道字符串值的长度是很有用的。

            strlen() 函数返回字符串的长度（字符数）。

            下面的实例返回字符串 "Hello world!" 的长度：

                 <?php 
                        echo strlen("Hello world!"); 
                 ?>

             上面的代码将输出：12

             提示：strlen() 常常用在循环和其他函数中，因为那时确定字符串何时结束是很重要的。（例如，在循环中，我们需要在字符串中的最后一个字符之后结束循环。）



       4、PHP strpos() 函数

            strpos() 函数用于在字符串内查找一个字符或一段指定的文本。

            如果在字符串中找到匹配，该函数会返回第一个匹配的字符位置。如果未找到匹配，则返回 FALSE。

            下面的实例在字符串 "Hello world!" 中查找文本 "world"：

               <?php 
                     echo strpos("Hello world!","world"); 
               ?>

               上面的代码将输出：6

             提示：在上面的实例中，字符串 "world" 的位置是 6。之所以是 6 而不是 7 的原因是，字符串中第一个字符的位置是 0，而不是 1。


-------------------------------------------------------------------------------------------------------------------------------------------


 八、PHP 运算符


     在 PHP 中，赋值运算符 = 用于给变量赋值。

     在 PHP 中，算术运算符 + 用于把值加在一起。


    1、PHP 算术运算符

        以下实例演示了使用不同算术运算符得到的不同结果：

         <?php 
              $x=10; 
              $y=6;
              echo ($x + $y); // 输出16
              echo '<br>';  // 换行
 
              echo ($x - $y); // 输出4
              echo '<br>';  // 换行
 
              echo ($x * $y); // 输出60
              echo '<br>';  // 换行
 
              echo ($x / $y); // 输出1.6666666666667
              echo '<br>';  // 换行
 
              echo ($x % $y); // 输出4
              echo '<br>';  // 换行
 
              echo -$x;
          ?>


         注意：PHP7+ 版本新增整除运算符 intdiv(),使用实例：

             <?php
                   var_dump(intdiv(10, 3));
             ?>

         以上实例会输出：  int(3)


    2、PHP 赋值运算符

        在 PHP 中，基本的赋值运算符是 "="。它意味着左操作数被设置为右侧表达式的值。也就是说，"$x = 5" 的值是 5。

        ①、以下实例演示了使用不同赋值运算符得到的不同结果：

           <?php 
              $x=10; 
              echo $x; // 输出10
 
              $y=20; 
              $y += 100;
              echo $y; // 输出120
 
              $z=50;
              $z -= 25;
              echo $z; // 输出25
 
              $i=5;
              $i *= 6;
              echo $i; // 输出30
 
              $j=10;
              $j /= 5;
              echo $j; // 输出2
 
              $k=15;
              $k %= 4;
              echo $k; // 输出3
           ?>


       ②、以下实例演示了使用不同字符串运算符得到的相同结果：

            <?php
              $a = "Hello";
              $b = $a . " world!";
              echo $b; // 输出Hello world! 
 
              $x="Hello";
              $x .= " world!";
              echo $x; // 输出Hello world! 
            ?>


    3、PHP 递增/递减运算符

        以下实例演示了使用递增/递减运算符得到的结果：

            <?php
              $x=10; 
              echo ++$x; // 输出11
 
              $y=10; 
              echo $y++; // 输出10
 
              $z=5;
              echo --$z; // 输出4
 
              $i=5;
              echo $i--; // 输出5
            ?>


    4、PHP 比较运算符

        以下实例演示了使用一些比较运算符得到的不同结果：

            <?php
              $x=100; 
              $y="100";
 
              var_dump($x == $y);
              echo "<br>";
              var_dump($x === $y);
              echo "<br>";
              var_dump($x != $y);
              echo "<br>";
              var_dump($x !== $y);
              echo "<br>";
 
              $a=50;
              $b=90;
 
              var_dump($a > $b);
              echo "<br>";
              var_dump($a < $b);
            ?>

        运行结果：
               bool(true) 
               bool(false) 
               bool(false) 
               bool(true) 
               bool(false) 
               bool(true)


    5、PHP 逻辑运算符

           x and y	与	如果 x 和 y 都为 true，则返回 true	实例： x=6  y=3  (x < 10 and y > 1) 返回 true

           x or y	或	如果 x 和 y 至少有一个为 true，则返回 true  实例： x=6 y=3   (x==6 or y==5) 返回 true

           x xor y	异或	如果 x 和 y 有且仅有一个为 true，则返回 true  实例：x=6 y=3   (x==6 xor y==3) 返回 false

           x && y	与	如果 x 和 y 都为 true，则返回 true   实例：x=6 y=3 (x < 10 && y > 1) 返回 true

           x || y	或	如果 x 和 y 至少有一个为 true，则返回 true  实例： x=6  y=3  (x==5 || y==5) 返回 false

           ! x	非	如果 x 不为 true，则返回 true	x=6  y=3  实例：  !(x==y) 返回 true




    6、PHP 数组运算符

          x + y	集合	x 和 y 的集合

          x == y	相等	如果 x 和 y 具有相同的键/值对，则返回 true

          x === y	恒等	如果 x 和 y 具有相同的键/值对，且顺序相同类型相同，则返回 true

          x != y	不相等	如果 x 不等于 y，则返回 true

          x <> y	不相等	如果 x 不等于 y，则返回 true

          x !== y	不恒等	如果 x 不等于 y，则返回 true

        以下实例演示了使用一些数组运算符得到的不同结果：

         <?php
               $x = array("a" => "red", "b" => "green"); 
               $y = array("c" => "blue", "d" => "yellow"); 
               $z = $x + $y; // $x 和 $y 数组合并
               var_dump($z);
               var_dump($x == $y);
               var_dump($x === $y);
               var_dump($x != $y);
               var_dump($x <> $y);
               var_dump($x !== $y);
          ?>

         运行结果：
                   array(4) { ["a"]=> string(3) "red" ["b"]=> string(5) "green" ["c"]=> string(4) "blue" ["d"]=> string(6) "yellow" } 
                   bool(false) 
                   bool(false) 
                   bool(true) 
                   bool(true) 
                   bool(true)


    7、三元运算符

         另一个条件运算符是"?:"（或三元）运算符 。

         语法格式：(expr1) ? (expr2) : (expr3) 


         注意：对 expr1 求值为 TRUE 时的值为 expr2，在 expr1 求值为 FALSE 时的值为 expr3。

               自 PHP 5.3 起，可以省略三元运算符中间那部分。表达式 expr1 ?: expr3 在 expr1 求值为 TRUE 时返回 expr1，否则返回 expr3。

         实例：

            以下实例中通过判断 $_GET 请求中含有 user 值，如果有返回 $_GET['user']，否则返回 nobody：

               <?php

                 $test = '菜鸟教程';
                 // 普通写法
                 $username = isset($test) ? $test : 'nobody';
                 echo $username, PHP_EOL;
 
                 // PHP 5.3+ 版本写法
                 $username = $test ?: 'nobody';
                 echo $username, PHP_EOL;

               ?>

               运行结果：
                           菜鸟教程
                           菜鸟教程

         注意：PHP_EOL 是一个换行符，兼容更大平台

         在 PHP7+ 版本多了一个 NULL 合并运算符 ??，实例如下：

             <?php
                  // 如果 $_GET['user'] 不存在返回 'nobody'，否则返回 $_GET['user'] 的值
                  $username = $_GET['user'] ?? 'nobody';
                  // 类似的三元运算符
                  $username = isset($_GET['user']) ? $_GET['user'] : 'nobody';
             ?>


    8、组合比较符(PHP7+)

         PHP7+ 支持组合比较符（combined comparison operator）也称之为太空船操作符，符号为 <=>。组合比较运算符可以轻松实现两个变量的比较，当然不仅限于数值类数据的比较。

         语法格式如下：

              $c = $a <=> $b;

              解析如下：

                  如果 $a > $b, 则 $c 的值为 1。

                  如果 $a == $b, 则 $c 的值为 0。

                  如果 $a < $b, 则 $c 的值为 -1。


          实例如下：

              实例
                   <?php
                        // 整型
                        echo 1 <=> 1; // 0
                        echo 1 <=> 2; // -1
                        echo 2 <=> 1; // 1
 
                        // 浮点型
                        echo 1.5 <=> 1.5; // 0
                        echo 1.5 <=> 2.5; // -1
                        echo 2.5 <=> 1.5; // 1
 
                        // 字符串
                        echo "a" <=> "a"; // 0
                        echo "a" <=> "b"; // -1
                        echo "b" <=> "a"; // 1
                    ?>


    9、运算符优先级

         下表按照优先级从高到低列出了运算符。同一行中的运算符具有相同优先级，此时它们的结合方向决定求值顺序。

           http://www.runoob.com/php/php-operators.html

         注意：运算符优先级中，or 和 ||，&& 和 and 都是逻辑运算符，效果一样，但是其优先级却不一样。

         实例
             <?php
                  // 优先级： &&  >  =  >  and
                  // 优先级： ||  >  =  >  or
 
                  $a = 3;
                  $b = false;
                  $c = $a or $b;
                  var_dump($c);          // 这里的 $c 为 int 值3，而不是 boolean 值 true
                  $d = $a || $b;
                  var_dump($d);          // 这里的 $d 就是 boolean 值 true 
              ?>

             以上实例输出结果为：
                                  int(3)
                                  bool(true)


    10、括号的使用

         我们通过括号的配对来明确标明运算顺序，而非靠运算符优先级和结合性来决定，通常能够增加代码的可读性。

            实例
                <?php
                      // 括号优先运算
 
                      $a = 1;
                      $b = 2;
                      $c = 3;
                      $d = $a + $b * $c;
                      echo $d;
                      echo "\n";
                      $e = ($a + $b) * $c;  // 使用括号
                      echo $e;
                      echo "\n";
                  ?>

             以上实例输出结果为：
                                 7
                                 9



-------------------------------------------------------------------------------------------------------------------------------------------


九、PHP If...Else 语句

     1、PHP 条件语句

           在 PHP 中，提供了下列条件语句：

                       if 语句 - 在条件成立时执行代码

                       if...else 语句 - 在条件成立时执行一块代码，条件不成立时执行另一块代码

                       if...elseif....else 语句 - 在若干条件之一成立时执行一个代码块

                       switch 语句 - 在若干条件之一成立时执行一个代码块

     2、PHP - if 语句

           if 语句用于仅当指定条件成立时执行代码。

           语法
             if (条件)
              {
                  条件成立时要执行的代码;
               }

           如果当前时间小于 20，下面的实例将输出 "Have a good day!"：

             实例
                <?php
                   $t=date("H");
                   if ($t<"20")
                  {
                     echo "Have a good day!";
                  }
                ?>


     3、PHP - if...else 语句

           在条件成立时执行一块代码，条件不成立时执行另一块代码，请使用 if....else 语句。

           语法
                if (条件)
                {
                     条件成立时执行的代码;
                }
                     else
                {
                     条件不成立时执行的代码;
                }

           实例：
           如果当前时间小于 20，下面的实例将输出 "Have a good day!"，否则输出 "Have a good night!"：

                <?php
                  $t=date("H");
                  if ($t<"20")
                  {
                      echo "Have a good day!";
                  }
                  else
                  {
                      echo "Have a good night!";
                  }
                ?>


      4、PHP - if...elseif....else 语句

           在若干条件之一成立时执行一个代码块，请使用 if....elseif...else 语句。

           语法
                  if (条件)
                  {
                      if 条件成立时执行的代码;
                  }
                  elseif (条件)
                  {
                      elseif 条件成立时执行的代码;
                  }
                  else
                  {
                      条件不成立时执行的代码;
                  }

          如果当前时间小于 10，下面的实例将输出 "Have a good morning!"，如果当前时间不小于 10 且小于 20，则输出 "Have a good day!"，否则输出 "Have a good night!"： 

                  <?php
                        $t=date("H");
                        if ($t<"10")
                        {
                            echo "Have a good morning!";
                        }
                        elseif ($t<"20")
                        {
                            echo "Have a good day!";
                        }
                        else
                        {
                            echo "Have a good night!";
                        }
                  ?>

-------------------------------------------------------------------------------------------------------------------------------------------

十、PHP Switch 语句

     switch 语句用于根据多个不同条件执行不同动作

     1、PHP Switch 语句

         如果您希望有选择地执行若干代码块之一，请使用 switch 语句。

         语法
            <?php
              switch (n)
              {
              case label1:
                  如果 n=label1，此处代码将执行;
                  break;
              case label2:
                  如果 n=label2，此处代码将执行;
                  break;
              default:
                  如果 n 既不等于 label1 也不等于 label2，此处代码将执行;
              }
            ?>

        工作原理：
                 首先对一个简单的表达式 n（通常是变量）进行一次计算。将表达式的值与结构中每个 case 的值进行比较。如果存在匹配，则执行与 case 关联的代码。代码执行后，使用 break 来阻止代码跳入下一个 case 中继续执行。default 语句用于不存在匹配（即没有 case 为真）时执行。

        实例
            <?php
                 $favcolor="red";
                 switch ($favcolor)
                 {
                 case "red":
                     echo "你喜欢的颜色是红色!";
                     break;
                 case "blue":
                     echo "你喜欢的颜色是蓝色!";
                     break;
                 case "green":
                     echo "你喜欢的颜色是绿色!";
                     break;
                 default:
                     echo "你喜欢的颜色不是 红, 蓝, 或绿色!";
                 }
            ?>

        在 switch 语句中漏写 break, 可能会使你的输出在你意料之外，下面我来和你们仔细讲解 break 的作用：

               下面的代码是正确示范，结果将是只会输出：这里是a。

                   倘若你忘敲了 case 'a'，case 'b',case 'c' 后的 break，结果将是将代码中的每一条输出语句都输出。

                   倘若你只敲了 case 'c' 后的 break, 结果将会是输出包含 case 'c' 之前的所有输出语句。

                   讲到这里大家应该明白了：原来 switch 语句不遇到 break 将不会自己"拐弯"，希望这些将会帮助到才接触 php 的菜鸟们！


-------------------------------------------------------------------------------------------------------------------------------------------

十一、PHP 数组

        数组能够在单个变量中存储多个值：

        实例
          <?php
                $cars=array("Volvo","BMW","Toyota");
                echo "I like " . $cars[0] . ", " . $cars[1] . " and " . $cars[2] . ".";
          ?>

      1、数组是什么？
  
                数组是一个能在单个变量中存储多个值的特殊变量。

           如果您有一个项目清单（例如：车名字的清单），将其存储到单个变量中，如下所示：

                            $cars1="Volvo";

                            $cars2="BMW";
  
                            $cars3="Toyota";

           然而，如果您想要遍历数组并找出特定的一个呢？如果数组的项不只 3 个而是 300 个呢？
  
              解决办法是创建一个数组！

           数组可以在单个变量中存储多个值，并且您可以根据键访问其中的值。


      2、在 PHP 中创建数组

           在 PHP 中，array() 函数用于创建数组：

                                                array();

           在 PHP 中，有三种类型的数组：

                   数值数组 - 带有数字 ID 键的数组

                   关联数组 - 带有指定的键的数组，每个键关联一个值

                   多维数组 - 包含一个或多个数组的数组


      3、PHP 数值数组

           这里有两种创建数值数组的方法：

           自动分配 ID 键（ID 键总是从 0 开始）：

                 $cars=array("Volvo","BMW","Toyota");

           人工分配 ID 键：

                 $cars[0]="Volvo";
                 $cars[1]="BMW";
                 $cars[2]="Toyota";

           下面的实例创建一个名为 $cars 的数值数组，并给数组分配三个元素,然后打印一段包含数组值的文本：

                实例
                      <?php
                              $cars=array("Volvo","BMW","Toyota");

                              echo "I like " . $cars[0] . ", " . $cars[1] . " and " . $cars[2] . ".";
                      ?>


      4、获取数组的长度 - count() 函数

           count() 函数用于返回数组的长度（元素的数量）：

              <?php
                     $cars=array("Volvo","BMW","Toyota");

                     echo count($cars);
              ?>


      5、遍历数值数组

           遍历并打印数值数组中的所有值，您可以使用 for 循环，如下所示：

           实例
              <?php

                $cars=array("Volvo","BMW","Toyota");
                $arrlength=count($cars);
 
                for($x=0;$x<$arrlength;$x++)
                {
                    echo $cars[$x];
                    echo "<br>";
                }

              ?>


      6、PHP 关联数组

          关联数组是使用您分配给数组的指定的键的数组。

          这里有两种创建关联数组的方法：

                    ①、$age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");

                    ②、$age['Peter']="35";
                        $age['Ben']="37";
                        $age['Joe']="43";

          随后可以在脚本中使用指定的键：

              实例
                  <?php
                         $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
                         echo "Peter is " . $age['Peter'] . " years old.";
                  ?>


      7、遍历关联数组

          遍历并打印关联数组中的所有值，您可以使用 foreach 循环，如下所示：

                   <?php
                         $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
 
                         foreach($age as $x=>$x_value)
                         {
                             echo "Key=" . $x . ", Value=" . $x_value;
                             echo "<br>";
                         }
                    ?>



-------------------------------------------------------------------------------------------------------------------------------------------

 十二、PHP 数组排序

    数组中的元素可以按字母或数字顺序进行降序或升序排列。

    1、PHP - 数组排序函数

        在本章中，我们将一一介绍下列 PHP 数组排序函数：

                                sort() - 对数组进行升序排列

                                rsort() - 对数组进行降序排列

                                asort() - 根据关联数组的值，对数组进行升序排列

                                ksort() - 根据关联数组的键，对数组进行升序排列

                                arsort() - 根据关联数组的值，对数组进行降序排列

                                krsort() - 根据关联数组的键，对数组进行降序排列

 
    2、sort() - 对数组进行升序排列

        ①、下面的实例将 $cars 数组中的元素按照字母升序排列：

             <?php
                  $cars=array("Volvo","BMW","Toyota");
                  sort($cars);
             ?>

        ②、下面的实例将 $numbers 数组中的元素按照数字升序排列：

            <?php
                  $numbers=array(4,6,2,22,11);
                  sort($numbers);
            ?>


   3、rsort() - 对数组进行降序排列

        ①、下面的实例将 $cars 数组中的元素按照字母降序排列：

             <?php
                  $cars=array("Volvo","BMW","Toyota");
                  rsort($cars);
             ?>


        ②、下面的实例将 $numbers 数组中的元素按照数字降序排列：

             <?php
                  $numbers=array(4,6,2,22,11);
                  rsort($numbers);
             ?>


   4、asort() - 根据数组的值，对数组进行升序排列

        ①、下面的实例根据数组的值，对关联数组进行升序排列：

             <?php
                  $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
                  asort($age);
             ?>


   5、ksort() - 根据数组的键，对数组进行升序排列

        ①、下面的实例根据数组的键，对关联数组进行升序排列：

             <?php
                  $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
                  ksort($age);
             ?>

   6、arsort() - 根据数组的值，对数组进行降序排列

        ①、下面的实例根据数组的值，对关联数组进行降序排列：

             <?php
                 $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
                 arsort($age);
             ?>


   7、krsort() - 根据数组的键，对数组进行降序排列

        ①、下面的实例根据数组的键，对关联数组进行降序排列：

             <?php
                 $age=array("Peter"=>"35","Ben"=>"37","Joe"=>"43");
                 krsort($age);
             ?>


-------------------------------------------------------------------------------------------------------------------------------------------

 十三、PHP 超级全局变量

      超级全局变量在PHP 4.1.0之后被启用, 是PHP系统中自带的变量，在一个脚本的全部作用域中都可用。

      1、PHP 超级全局变量

          PHP中预定义了几个超级全局变量（superglobals） ，这意味着它们在一个脚本的全部作用域中都可用。 你不需要特别说明，就可以在函数及类中使用。

          PHP 超级全局变量列表:
                                   $GLOBALS
                                   $_SERVER
                                   $_REQUEST
                                   $_POST
                                   $_GET
                                   $_FILES
                                   $_ENV
                                   $_COOKIE
                                   $_SESSION


      2、PHP $GLOBALS

          $GLOBALS 是PHP的一个超级全局变量组，在一个PHP脚本的全部作用域中都可以访问。

          $GLOBALS 是一个包含了全部变量的全局组合数组。变量的名字就是数组的键。

          以下实例介绍了如何使用超级全局变量 $GLOBALS:

                                 <?php 
                                        $x = 75; 
                                        $y = 25;
 
                                        function addition() 
                                        { 
                                            $GLOBALS['z'] = $GLOBALS['x'] + $GLOBALS['y']; 
                                        }
 
                                        addition(); 
                                        echo $z; 
                                  ?>

          以上实例中 z 是一个$GLOBALS数组中的超级全局变量，该变量同样可以在函数外访问。


      3、PHP $_SERVER

          $_SERVER 是一个包含了诸如头信息(header)、路径(path)、以及脚本位置(script locations)等等信息的数组。这个数组中的项目由 Web 服务器创建。不能保证每个服务器都提供全部项目；服务器可能会忽略一些，或者提供一些没有在这里列举出来的项目。

          以下实例中展示了如何使用$_SERVER中的元素:

                                  <?php 
                                        echo $_SERVER['PHP_SELF'];
                                        echo "<br>";
                                        echo $_SERVER['SERVER_NAME'];
                                        echo "<br>";
                                        echo $_SERVER['HTTP_HOST'];
                                        echo "<br>";
                                        echo $_SERVER['HTTP_REFERER'];
                                        echo "<br>";
                                        echo $_SERVER['HTTP_USER_AGENT'];
                                        echo "<br>";
                                        echo $_SERVER['SCRIPT_NAME'];
                                   ?>


                  运行结果：
                           /try/demo_source/demo_global_server.php
                           www.runoob.com
                           www.runoob.com
                           http://www.runoob.com/try/showphp.php?filename=demo_global_server
                           Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.62 Safari/537.36
                           /try/demo_source/demo_global_server.php



           注意： 所有 $_SERVER 变量中的重要元素 ： 参考http://www.runoob.com/php/php-superglobals.html



      4、PHP $_REQUEST

            PHP $_REQUEST 用于收集HTML表单提交的数据。

            以下实例显示了一个输入字段（input）及提交按钮(submit)的表单(form)。 当用户通过点击 "Submit" 按钮提交表单数据时, 表单数据将发送至<form>标签中 action 属性中指定的脚本文件。
             在这个实例中，我们指定文件来处理表单数据。如果你希望其他的PHP文件来处理该数据，你可以修改该指定的脚本文件名。 然后，我们可以使用超级全局变量 $_REQUEST 来收集表单中的 input 字段数据:

                                            <html>
                                              <body>
                                                 <form method="post" action="<?php echo $_SERVER['PHP_SELF'];?>">

                                                     Name: <input type="text" name="fname">
                                                     <input type="submit">

                                                 </form>
 
                                                 <?php 
                                                        $name = $_REQUEST['fname']; 
                                                        echo $name; 
                                                  ?>
                                              </body>
                                            </html>


      5、PHP $_POST

            PHP $_POST 被广泛应用于收集表单数据，在HTML form标签的指定该属性："method="post"。

            以下实例显示了一个输入字段（input）及提交按钮(submit)的表单(form)。 当用户通过点击 "Submit" 按钮提交表单数据时, 表单数据将发送至<form>标签中 action 属性中指定的脚本文件。 
            在这个实例中，我们指定文件来处理表单数据。如果你希望其他的PHP文件来处理该数据，你可以修改该指定的脚本文件名。 然后，我们可以使用超级全局变量 $_POST 来收集表单中的 input 字段数据:

                                            <html>
                                              <body>
 
                                                  <form method="post" action="<?php echo $_SERVER['PHP_SELF'];?>">
                                                        Name: <input type="text" name="fname">
                                                        <input type="submit">
                                                  </form>
 
                                                  <?php 
                                                     $name = $_POST['fname']; 
                                                     echo $name; 
                                                  ?>
                                              </body>
                                            </html>


      6、PHP $_GET

            PHP $_GET 同样被广泛应用于收集表单数据，在HTML form标签的指定该属性："method="get"。

            $_GET 也可以收集URL中发送的数据。

            假定我们有一个包含参数的超链接HTML页面：

                            <html>
                                <body>
                                  <a href="test_get.php?subject=PHP&web=runoob.com">Test $GET</a>
                                </body>
                            </html>

            当用户点击链接 "Test $GET", 参数 "subject" 和 "web" 将发送至"test_get.php",你可以在 "test_get.php" 文件中使用 $_GET 变量来获取这些数据。
            以下实例显示了 "test_get.php" 文件的代码:

                <html>
                   <body>
                      <?php 
                            echo "Study " . $_GET['subject'] . " @ " . $_GET['web'];
                      ?>
                   </body>
                </html>


-------------------------------------------------------------------------------------------------------------------------------------------

十四、PHP 循环 - While 循环

        循环执行代码块指定的次数，或者当指定的条件为真时循环执行代码块。

        1、PHP 循环

            在您编写代码时，您经常需要让相同的代码块一次又一次地重复运行。我们可以在代码中使用循环语句来完成这个任务。

            在 PHP 中，提供了下列循环语句：

                  while - 只要指定的条件成立，则循环执行代码块

                  do...while - 首先执行一次代码块，然后在指定的条件成立时重复这个循环

                  for - 循环执行代码块指定的次数

                  foreach - 根据数组中每个元素来循环代码块


        2、while 循环

            while 循环将重复执行代码块，直到指定的条件不成立。

            语法
                   while (条件)
                   {
                           要执行的代码;
                    }

            实例
                下面的实例首先设置变量 i 的值为 1 ($i=1;)。

                然后，只要 i 小于或者等于 5，while 循环将继续运行。循环每运行一次，i 就会递增 1：

                            <html>
                               <body>
                                  <?php
                                    $i=1;
                                    while($i<=5)
                                    {
                                      echo "The number is " . $i . "<br>";
                                      $i++;
                                     }
                                  ?>
                               </body>
                             </html>

                          输出：
                               The number is 1
                               The number is 2
                               The number is 3
                               The number is 4
                               The number is 5

        3、do...while 语句

             do...while 语句会至少执行一次代码，然后检查条件，只要条件成立，就会重复进行循环。

             语法
                  do
                  {
                      要执行的代码;
                  }
                  while (条件);

             下面的实例首先设置变量 i 的值为 1 ($i=1;)。

             然后，开始 do...while 循环。循环将变量 i 的值递增 1，然后输出。先检查条件（i 小于或者等于 5），只要 i 小于或者等于 5，循环将继续运行：

             <html>
               <body>
                  <?php
                  $i=1;
                  do
                  {
                      $i++;
                      echo "The number is " . $i . "<br>";
                  }
                  while ($i<=5);
                  ?>
                </body>
            </html>

            输出：
                  The number is 2
                  The number is 3
                  The number is 4
                  The number is 5
                  The number is 6


-------------------------------------------------------------------------------------------------------------------------------------------


十五、PHP 循环 - For 循环

       循环执行代码块指定的次数，或者当指定的条件为真时循环执行代码块。

       1、for 循环

             for 循环用于您预先知道脚本需要运行的次数的情况。

             语法
                  for (初始值; 条件; 增量)
                  {
                      要执行的代码;
                  }

         参数：
              初始值：主要是初始化一个变量值，用于设置一个计数器（但可以是任何在循环的开始被执行一次的代码）。

              条件：循环执行的限制条件。如果为 TRUE，则循环继续。如果为 FALSE，则循环结束。

              增量：主要用于递增计数器（但可以是任何在循环的结束被执行的代码）。

         注释：上面的初始值和增量参数可为空，或者有多个表达式（用逗号分隔）。

         实例
            下面的实例定义一个初始值为 i=1 的循环。只要变量 i 小于或者等于 5，循环将继续运行。循环每运行一次，变量 i 就会递增 1：
               <?php
                    for ($i=1; $i<=5; $i++)
                    {
                        echo "The number is " . $i . "<br>";
                     }
               ?>

            输出：
                  The number is 1
                  The number is 2
                  The number is 3
                  The number is 4
                  The number is 5


       2、foreach 循环

           foreach 循环用于遍历数组。

           语法
                foreach ($array as $value)
                  {
                        要执行代码;
                  }

           每进行一次循环，当前数组元素的值就会被赋值给 $value 变量（数组指针会逐一地移动），在进行下一次循环时，您将看到数组中的下一个值。

           下面的实例演示了一个输出给定数组的值的循环：

                 实例
                         <?php
                            $x=array("one","two","three");
                            foreach ($x as $value)
                            {
                                echo $value . "<br>";
                            }
                         ?>

                 输出：
                         one
                         two
                         three

-------------------------------------------------------------------------------------------------------------------------------------------

 十六、PHP 函数

        PHP 的真正威力源自于它的函数。

        在 PHP 中，提供了超过 1000 个内建的函数。

        1、PHP 内建函数

            如需查看所有数组函数的完整参考手册和实例，请访问我们的 PHP 参考手册。

                    http://www.runoob.com/php/php-ref-array.html


        2、PHP 函数

             在本章中，我们将为您讲解如何创建自己的函数。

             如要在页面加载时执行脚本，您可以把它放到函数里。

             函数是通过调用函数来执行的。

             你可以在页面的任何位置调用函数。


        3、创建 PHP 函数

             函数是通过调用函数来执行的。

             语法
                <?php
                   function functionName()
                   {
                         // 要执行的代码
                    }
                 ?>

             PHP 函数准则：

                           函数的名称应该提示出它的功能

                           函数名称以字母或下划线开头（不能以数字开头）


             一个简单的函数，在其被调用时能输出我的名称：

             实例
                 <?php
                     function writeName()
                     {
                         echo "Kai Jim Refsnes";
                     }
 
                     echo "My name is ";
                     writeName();
                 ?>

             输出： My name is Kai Jim Refsnes


        4、PHP 函数 - 添加参数

             为了给函数添加更多的功能，我们可以添加参数。参数类似变量。

             参数就在函数名称后面有一个括号内指定。

              
             ①、实例：下面的实例将输出不同的名字，但姓是相同的：

              <?php
                  function writeName($fname)
                  {
                     echo $fname . " Refsnes.<br>";
                   }
 
                  echo "My name is ";
                  writeName("Kai Jim");

                  echo "My sister's name is ";
                  writeName("Hege");

                  echo "My brother's name is ";
                  writeName("Stale");
              ?>

              输出：
                     My name is Kai Jim Refsnes.
                     My sister's name is Hege Refsnes.
                     My brother's name is Stale Refsnes.


             ②、实例：下面的函数有两个参数：

                <?php
                  function writeName($fname,$punctuation)
                  {
                      echo $fname . " Refsnes" . $punctuation . "<br>";
                  }
 
                  echo "My name is ";
                  writeName("Kai Jim",".");

                  echo "My sister's name is ";
                  writeName("Hege","!");

                  echo "My brother's name is ";
                  writeName("Stale","?");
                ?>


                 输出：

                       My name is Kai Jim Refsnes.
                       My sister's name is Hege Refsnes!
                       My brother's name is Stale Refsnes?


        5、PHP 函数 - 返回值

             如需让函数返回一个值，请使用 return 语句。

             实例
                    <?php
                       function add($x,$y)
                       {
                          $total=$x+$y;
                          return $total;
                        }
 
                        echo "1 + 16 = " . add(1,16);
                    ?>

             输出：1 + 16 = 17


             额外笔记：

             关于函数的定义和使用：

                       <?php

                            //计算两个数的和
                            function add($a,$b){
                                $count = $a + $b;
                                return $count;
                            }

                            //计算小明的数学成绩和语文成绩的和（这个也可以使用在从数据库中读取数据并且做加运算）
                            function count_score(){
                                $m = 96;//数学成绩
                                $y = 99;//语文成绩
                                $sum = add($m,$y);
                                echo "小明的总成绩是".$sum;
                            }
                            count_score();
                        ?>


-------------------------------------------------------------------------------------------------------------------------------------------


十七、PHP 魔术常量

        八个魔术常量
 
        PHP 向它运行的任何脚本提供了大量的预定义常量。

        不过很多常量都是由不同的扩展库定义的，只有在加载了这些扩展库时才会出现，或者动态加载后，或者在编译时已经包括进去了。

        有八个魔术常量它们的值随着它们在代码中的位置改变而改变。

        例如 __LINE__ 的值就依赖于它在脚本中所处的行来决定。这些特殊的常量不区分大小写，如下：


        1、__LINE__

            文件中的当前行号。

                实例
                    <?php
                          echo '这是第 " '  . __LINE__ . ' " 行';
                    ?>

                以上实例输出结果为：这是第 “ 2 ” 行


        2、__FILE__

            文件的完整路径和文件名。如果用在被包含文件中，则返回被包含的文件名。

            自 PHP 4.0.2 起，__FILE__ 总是包含一个绝对路径（如果是符号连接，则是解析后的绝对路径），而在此之前的版本有时会包含一个相对路径

            实例：
                <?php
                       echo '该文件位于 " '  . __FILE__ . ' " ';
                ?>

                以上实例输出结果为：  该文件位于 “ E:\wamp\www\test\index.php ”


        3、__DIR__

            文件所在的目录。如果用在被包括文件中，则返回被包括的文件所在的目录。

            它等价于 dirname(__FILE__)。除非是根目录，否则目录中名不包括末尾的斜杠。（PHP 5.3.0中新增）

            实例
                 <?php
                          echo '该文件位于 " '  . __DIR__ . ' " ';
                 ?>

            以上实例输出结果为：该文件位于 “ E:\wamp\www\test ”


        4、__FUNCTION__

            函数名称（PHP 4.3.0 新加）。自 PHP 5 起本常量返回该函数被定义时的名字（区分大小写）。在 PHP 4 中该值总是小写字母的。

            实例
                 <?php
                       function test() {
                           echo  '函数名为：' . __FUNCTION__ ;
                       }
                       test();
                 ?>

                 以上实例输出结果为： 函数名为：test


        5、__CLASS__

            类的名称（PHP 4.3.0 新加）。自 PHP 5 起本常量返回该类被定义时的名字（区分大小写）。

            在 PHP 4 中该值总是小写字母的。类名包括其被声明的作用区域（例如 Foo\Bar）。注意自 PHP 5.4 起 __CLASS__ 对 trait 也起作用。当用在 trait 方法中时，__CLASS__ 是调用 trait 方法的类的名字。

            实例
               <?php
                   class test {
                      function _print() {
                           echo '类名为：'  . __CLASS__ . "<br>";
                           echo  '函数名为：' . __FUNCTION__ ;
                       }
                   }
                   $t = new test();
                   $t->_print();
               ?>

                以上实例输出结果为：
                                    类名为：test
                                    函数名为：_print



        6、__TRAIT__

             Trait 的名字（PHP 5.4.0 新加）。自 PHP 5.4.0 起，PHP 实现了代码复用的一个方法，称为 traits。

             Trait 名包括其被声明的作用区域（例如 Foo\Bar）。

             从基类继承的成员被插入的 SayWorld Trait 中的 MyHelloWorld 方法所覆盖。其行为 MyHelloWorld 类中定义的方法一致。

             优先顺序是当前类中的方法会覆盖 trait 方法，而 trait 方法又覆盖了基类中的方法。

             实例
                <?php
                  class Base {
                      public function sayHello() {
                          echo 'Hello ';
                      }
                  }
 
                  trait SayWorld {
                      public function sayHello() {
                          parent::sayHello();
                          echo 'World!';
                      }
                  }
 
                  class MyHelloWorld extends Base {
                      use SayWorld;
                  }
 
                  $o = new MyHelloWorld();
                  $o->sayHello();
                ?>

                以上例程会输出：Hello World!


        7、__METHOD__

             类的方法名（PHP 5.0.0 新加）。返回该方法被定义时的名字（区分大小写）。

             实例:
                  <?php
                         function test() {
                             echo  '函数名为：' . __METHOD__ ;
                         }
                         test();
                  ?>

                  以上实例输出结果为：

                                       函数名为：test


        8、__NAMESPACE__

             当前命名空间的名称（区分大小写）。此常量是在编译时定义的（PHP 5.3.0 新增）。

             实例
                 <?php
                       namespace MyProject;
 
                       echo '命名空间为："', __NAMESPACE__, '"'; // 输出 "MyProject"
                 ?>

                 以上实例输出结果为：
                                     命名空间为："MyProject"



-------------------------------------------------------------------------------------------------------------------------------------------


十八、PHP 命名空间(namespace)

        PHP 命名空间(namespace)是在PHP 5.3中加入的，如果你学过C#和Java，那命名空间就不算什么新事物。 不过在PHP当中还是有着相当重要的意义。

        PHP 命名空间可以解决以下两类问题：

             （1）用户编写的代码与PHP内部的类/函数/常量或第三方类/函数/常量之间的名字冲突。

             （2）为很长的标识符名称(通常是为了缓解第一类问题而定义的)创建一个别名（或简短）的名称，提高源代码的可读性。


        1、定义命名空间

              默认情况下，所有常量、类和函数名都放在全局空间下，就和PHP支持命名空间之前一样。

              命名空间通过关键字namespace 来声明。如果一个文件中包含命名空间，它必须在其它所有代码之前声明命名空间。语法格式如下；

                     <?php  

                           // 定义代码在 'MyProject' 命名空间中  

                               namespace MyProject;  
 
                           // ... 代码 ...  


              你也可以在同一个文件中定义不同的命名空间代码，如：

                              <?php  
                                    namespace MyProject;

                                    const CONNECT_OK = 1;
                                    class Connection { /* ... */ }
                                    function connect() { /* ... */  }

                                    namespace AnotherProject;

                                    const CONNECT_OK = 1;
                                    class Connection { /* ... */ }
                                    function connect() { /* ... */  }
                               ?>  

              不建议使用这种语法在单个文件中定义多个命名空间。建议使用下面的大括号形式的语法。

                               <?php
                                    namespace MyProject {
                                        const CONNECT_OK = 1;
                                        class Connection { /* ... */ }
                                        function connect() { /* ... */  }
                                    }

                                    namespace AnotherProject {
                                        const CONNECT_OK = 1;
                                        class Connection { /* ... */ }
                                        function connect() { /* ... */  }
                                    }
                                ?>


              将全局的非命名空间中的代码与命名空间中的代码组合在一起，只能使用大括号形式的语法。全局代码必须用一个不带名称的 namespace 语句加上大括号括起来，例如：
                                <?php
                                    namespace MyProject {

                                          const CONNECT_OK = 1;
                                          class Connection { /* ... */ }
                                          function connect() { /* ... */  }
                                    }

                                    namespace { // 全局代码

                                           session_start();
                                           $a = MyProject\connect();
                                           echo MyProject\Connection::start();
                                    }
                                ?>

              注意：
                   在声明命名空间之前唯一合法的代码是用于定义源文件编码方式的 declare 语句。
 
                   所有非 PHP 代码包括空白符都不能出现在命名空间的声明之前。

                         <?php
                              declare(encoding='UTF-8'); //定义多个命名空间和不包含在命名空间中的代码

                              namespace MyProject {

                                  const CONNECT_OK = 1;
                                  class Connection { /* ... */ }
                                  function connect() { /* ... */  }
                              }

                              namespace { // 全局代码

                                  session_start();
                                  $a = MyProject\connect();
                                  echo MyProject\Connection::start();
                              }
                          ?>

                   以下代码会出现语法错误：

                          <html>
                          <?php
                              namespace MyProject; // 命名空间前出现了“<html>” 会致命错误 -　命名空间必须是程序脚本的第一条语句
                          ?>


        2、子命名空间

            与目录和文件的关系很像，PHP 命名空间也允许指定层次化的命名空间的名称。因此，命名空间的名字可以使用分层次的方式定义：

                           <?php
                                   namespace MyProject\Sub\Level;  //声明分层次的单个命名空间

                                   const CONNECT_OK = 1;
                                   class Connection { /* ... */ }
                                   function Connect() { /* ... */  }
                           ?>

            上面的例子创建了常量 MyProject\Sub\Level\CONNECT_OK，类 MyProject\Sub\Level\Connection 和函数 MyProject\Sub\Level\Connect。



        3、命名空间使用

               PHP 命名空间中的类名可以通过三种方式引用：

                  （1）非限定名称，或不包含前缀的类名称，例如 $a=new foo(); 或 foo::staticmethod();。如果当前命名空间是 currentnamespace，foo 将被解析为 currentnamespace\foo。如果使用 foo 的代码是全局的，不包含在任何命名空间中的代码，则 foo 会被解析为foo。 警告：如果命名空间中的函数或常量未定义，则该非限定的函数名称或常量名称会被解析为全局函数名称或常量名称。


                  （2）限定名称,或包含前缀的名称，例如 $a = new subnamespace\foo(); 或 subnamespace\foo::staticmethod();。如果当前的命名空间是 currentnamespace，则 foo 会被解析为 currentnamespace\subnamespace\foo。如果使用 foo 的代码是全局的，不包含在任何命名空间中的代码，foo 会被解析为subnamespace\foo。


                  （3）完全限定名称，或包含了全局前缀操作符的名称，例如， $a = new \currentnamespace\foo(); 或 \currentnamespace\foo::staticmethod();。在这种情况下，foo 总是被解析为代码中的文字名(literal name)currentnamespace\foo。

                 
                      下面是一个使用这三种方式的实例：

                                   file1.php 文件代码

                                      <?php
                                         namespace Foo\Bar\subnamespace; 

                                         const FOO = 1;
                                         function foo() {}
                                         class foo
                                         {                                         
                                             static function staticmethod() {}
                                         }
                                      ?>



                                   file2.php 文件代码

                                      <?php
                                         namespace Foo\Bar;
                                         include 'file1.php';

                                         const FOO = 2;
                                         function foo() {}
                                         class foo
                                         {
                                             static function staticmethod() {}
                                         }

                                         /* 非限定名称 */
                                         foo(); // 解析为函数 Foo\Bar\foo
                                         foo::staticmethod(); // 解析为类 Foo\Bar\foo ，方法为 staticmethod
                                         echo FOO; // 解析为常量 Foo\Bar\FOO

                                         /* 限定名称 */
                                         subnamespace\foo(); // 解析为函数 Foo\Bar\subnamespace\foo
                                         subnamespace\foo::staticmethod(); // 解析为类 Foo\Bar\subnamespace\foo,
                                                                           // 以及类的方法 staticmethod
                                         echo subnamespace\FOO; // 解析为常量 Foo\Bar\subnamespace\FOO
                                  
                                         /* 完全限定名称 */
                                         \Foo\Bar\foo(); // 解析为函数 Foo\Bar\foo
                                         \Foo\Bar\foo::staticmethod(); // 解析为类 Foo\Bar\foo, 以及类的方法 staticmethod
                                         echo \Foo\Bar\FOO; // 解析为常量 Foo\Bar\FOO
                                      ?>


                         注意访问任意全局类、函数或常量，都可以使用完全限定名称，例如 \strlen() 或 \Exception 或 \INI_ALL。

                                       在命名空间内部访问全局类、函数和常量：

                                         <?php
                                             namespace Foo;

                                             function strlen() {}
                                             const INI_ALL = 3;
                                             class Exception {}
   
                                             $a = \strlen('hi'); // 调用全局函数strlen
                                             $b = \INI_ALL; // 访问全局常量 INI_ALL
                                             $c = new \Exception('error'); // 实例化全局类 Exception
                                         ?>


        3、命名空间和动态语言特征

              PHP 命名空间的实现受到其语言自身的动态特征的影响。因此，如果要将下面的代码转换到命名空间中，动态访问元素。

              example1.php 文件代码：

                               <?php
                                     class classname
                                     {
                                         function __construct()
                                         {
                                             echo __METHOD__,"\n";
                                         }
                                     }

                                     function funcname()
                                     {
                                         echo __FUNCTION__,"\n";
                                     }

                                     const constname = "global";

                                     $a = 'classname';
                                     $obj = new $a; // prints classname::__construct
                                     $b = 'funcname';
                                     $b(); // prints funcname
                                     echo constant('constname'), "\n"; // prints global
                                 ?>


              必须使用完全限定名称（包括命名空间前缀的类名称）。

              注意因为在动态的类名称、函数名称或常量名称中，限定名称和完全限定名称没有区别，因此其前导的反斜杠是不必要的。

              动态访问命名空间的元素

                               <?php
                                     namespace namespacename;
                                     class classname
                                     {
                                         function __construct()
                                         {
                                             echo __METHOD__,"\n";
                                         }
                                     }
                                     function funcname()
                                     {
                                         echo __FUNCTION__,"\n";
                                     }
                                     const constname = "namespaced";

                                     include 'example1.php';

                                     $a = 'classname';
                                     $obj = new $a; // 输出 classname::__construct
                                     $b = 'funcname';
                                     $b(); // 输出函数名
                                     echo constant('constname'), "\n"; // 输出 global

                                     /* 如果使用双引号，使用方法为 "\\namespacename\\classname"*/
                                     $a = '\namespacename\classname';
                                     $obj = new $a; // 输出 namespacename\classname::__construct

                                     $a = 'namespacename\classname';
                                     $obj = new $a; // 输出 namespacename\classname::__construct

                                     $b = 'namespacename\funcname';
                                     $b(); // 输出 namespacename\funcname

                                     $b = '\namespacename\funcname';
                                     $b(); // 输出 namespacename\funcname

                                     echo constant('\namespacename\constname'), "\n"; // 输出 namespaced
                                     echo constant('namespacename\constname'), "\n"; // 输出 namespaced
                               ?>



        4、namespace关键字和__NAMESPACE__常量

             PHP支持两种抽象的访问当前命名空间内部元素的方法，__NAMESPACE__ 魔术常量和namespace关键字。

             常量__NAMESPACE__的值是包含当前命名空间名称的字符串。在全局的，不包括在任何命名空间中的代码，它包含一个空的字符串。

             
                 （1） __NAMESPACE__ 示例, 在命名空间中的代码

                         <?php
                               namespace MyProject;
                               echo '"', __NAMESPACE__, '"'; // 输出 "MyProject"
                          ?>


                 （2）__NAMESPACE__ 示例，全局代码

                         <?php
                               echo '"', __NAMESPACE__, '"'; // 输出 ""
                         ?>


                 （3）常量 __NAMESPACE__ 在动态创建名称时很有用，例如：

                         使用__NAMESPACE__动态创建名称

                         <?php
                               namespace MyProject;

                               function get($classname)
                               {
                                   $a = __NAMESPACE__ . '\\' . $classname;
                                   return new $a;
                                }
                         ?>


                 （4）关键字 namespace 可用来显式访问当前命名空间或子命名空间中的元素。它等价于类中的 self 操作符。

                      namespace操作符，命名空间中的代码

                         <?php
                               namespace MyProject;

                               use blah\blah as mine; // see "Using namespaces: importing/aliasing"

                               blah\mine(); // calls function blah\blah\mine()

                               namespace\blah\mine(); // calls function MyProject\blah\mine()

                               namespace\func(); // calls function MyProject\func()

                               namespace\sub\func(); // calls function MyProject\sub\func()

                               namespace\cname::method(); // calls static method "method" of class MyProject\cname

                               $a = new namespace\sub\cname(); // instantiates object of class MyProject\sub\cname

                               $b = namespace\CONSTANT; // assigns value of constant MyProject\CONSTANT to $b
                         ?>



                 （5）namespace操作符, 全局代码

                         <?php
                               namespace\func(); // calls function func()

                               namespace\sub\func(); // calls function sub\func()

                               namespace\cname::method(); // calls static method "method" of class cname

                               $a = new namespace\sub\cname(); // instantiates object of class sub\cname

                               $b = namespace\CONSTANT; // assigns value of constant CONSTANT to $b
                         ?>


        5、使用命名空间：别名/导入

             PHP 命名空间支持 有两种使用别名或导入方式：为类名称使用别名，或为命名空间名称使用别名。

             在PHP中，别名是通过操作符 use 来实现的. 下面是一个使用所有可能的三种导入方式的例子：


                 （1）使用use操作符导入/使用别名

                        <?php
                              namespace foo;

                              use My\Full\Classname as Another;

                              // 下面的例子与 use My\Full\NSname as NSname 相同
                              use My\Full\NSname;

                              // 导入一个全局类
                              use \ArrayObject;

                              $obj = new namespace\Another; // 实例化 foo\Another 对象

                              $obj = new Another; // 实例化 My\Full\Classname　对象

                              NSname\subns\func(); // 调用函数 My\Full\NSname\subns\func

                              $a = new ArrayObject(array(1)); // 实例化 ArrayObject 对象

                              // 如果不使用 "use \ArrayObject" ，则实例化一个 foo\ArrayObject 对象
                          ?>


                 （2） 一行中包含多个use语句

                        <?php
                            use My\Full\Classname as Another, My\Full\NSname;

                            $obj = new Another; // 实例化 My\Full\Classname 对象

                            NSname\subns\func(); // 调用函数 My\Full\NSname\subns\func
                        ?>


                 （3）导入和动态名称

                          导入操作是在编译执行的，但动态的类名称、函数名称或常量名称则不是。

                          <?php
                                use My\Full\Classname as Another, My\Full\NSname;

                                $obj = new Another; // 实例化一个 My\Full\Classname 对象
                                $a = 'Another';
                                $obj = new $a;      // 实际化一个 Another 对象
                          ?>


                 （4）导入和完全限定名称

                          另外，导入操作只影响非限定名称和限定名称。完全限定名称由于是确定的，故不受导入的影响。

                          <?php
                               use My\Full\Classname as Another, My\Full\NSname;

                               $obj = new Another; // 实例化 My\Full\Classname 类

                               $obj = new \Another; // 实例化 Another 类

                               $obj = new Another\thing; // 实例化 My\Full\Classname\thing 类

                               $obj = new \Another\thing; // 实例化 Another\thing 类
                          ?>



        6、使用命名空间：后备全局函数/常量

             在一个命名空间中，当 PHP 遇到一个非限定的类、函数或常量名称时，它使用不同的优先策略来解析该名称。类名称总是解析到当前命名空间中的名称。
             因此在访问系统内部或不包含在命名空间中的类名称时，必须使用完全限定名称，例如：

                 （1）在命名空间中访问全局类

                        <?php
                              namespace A\B\C;
                              class Exception extends \Exception {}

                              $a = new Exception('hi'); // $a 是类 A\B\C\Exception 的一个对象
                              $b = new \Exception('hi'); // $b 是类 Exception 的一个对象

                              $c = new ArrayObject; // 致命错误, 找不到 A\B\C\ArrayObject 类
                         ?>


                 （2）命名空间中后备的全局函数/常量

                        <?php
                              namespace A\B\C;

                              const E_ERROR = 45;

                              function strlen($str)
                              {
                                  return \strlen($str) - 1;
                              }

                              echo E_ERROR, "\n"; // 输出 "45"
                              echo INI_ALL, "\n"; // 输出 "7" - 使用全局常量 INI_ALL

                              echo strlen('hi'), "\n"; // 输出 "2"
                              if (is_array('hi')) { // 输出 "is not array"

                                  echo "is array\n";

                              } else {
                                  echo "is not array\n";
                              }
                        ?>


        7、全局空间

             如果没有定义任何命名空间，所有的类与函数的定义都是在全局空间，与 PHP 引入命名空间概念前一样。

             在名称前加上前缀 \ 表示该名称是全局空间中的名称，即使该名称位于其它的命名空间中时也是如此。

             使用全局空间说明

                       <?php
                              namespace A\B\C;

                              /* 这个函数是 A\B\C\fopen */
                              function fopen() { 
                                   /* ... */
                                   $f = \fopen(...); // 调用全局的fopen函数
                                   return $f;
                              } 
                        ?>


        8、命名空间的顺序

             自从有了命名空间之后，最容易出错的该是使用类的时候，这个类的寻找路径是什么样的了。

<?php
namespace A;
use B\D, C\E as F;

// 函数调用

foo();      // 首先尝试调用定义在命名空间"A"中的函数foo()
            // 再尝试调用全局函数 "foo"

\foo();     // 调用全局空间函数 "foo" 

my\foo();   // 调用定义在命名空间"A\my"中函数 "foo" 

F();        // 首先尝试调用定义在命名空间"A"中的函数 "F" 
            // 再尝试调用全局函数 "F"

// 类引用

new B();    // 创建命名空间 "A" 中定义的类 "B" 的一个对象
            // 如果未找到，则尝试自动装载类 "A\B"

new D();    // 使用导入规则，创建命名空间 "B" 中定义的类 "D" 的一个对象
            // 如果未找到，则尝试自动装载类 "B\D"

new F();    // 使用导入规则，创建命名空间 "C" 中定义的类 "E" 的一个对象
            // 如果未找到，则尝试自动装载类 "C\E"

new \B();   // 创建定义在全局空间中的类 "B" 的一个对象
            // 如果未发现，则尝试自动装载类 "B"

new \D();   // 创建定义在全局空间中的类 "D" 的一个对象
            // 如果未发现，则尝试自动装载类 "D"

new \F();   // 创建定义在全局空间中的类 "F" 的一个对象
            // 如果未发现，则尝试自动装载类 "F"

// 调用另一个命名空间中的静态方法或命名空间函数

B\foo();    // 调用命名空间 "A\B" 中函数 "foo"

B::foo();   // 调用命名空间 "A" 中定义的类 "B" 的 "foo" 方法
            // 如果未找到类 "A\B" ，则尝试自动装载类 "A\B"

D::foo();   // 使用导入规则，调用命名空间 "B" 中定义的类 "D" 的 "foo" 方法
            // 如果类 "B\D" 未找到，则尝试自动装载类 "B\D"

\B\foo();   // 调用命名空间 "B" 中的函数 "foo" 

\B::foo();  // 调用全局空间中的类 "B" 的 "foo" 方法
            // 如果类 "B" 未找到，则尝试自动装载类 "B"

// 当前命名空间中的静态方法或函数

A\B::foo();   // 调用命名空间 "A\A" 中定义的类 "B" 的 "foo" 方法
              // 如果类 "A\A\B" 未找到，则尝试自动装载类 "A\A\B"

\A\B::foo();  // 调用命名空间 "A" 中定义的类 "B" 的 "foo" 方法
              // 如果类 "A\B" 未找到，则尝试自动装载类 "A\B"
?>



名称解析遵循下列规则：

①、对完全限定名称的函数，类和常量的调用在编译时解析。例如 new \A\B 解析为类 A\B。

②、所有的非限定名称和限定名称（非完全限定名称）根据当前的导入规则在编译时进行转换。例如，如果命名空间 A\B\C 被导入为 C，那么对 C\D\e() 的调用就会被转换为 A\B\C\D\e()。

③、在命名空间内部，所有的没有根据导入规则转换的限定名称均会在其前面加上当前的命名空间名称。例如，在命名空间 A\B 内部调用 C\D\e()，则 C\D\e() 会被转换为 A\B\C\D\e() 。

④、非限定类名根据当前的导入规则在编译时转换（用全名代替短的导入名称）。例如，如果命名空间 A\B\C 导入为C，则 new C() 被转换为 new A\B\C() 。

⑤、在命名空间内部（例如A\B），对非限定名称的函数调用是在运行时解析的。例如对函数 foo() 的调用是这样解析的：

               （1）在当前命名空间中查找名为 A\B\foo() 的函数

               （2）尝试查找并调用 全局(global) 空间中的函数 foo()。

⑥、在命名空间（例如A\B）内部对非限定名称或限定名称类（非完全限定名称）的调用是在运行时解析的。下面是调用 new C() 及 new D\E() 的解析过程： new C()的解析:

               （1）在当前命名空间中查找A\B\C类。

               （2）尝试自动装载类A\B\C。

   new D\E()的解析:

               （1）在类名称前面加上当前命名空间名称变成：A\B\D\E，然后查找该类。

               （2）尝试自动装载类 A\B\D\E。

   为了引用全局命名空间中的全局类，必须使用完全限定名称 new \C()。



-------------------------------------------------------------------------------------------------------------------------------------------


十九、PHP 面向对象

       在面向对象的程序设计（英语：Object-oriented programming，缩写：OOP）中，对象是一个由信息及对信息进行处理的描述所组成的整体，是对现实世界的抽象。

       在现实世界里我们所面对的事情都是对象，如计算机、电视机、自行车等。

       对象的主要三个特性：

          对象的行为：可以对 对象施加那些操作，开灯，关灯就是行为。

          对象的形态：当施加那些方法是对象如何响应，颜色，尺寸，外型。

          对象的表示：对象的表示就相当于身份证，具体区分在相同的行为与状态下有什么不同。

          比如 Animal(动物) 是一个抽象类，我们可以具体到一只狗跟一只羊，而狗跟羊就是具体的对象，他们有颜色属性，可以写，可以跑等行为状态。


        1、面向对象内容

              类 ? 定义了一件事物的抽象特点。类的定义包含了数据的形式以及对数据的操作。

              对象 ? 是类的实例。

              成员变量 ? 定义在类内部的变量。该变量的值对外是不可见的，但是可以通过成员函数访问，在类被实例化为对象后，该变量即可称为对象的属性。

              成员函数 ? 定义在类的内部，可用于访问对象的数据。

              继承 ? 继承性是子类自动共享父类数据结构和方法的机制，这是类之间的一种关系。在定义和实现一个类的时候，可以在一个已经存在的类的基础之上来进行，把这个已经存在的类所定义的内容作为自己的内容，并加入若干新的内容。

              父类 ? 一个类被其他类继承，可将该类称为父类，或基类，或超类。

              子类 ? 一个类继承其他类称为子类，也可称为派生类。

              多态 ? 多态性是指相同的函数或方法可作用于多种类型的对象上并获得不同的结果。不同的对象，收到同一消息可以产生不同的结果，这种现象称为多态性。

              重载 ? 简单说，就是函数或者方法有同样的名称，但是参数列表不相同的情形，这样的同名不同参数的函数或者方法之间，互相称之为重载函数或者方法。

              抽象性 ? 抽象性是指将具有一致的数据结构（属性）和行为（操作）的对象抽象成类。一个类就是这样一种抽象，它反映了与应用有关的重要性质，而忽略其他一些无关内容。任何类的划分都是主观的，但必须与具体的应用有关。

              封装 ? 封装是指将现实世界中存在的某个客体的属性与行为绑定在一起，并放置在一个逻辑单元内。

              构造函数 ? 主要用来在创建对象时初始化对象， 即为对象成员变量赋初始值，总与new运算符一起使用在创建对象的语句中。

              析构函数 ? 析构函数(destructor) 与构造函数相反，当对象结束其生命周期时（例如对象所在的函数已调用完毕），系统自动执行析构函数。析构函数往往用来做"清理善后" 的工作（例如在建立对象时用new开辟了一片内存空间，应在退出前在析构函数中用delete释放）。



  #################################################################



              下图中我们通过 Car 类 创建了三个对象：Mercedes, Bmw, 和 Audi。

                                            $mercedes = new Car ();

                                            $bmw = new Car ();

                                            $audi = new Car ();


        2、PHP 类定义

              PHP 定义类通常语法格式如下：

                    <?php
                         class phpClass {
                           var $var1;
                           var $var2 = "constant string";
  
                           function myfunc ($arg1, $arg2) {
                             [..]
                           }
                           [..]
                         }
                     ?>

              解析如下：

                  类使用 class 关键字后加上类名定义。

                  类名后的一对大括号({})内可以定义变量和方法。

                  类的变量使用 var 来声明, 变量也可以初始化值。

                  函数定义类似 PHP 函数的定义，但函数只能通过该类及其实例化的对象访问。


              实例：

                  <?php
                        class Site {
                          /* 成员变量 */
                          var $url;
                          var $title;
  
                          /* 成员函数 */
                          function setUrl($par){
                             $this->url = $par;
                          }
  
                          function getUrl(){
                             echo $this->url . PHP_EOL;
                          }
  
                          function setTitle($par){
                             $this->title = $par;
                          }
  
                          function getTitle(){
                             echo $this->title . PHP_EOL;
                          }
                        }
                     ?>

                变量 $this 代表自身的对象。

                PHP_EOL 为换行符。


        3、PHP 中创建对象

            类创建后，我们可以使用 new 运算符来实例化该类的对象：

                               $runoob = new Site;

                               $taobao = new Site;

                               $google = new Site;


            以上代码我们创建了三个对象，三个对象各自都是独立的，接下来我们来看看如何访问成员方法与成员变量。


           （1）调用成员方法

                  在实例化对象后，我们可以使用该对象调用成员方法，该对象的成员方法只能操作该对象的成员变量：

                            // 调用成员函数，设置标题和URL

                                   $runoob->setTitle( "菜鸟教程" );
                                   $taobao->setTitle( "淘宝" );
                                   $google->setTitle( "Google 搜索" );

                                   $runoob->setUrl( 'www.runoob.com' );
                                   $taobao->setUrl( 'www.taobao.com' );
                                   $google->setUrl( 'www.google.com' );


                             // 调用成员函数，获取标题和URL

                                   $runoob->getTitle();
                                   $taobao->getTitle();
                                   $google->getTitle();

                                   $runoob->getUrl();
                                   $taobao->getUrl();
                                   $google->getUrl();

                实例：完整代码如下：

                               <?php 
                                   class Site { 
                                     /* 成员变量 */ 
                                     var $url; 
                                     var $title; 
   
                                     /* 成员函数 */ 
                                     function setUrl($par){ 
                                        $this->url = $par; 
                                     }

                                     function getUrl(){ 
                                        echo $this->url . PHP_EOL; 
                                     }

                                     function setTitle($par){ 
                                        $this->title = $par; 
                                     } 

                                     function getTitle(){ 
                                        echo $this->title . PHP_EOL; 
                                     }
                                   } 

                                   $runoob = new Site; 
                                   $taobao = new Site; 
                                   $google = new Site; 

                                   // 调用成员函数，设置标题和URL 
                                   $runoob->setTitle( "菜鸟教程" ); 
                                   $taobao->setTitle( "淘宝" ); 
                                   $google->setTitle( "Google 搜索" ); 

                                   $runoob->setUrl( 'www.runoob.com' ); 
                                   $taobao->setUrl( 'www.taobao.com' ); 
                                   $google->setUrl( 'www.google.com' ); 

                                   // 调用成员函数，获取标题和URL 
                                   $runoob->getTitle(); 
                                   $taobao->getTitle(); 
                                   $google->getTitle(); 

                                   $runoob->getUrl(); 
                                   $taobao->getUrl(); 
                                   $google->getUrl(); 
                               ?>

                执行以上代码，输出结果为：

                                   菜鸟教程
                                   淘宝
                                   Google 搜索
                                   www.runoob.com
                                   www.taobao.com
                                   www.google.com

        4、PHP 构造函数

             构造函数是一种特殊的方法。主要用来在创建对象时初始化对象， 即为对象成员变量赋初始值，在创建对象的语句中与 new 运算符一起使用。

             PHP 5 允许开发者在一个类中定义一个方法作为构造函数，语法格式如下：

                                   void __construct ([ mixed $args [, $... ]] )

             在上面的例子中我们就可以通过构造方法来初始化 $url 和 $title 变量：

                                   function __construct( $par1, $par2 ) {

                                          $this->url = $par1;                                        
                                          $this->title = $par2;
                                   }

             现在我们就不需要再调用 setTitle 和 setUrl 方法了：
             实例：
                  $runoob = new Site('www.runoob.com', '菜鸟教程'); 
                  $taobao = new Site('www.taobao.com', '淘宝'); 
                  $google = new Site('www.google.com', 'Google 搜索'); 

             // 调用成员函数，获取标题和URL 

                  $runoob->getTitle(); 
                  $taobao->getTitle(); 
                  $google->getTitle(); 

                  $runoob->getUrl(); 
                  $taobao->getUrl(); 
                  $google->getUrl();


        5、析构函数

             析构函数(destructor) 与构造函数相反，当对象结束其生命周期时（例如对象所在的函数已调用完毕），系统自动执行析构函数。

             PHP 5 引入了析构函数的概念，这类似于其它面向对象的语言，其语法格式如下：

                                                 void __destruct ( void )


             ①实例：
                  <?php
                        class MyDestructableClass {
                           function __construct() {
                               print "构造函数\n";
                               $this->name = "MyDestructableClass";
                           }

                           function __destruct() {
                               print "销毁 " . $this->name . "\n";
                           }
                        }

                        $obj = new MyDestructableClass();
                   ?>


                   执行以上代码，输出结果为：

                                     构造函数
                                     销毁 MyDestructableClass


             ②实例：
                  <?php
                        class MyDestructableClass {
                           function __construct() {
                               print "构造函数\n"."<br>";
                               $this->name = "MyDestructableClass";
                           }

                           function test(){

   	                           echo "在销毁之前，调用test()方法<br>";
                           }

                           function __destruct() {
                               print "销毁 " . $this->name . "\n";
                           }
                        }

                        $obj = new MyDestructableClass();
                        $obj->test();
                   ?>

                   执行以上代码，输出结果为：

                                     构造函数
                                     在销毁之前，调用test()方法
                                     销毁 MyDestructableClass



        6、继承

              PHP 使用关键字 extends 来继承一个类，PHP 不支持多继承，格式如下：

                        class Child extends Parent {

                                      // 代码部分
                        }

              实例
              实例中 Child_Site 类继承了 Site 类，并扩展了功能：

                        <?php 
                              // 子类扩展站点类别
                              class Child_Site extends Site {

                                      var $category;

                                  function setCate($par){
                                      $this->category = $par;
                                  }
  
                                  function getCate(){
                                      echo $this->category . PHP_EOL;
                                  }
                              }


        7、方法重写

             如果从父类继承的方法不能满足子类的需求，可以对其进行改写，这个过程叫方法的覆盖（override），也称为方法的重写。

             实例中重写了 getUrl 与 getTitle 方法：

                             function getUrl() {
                                echo $this->url . PHP_EOL;
                                return $this->url;
                             }
   
                             function getTitle(){
                                echo $this->title . PHP_EOL;
                                return $this->title;
                             }


        8、访问控制

             PHP 对属性或方法的访问控制，是通过在前面添加关键字 public（公有），protected（受保护）或 private（私有）来实现的。

                          public（公有）：公有的类成员可以在任何地方被访问。

                          protected（受保护）：受保护的类成员则可以被其自身以及其子类和父类访问。

                          private（私有）：私有的类成员则只能被其定义所在的类访问。


             (1)、属性的访问控制
                  
                   类属性必须定义为公有，受保护，私有之一。如果用 var 定义，则被视为公有。

                          <?php
                          /**
                           * Define MyClass
                           */
                          class MyClass
                          {
                              public $public = 'Public';
                              protected $protected = 'Protected';
                              private $private = 'Private';

                              function printHello()
                              {
                                  echo $this->public;
                                  echo $this->protected;
                                  echo $this->private;
                              }
                          }

                          $obj = new MyClass();
                          echo $obj->public; // 这行能被正常执行
                          echo $obj->protected; // 这行会产生一个致命错误
                          echo $obj->private; // 这行也会产生一个致命错误
                          $obj->printHello(); // 输出 Public、Protected 和 Private


                          /**
                           * Define MyClass2
                           */
                          class MyClass2 extends MyClass
                          {
                              // 可以对 public 和 protected 进行重定义，但 private 而不能
                              protected $protected = 'Protected2';

                              function printHello()
                              {
                                  echo $this->public;
                                  echo $this->protected;
                                  echo $this->private;
                              }
                          }

                          $obj2 = new MyClass2();
                          echo $obj2->public; // 这行能被正常执行
                          echo $obj2->private; // 未定义 private
                          echo $obj2->protected; // 这行会产生一个致命错误
                          $obj2->printHello(); // 输出 Public、Protected2 和 Undefined

                          ?>


             (2)方法的访问控制

                  类中的方法可以被定义为公有，私有或受保护。如果没有设置这些关键字，则该方法默认为公有。

                         <?php
                         /**
                          * Define MyClass
                          */
                         class MyClass
                         {
                             // 声明一个公有的构造函数
                             public function __construct() { }

                             // 声明一个公有的方法
                             public function MyPublic() { }

                             // 声明一个受保护的方法
                             protected function MyProtected() { }

                             // 声明一个私有的方法
                             private function MyPrivate() { }

                             // 此方法为公有
                             function Foo()
                             {
                                 $this->MyPublic();
                                 $this->MyProtected();
                                 $this->MyPrivate();
                             }
                         }

                         $myclass = new MyClass;
                         $myclass->MyPublic(); // 这行能被正常执行
                         $myclass->MyProtected(); // 这行会产生一个致命错误
                         $myclass->MyPrivate(); // 这行会产生一个致命错误
                         $myclass->Foo(); // 公有，受保护，私有都可以执行


                         /**
                          * Define MyClass2
                          */
                         class MyClass2 extends MyClass
                         {
                             // 此方法为公有
                             function Foo2()
                             {
                                 $this->MyPublic();
                                 $this->MyProtected();
                                 $this->MyPrivate(); // 这行会产生一个致命错误
                             }
                         }

                         $myclass2 = new MyClass2;
                         $myclass2->MyPublic(); // 这行能被正常执行
                         $myclass2->Foo2(); // 公有的和受保护的都可执行，但私有的不行

                         class Bar 
                         {
                             public function test() {
                                 $this->testPrivate();
                                 $this->testPublic();
                             }

                             public function testPublic() {
                                 echo "Bar::testPublic\n";
                             }
    
                             private function testPrivate() {
                                 echo "Bar::testPrivate\n";
                             }
                         }

                         class Foo extends Bar 
                         {
                             public function testPublic() {
                                 echo "Foo::testPublic\n";
                             }

                             private function testPrivate() {
                                 echo "Foo::testPrivate\n";
                             }
                         }

                         $myFoo = new foo();
                         $myFoo->test(); // Bar::testPrivate 
                                         // Foo::testPublic
                         ?>


        9、接口

             使用接口（interface），可以指定某个类必须实现哪些方法，但不需要定义这些方法的具体内容。

             接口是通过 interface 关键字来定义的，就像定义一个标准的类一样，但其中定义所有的方法都是空的。

             接口中定义的所有方法都必须是公有，这是接口的特性。

             要实现一个接口，使用 implements 操作符。类中必须实现接口中定义的所有方法，否则会报一个致命错误。类可以实现多个接口，用逗号来分隔多个接口的名称。

                                   <?php

					// 声明一个'iTemplate'接口
					interface iTemplate
					{
					    public function setVariable($name, $var);
					    public function getHtml($template);
					}


					// 实现接口
					class Template implements iTemplate
					{
					    private $vars = array();
					  
					    public function setVariable($name, $var)
					    {
					        $this->vars[$name] = $var;
					    }
					  
					    public function getHtml($template)
					    {
					        foreach($this->vars as $name => $value) {
					            $template = str_replace('{' . $name . '}', $value, $template);
					        }
					 
					        return $template;
					    }
					}



        10、常量

              可以把在类中始终保持不变的值定义为常量。在定义和使用常量的时候不需要使用 $ 符号。

              常量的值必须是一个定值，不能是变量，类属性，数学运算的结果或函数调用。

              自 PHP 5.3.0 起，可以用一个变量来动态调用类。但该变量的值不能为关键字（如 self，parent 或 static）。

                               实例
			           <?php
					class MyClass
					{
					    const constant = '常量值';

					    function showConstant() {
					        echo  self::constant . PHP_EOL;
					    }
					}

					echo MyClass::constant . PHP_EOL;

					$classname = "MyClass";
					echo $classname::constant . PHP_EOL; // 自 5.3.0 起

					$class = new MyClass();
					$class->showConstant();

					echo $class::constant . PHP_EOL; // 自 PHP 5.3.0 起
				    ?>



        11、抽象类

             任何一个类，如果它里面至少有一个方法是被声明为抽象的，那么这个类就必须被声明为抽象的。

             定义为抽象的类不能被实例化。

             被定义为抽象的方法只是声明了其调用方式（参数），不能定义其具体的功能实现。

             继承一个抽象类的时候，子类必须定义父类中的所有抽象方法；另外，这些方法的访问控制必须和父类中一样（或者更为宽松）。

             例如某个抽象方法被声明为受保护的，那么子类中实现的方法就应该声明为受保护的或者公有的，而不能定义为私有的。

				    <?php
						abstract class AbstractClass
						{
						 // 强制要求子类定义这些方法
						    abstract protected function getValue();
						    abstract protected function prefixValue($prefix);

						    // 普通方法（非抽象方法）
						    public function printOut() {
						        print $this->getValue() . PHP_EOL;
						    }
						}

						class ConcreteClass1 extends AbstractClass
						{
						    protected function getValue() {
						        return "ConcreteClass1";
						    }

						    public function prefixValue($prefix) {
						        return "{$prefix}ConcreteClass1";
						    }
						}

						class ConcreteClass2 extends AbstractClass
						{
						    public function getValue() {
						        return "ConcreteClass2";
						    }

						    public function prefixValue($prefix) {
						        return "{$prefix}ConcreteClass2";
						    }
						}

						$class1 = new ConcreteClass1;
						$class1->printOut();
						echo $class1->prefixValue('FOO_') . PHP_EOL;

						$class2 = new ConcreteClass2;
						$class2->printOut();
						echo $class2->prefixValue('FOO_') . PHP_EOL;
				  ?>


                              执行以上代码，输出结果为：

                                                  ConcreteClass1
                                                  FOO_ConcreteClass1
                                                  ConcreteClass2
                                                  FOO_ConcreteClass2


                         此外，子类方法可以包含父类抽象方法中不存在的可选参数。

                         例如，子类定义了一个可选参数，而父类抽象方法的声明里没有，则也是可以正常运行的。


			   <?php
				abstract class AbstractClass
				{
				    // 我们的抽象方法仅需要定义需要的参数
				    abstract protected function prefixName($name);

				}

				class ConcreteClass extends AbstractClass
				{

				    // 我们的子类可以定义父类签名中不存在的可选参数
				    public function prefixName($name, $separator = ".") {
				        if ($name == "Pacman") {
				            $prefix = "Mr";
				        } elseif ($name == "Pacwoman") {
				            $prefix = "Mrs";
				        } else {
				            $prefix = "";
				        }
				        return "{$prefix}{$separator} {$name}";
				    }
				}

				$class = new ConcreteClass;
				echo $class->prefixName("Pacman"), "\n";
				echo $class->prefixName("Pacwoman"), "\n";
			   ?>

				输出结果为：
				            Mr. Pacman
				            Mrs. Pacwoman



        12、Static 关键字

                声明类属性或方法为 static(静态)，就可以不实例化类而直接访问。

                静态属性不能通过一个类已实例化的对象来访问（但静态方法可以）。

                由于静态方法不需要通过对象即可调用，所以伪变量 $this 在静态方法中不可用。

                静态属性不可以由对象通过 -> 操作符来访问。

                自 PHP 5.3.0 起，可以用一个变量来动态调用类。但该变量的值不能为关键字 self，parent 或 static。

		   <?php
			class Foo {
			  public static $my_static = 'foo';
			  
			  public function staticValue() {
			     return self::$my_static;
			  }
			}

			print Foo::$my_static . PHP_EOL;
			$foo = new Foo();

			print $foo->staticValue() . PHP_EOL;
		     ?> 
   
		     执行以上程序，输出结果为：

			       foo
			       foo

        13、Final 关键字

             PHP 5 新增了一个 final 关键字。如果父类中的方法被声明为 final，则子类无法覆盖该方法。如果一个类被声明为 final，则不能被继承。

				以下代码执行会报错：

				    <?php
					class BaseClass {

					   public function test() {
					       echo "BaseClass::test() called" . PHP_EOL;
					   }
					   
					   final public function moreTesting() {
					       echo "BaseClass::moreTesting() called"  . PHP_EOL;
					   }
					}

					class ChildClass extends BaseClass {
					   public function moreTesting() {
					       echo "ChildClass::moreTesting() called"  . PHP_EOL;
					   }
					}
					// 报错信息 Fatal error: Cannot override final method BaseClass::moreTesting()
				     ?>


        14、调用父类构造方法

              PHP 不会在子类的构造方法中自动的调用父类的构造方法。要执行父类的构造方法，需要在子类的构造方法中调用 parent::__construct() 。

                                       <?php
						class BaseClass {

						   function __construct() {
						       print "BaseClass 类中构造方法" . PHP_EOL;
						   }
						}

						class SubClass extends BaseClass {

						   function __construct() {
						       parent::__construct();  // 子类构造方法不能自动调用父类的构造方法
						       print "SubClass 类中构造方法" . PHP_EOL;
						   }
						}

						class OtherSubClass extends BaseClass {
						    // 继承 BaseClass 的构造方法
						}

						// 调用 BaseClass 构造方法
						$obj = new BaseClass();

						// 调用 BaseClass、SubClass 构造方法
						$obj = new SubClass();

						// 调用 BaseClass 构造方法
						$obj = new OtherSubClass();
					?>


                                         执行以上程序，输出结果为：

                                                 BaseClass 类中构造方法
                                                 BaseClass 类中构造方法
                                                 SubClass 类中构造方法
                                                 BaseClass 类中构造方法


-------------------------------------------------------------------------------------------------------------------------------------------


二十、PHP 表单和用户输入

       PHP 中的 $_GET 和 $_POST 变量用于检索表单中的信息，比如用户输入。

       1、PHP 表单处理

           有一点很重要的事情值得注意，当处理 HTML 表单时，PHP 能把来自 HTML 页面中的表单元素自动变成可供 PHP 脚本使用。

			    实例：
			       下面的实例包含了一个 HTML 表单，带有两个输入框和一个提交按钮。
			        form.html 文件代码：
					<html>
					   <head>
						<meta charset="utf-8">
						<title>菜鸟教程(runoob.com)</title>
						</head>
						<body>		 
						<form action="welcome.php" method="post">

						     名字: <input type="text" name="fname">

						     年龄: <input type="text" name="age">

						     <input type="submit" value="提交">

						</form>
					        </body>
					  </html>

                          当用户填写完上面的表单并点击提交按钮时，表单的数据会被送往名为 "welcome.php" 的 PHP 文件：

                                  welcome.php 文件代码：
                                                       欢迎<?php echo $_POST["fname"]; ?>!<br>
                                                       你的年龄是 <?php echo $_POST["age"]; ?>  岁。



       2、PHP 获取下拉菜单的数据

            （1）PHP 下拉菜单单选
                    
                      以下实例我们设置了下拉菜单三个选项，表单使用 GET 方式获取数据，action 属性值为空表示提交到当前脚本，我们可以通过 select 的 name 属性获取下拉菜单的值：

                         php_form_select.php 文件代码：

					<?php
						$q = isset($_GET['q'])? htmlspecialchars($_GET['q']) : '';
						if($q) {
						        if($q =='RUNOOB') {
						                echo '菜鸟教程<br>http://www.runoob.com';
						        } else if($q =='GOOGLE') {
						                echo 'Google 搜索<br>http://www.google.com';
						        } else if($q =='TAOBAO') {
						                echo '淘宝<br>http://www.taobao.com';
						        }
						} else {
					?>
					   <form action="" method="get"> 
							    <select name="q">
							    <option value="">选择一个站点:</option>
							    <option value="RUNOOB">Runoob</option>
							    <option value="GOOGLE">Google</option>
							    <option value="TAOBAO">Taobao</option>
							    </select>
							    <input type="submit" value="提交">
					    </form>
					<?php
					     }
					?>


            （2）PHP 下拉菜单多选

                  如果下拉菜单是多选的（ multiple="multiple"），我们可以通过将设置 select name="q[]" 以数组的方式获取，以下使用 POST 方式提交，代码如下所示：

					<?php
						$q = isset($_POST['q'])? $_POST['q'] : '';
						if(is_array($q)) {
						    $sites = array(
						            'RUNOOB' => '菜鸟教程: http://www.runoob.com',
						            'GOOGLE' => 'Google 搜索: http://www.google.com',
						            'TAOBAO' => '淘宝: http://www.taobao.com',
						    );
						    foreach($q as $val) {
						        // PHP_EOL 为常量，用于换行
						        echo $sites[$val] . PHP_EOL;
						    }
						      
						} else {
					?>
					    <form action="" method="post"> 
						    <select multiple="multiple" name="q[]">
						    <option value="">选择一个站点:</option>
						    <option value="RUNOOB">Runoob</option>
						    <option value="GOOGLE">Google</option>
						    <option value="TAOBAO">Taobao</option>
						    </select>
						    <input type="submit" value="提交">
					    </form>
					<?php
					}
					?>


            （3）单选按钮表单

                      PHP 单选按钮表单中 name 属性的值是一致的，value 值是不同的，代码如下所示：

                      php_form_radio.php 文件代码：

						<?php
								$q = isset($_GET['q'])? htmlspecialchars($_GET['q']) : '';
								if($q) {
								        if($q =='RUNOOB') {
								                echo '菜鸟教程<br>http://www.runoob.com';
								        } else if($q =='GOOGLE') {
								                echo 'Google 搜索<br>http://www.google.com';
								        } else if($q =='TAOBAO') {
								                echo '淘宝<br>http://www.taobao.com';
								        }
								} else {
						?>
								<form action="" method="get"> 
								    <input type="radio" name="q" value="RUNOOB" />Runoob
								    <input type="radio" name="q" value="GOOGLE" />Google
								    <input type="radio" name="q" value="TAOBAO" />Taobao
								    <input type="submit" value="提交">
								</form>
						<?php
						}


            （4）checkbox 复选框

                     PHP checkbox 复选框可以选择多个值：

                     php_form_select_checkbox.php 文件代码：

					<?php
						$q = isset($_POST['q'])? $_POST['q'] : '';
						if(is_array($q)) {
						    $sites = array(
						            'RUNOOB' => '菜鸟教程: http://www.runoob.com',
						            'GOOGLE' => 'Google 搜索: http://www.google.com',
						            'TAOBAO' => '淘宝: http://www.taobao.com',
						    );
						    foreach($q as $val) {
						        // PHP_EOL 为常量，用于换行
						        echo $sites[$val] . PHP_EOL;
						    }
						      
						} else {
					?>
						<form action="" method="post"> 
						    <input type="checkbox" name="q[]" value="RUNOOB"> Runoob<br> 
						    <input type="checkbox" name="q[]" value="GOOGLE"> Google<br> 
						    <input type="checkbox" name="q[]" value="TAOBAO"> Taobao<br>
						    <input type="submit" value="提交">
						</form>
					<?php
					}
					?>


    ###########################################################

              额外知识：

                     PHP htmlspecialchars() 函数，return string类型

                     实例
                     把预定义的字符 "<" （小于）和 ">" （大于）转换为 HTML 实体：

                           <?php
                             $str = "This is some <b>bold</b> text.";
                             echo htmlspecialchars($str);
                           ?>

                           以上代码的 HTML 输出如下（查看源代码）：

                           <!DOCTYPE html>
                           <html>
                            <body>

                               This is some <b>bold</b> text.

                            </body>
                           </html>

                           以上代码的浏览器输出：

                                      This is some <b>bold</b> text.


            （5）表单验证

                   我们应该尽可能的对用户的输入进行验证（通过客户端脚本）。浏览器验证速度更快，并且可以减轻服务器的压力。

                   如果用户输入需要插入数据库，您应该考虑使用服务器验证。在服务器验证表单的一种好的方式是，把表单的数据传给当前页面（异步提交的方式更好），而不是跳转到不同的页面。这样用户就可以在同一张表单页面得到错误信息。用户也就更容易发现错误了。


            （6）注意

                     $_GET、$_POST 和 $_REQUEST 的区别？

                     $_GET 变量接受所有以 get 方式发送的请求，及浏览器地址栏中的 ? 之后的内容。

                     $_POST 变量接受所有以 post 方式发送的请求，例如，一个 form 以 method=post 提交，提交后 php 会处理 post 过来的全部变量

                     $_REQUEST 支持两种方式发送过来的请求，即 post 和 get 它都可以接受，显示不显示要看传递方法，get 会显示在 url 中（有字符数限制），post 不会在 url 中显示，可以传递任意多的数据（只要服务器支持）。



-------------------------------------------------------------------------------------------------------------------------------------------


二十一、PHP 表单验证

         本章节我们将介绍如何使用PHP验证客户端提交的表单数据。

         1、PHP 表单验证

             在本章节介绍的HTML表单中包含以下输入字段： 必须与可选文本字段，单选按钮，及提交按钮：

			<!DOCTYPE HTML> 
			<html>
			<head>
			<meta charset="utf-8">
			<title>菜鸟教程(runoob.com)</title>
			<style>
			.error {color: #FF0000;}
			</style>
			</head>
			<body> 

					<?php
					// 定义变量并默认设置为空值
					$nameErr = $emailErr = $genderErr = $websiteErr = "";
					$name = $email = $gender = $comment = $website = "";

					if ($_SERVER["REQUEST_METHOD"] == "POST")
					{
					    if (empty($_POST["name"]))
					    {
					        $nameErr = "名字是必需的";
					    }
					    else
					    {
					        $name = test_input($_POST["name"]);
					        // 检测名字是否只包含字母跟空格
					        if (!preg_match("/^[a-zA-Z ]*$/",$name))
					        {
					            $nameErr = "只允许字母和空格"; 
					        }
					    }
					    
					    if (empty($_POST["email"]))
					    {
					      $emailErr = "邮箱是必需的";
					    }
					    else
					    {
					        $email = test_input($_POST["email"]);
					        // 检测邮箱是否合法
					        if (!preg_match("/([\w\-]+\@[\w\-]+\.[\w\-]+)/",$email))
					        {
					            $emailErr = "非法邮箱格式"; 
					        }
					    }
					    
					    if (empty($_POST["website"]))
					    {
					        $website = "";
					    }
					    else
					    {
					        $website = test_input($_POST["website"]);
					        // 检测 URL 地址是否合法
					        if (!preg_match("/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&@#\/%?=~_|!:,.;]*[-a-z0-9+&@#\/%=~_|]/i",$website))
					        {
					            $websiteErr = "非法的 URL 的地址"; 
					        }
					    }
					    
					    if (empty($_POST["comment"]))
					    {
					        $comment = "";
					    }
					    else
					    {
					        $comment = test_input($_POST["comment"]);
					    }
					    
					    if (empty($_POST["gender"]))
					    {
					        $genderErr = "性别是必需的";
					    }
					    else
					    {
					        $gender = test_input($_POST["gender"]);
					    }
					}

					function test_input($data)
					{
					    $data = trim($data);
					    $data = stripslashes($data);
					    $data = htmlspecialchars($data);
					    return $data;
					}
					?>

					<h2>PHP 表单验证实例</h2>
					<p><span class="error">* 必需字段。</span></p>
					<form method="post" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>"> 
					   名字: <input type="text" name="name" value="<?php echo $name;?>">
					   <span class="error">* <?php echo $nameErr;?></span>
					   <br><br>
					   E-mail: <input type="text" name="email" value="<?php echo $email;?>">
					   <span class="error">* <?php echo $emailErr;?></span>
					   <br><br>
					   网址: <input type="text" name="website" value="<?php echo $website;?>">
					   <span class="error"><?php echo $websiteErr;?></span>
					   <br><br>
					   备注: <textarea name="comment" rows="5" cols="40"><?php echo $comment;?></textarea>
					   <br><br>
					   性别:
					   <input type="radio" name="gender" 
                                               <?php if (isset($gender) && $gender=="female") echo "checked";?>  value="female">女

					   <input type="radio" name="gender" 
                                                <?php if (isset($gender) && $gender=="male") echo "checked";?>  value="male">男
					   <span class="error">* <?php echo $genderErr;?></span>
					   <br><br>
					   <input type="submit" name="submit" value="Submit"> 
					</form>

					<?php
					echo "<h2>您输入的内容是:</h2>";
					echo $name;
					echo "<br>";
					echo $email;
					echo "<br>";
					echo $website;
					echo "<br>";
					echo $comment;
					echo "<br>";
					echo $gender;
					?>

			</body>
			</html>


               额外知识：

                    ①、stripslashes（）函数

                          stripslashes() 函数删除由 addslashes() 函数添加的反斜杠。

                        实例：
                             删除反斜杠：
                                         <?php
                                               echo stripslashes("Who\'s Bill Gates?");
                                         ?>

                    ②、trim() 函数

                         语法：trim(string,charlist)

                         trim() 函数移除字符串两侧的空白字符或其他预定义字符。
       
                              相关函数：

                                       ltrim() - 移除字符串左侧的空白字符或其他预定义字符。
                                       rtrim() - 移除字符串右侧的空白字符或其他预定义字符。

                         实例
                             移除字符串左侧的字符（"Hello" 中的 "He"以及 "World" 中的 "d!"）：

                                 <?php
                                       $str = "Hello World!";
                                       echo $str . "<br>";
                                       echo trim($str,"Hed!");
                                 ?>

         2、文本字段

             "名字", "E-mail", 及"网址"字段为文本输入元素，"备注"字段是 textarea。HTML代码如下所示:

               “名字”: <input type="text" name="name">

                E-mail: <input type="text" name="email">

                网址: <input type="text" name="website">

                备注: <textarea name="comment" rows="5" cols="40"></textarea>


         3、单选按钮

             "性别"字段是单选按钮，HTML代码如下所示：

              性别:
                    <input type="radio" name="gender" value="female">女

                    <input type="radio" name="gender" value="male">男


         4、表单元素

             HTML 表单代码如下所示:

                 <form method="post" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>">

                ①、该表单使用 method="post" 方法来提交数据。

	        ②、什么是 $_SERVER["PHP_SELF"] 变量?

                      $_SERVER["PHP_SELF"]是超级全局变量，返回当前正在执行脚本的文件名，与 document root相关。

                      所以， $_SERVER["PHP_SELF"] 会发送表单数据到当前页面，而不是跳转到不同的页面。

	        ③、什么是 htmlspecialchars()方法?

                      htmlspecialchars() 函数把一些预定义的字符转换为 HTML 实体。

                      预定义的字符是：

                                      & （和号） 成为 &amp;
                                      " （双引号） 成为 &quot;
                                      ' （单引号） 成为 &#039;
                                      < （小于） 成为 &lt;
                                      > （大于） 成为 &gt;


         5、PHP表单中需引起注重的地方？

             $_SERVER["PHP_SELF"] 变量有可能会被黑客使用！

             当黑客使用跨网站脚本的HTTP链接来攻击时，$_SERVER["PHP_SELF"]服务器变量也会被植入脚本。原因就是跨网站脚本是附在执行文件的路径后面的，因此$_SERVER["PHP_SELF"]的字符串就会包含HTTP链接后面的JavaScript程序代码。

             XSS又叫 CSS (Cross-Site Script) ,跨站脚本攻击。恶意攻击者往Web页面里插入恶意html代码，当用户浏览该页之时，嵌入其中Web里面的html代码会被执行，从而达到恶意用户的特殊目的。

             实例：

                  指定以下表单文件名为 "test_form.php":

                       <form method="post" action="<?php echo $_SERVER["PHP_SELF"];?>">

                  现在，我们使用URL来指定提交地址 "test_form.php",以上代码修改为如下所示:

                       <form method="post" action="test_form.php">

                  这样做就很好了。

                       但是，考虑到用户会在浏览器地址栏中输入以下地址:

                             http://www.runoob.com/test_form.php/%22%3E%3Cscript%3Ealert('hacked')%3C/script%3E

                       以上的 URL 中，将被解析为如下代码并执行：

                             <form method="post" action="test_form.php/"><script>alert('hacked')</script>


                       代码中添加了 script 标签，并添加了alert命令。 当页面载入时会执行该Javascript代码（用户会看到弹出框）。 这仅仅只是一个简单的实例来说明PHP_SELF变量会被黑客利用。

                       请注意， 任何JavaScript代码可以添加在<script>标签中！ 黑客可以利用这点重定向页面到另外一台服务器的页面上，页面 代码文件中可以保护恶意代码，代码可以修改全局变量或者获取用户的表单数据。



         6、如何避免 $_SERVER["PHP_SELF"] 被利用?

              $_SERVER["PHP_SELF"] 可以通过 htmlspecialchars() 函数来避免被利用。

                  form 代码如下所示：

                           <form method="post" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>">

                  htmlspecialchars() 把一些预定义的字符转换为 HTML 实体。现在如果用户想利用 PHP_SELF 变量, 结果将输出如下所示：

                          <form method="post" action="test_form.php/&quot;&gt;&lt;script&gt;alert('hacked')&lt;/script&gt;">


                  即会尝试该漏洞失败！


         7、使用 PHP 验证表单数据

              首先我们对用户所有提交的数据都通过 PHP 的 htmlspecialchars() 函数处理。

              当我们使用 htmlspecialchars() 函数时，在用户尝试提交以下文本域:

                              <script>location.href('http://www.runoob.com')</script>


              该代码将不会被执行，因为它会被保存为HTML转义代码，如下所示：

                              &lt;script&gt;location.href('http://www.runoob.com')&lt;/script&gt;


              以上代码是安全的，可以正常在页面显示或者插入邮件中。

                   当用户提交表单时，我们将做以下两件事情：

                       1、使用 PHP trim() 函数去除用户输入数据中不必要的字符 (如：空格，tab，换行)。

                       2、使用PHP stripslashes()函数去除用户输入数据中的反斜杠 (\)

              接下来让我们将这些过滤的函数写在一个我们自己定义的函数中，这样可以大大提高代码的复用性。

                将函数命名为 test_input()。

                现在，我们可以通过test_input()函数来检测 $_POST 中的所有变量, 脚本代码如下所示：

		实例
		<?php
			// 定义变量并默认设置为空值
			$name = $email = $gender = $comment = $website = "";
			 
			if ($_SERVER["REQUEST_METHOD"] == "POST")
			{
			  $name = test_input($_POST["name"]);
			  $email = test_input($_POST["email"]);
			  $website = test_input($_POST["website"]);
			  $comment = test_input($_POST["comment"]);
			  $gender = test_input($_POST["gender"]);
			}
			 
			function test_input($data)
			{
			  $data = trim($data);
			  $data = stripslashes($data);
			  $data = htmlspecialchars($data);
			  return $data;
			}
		?>

                注意我们在执行以上脚本时，会通过$_SERVER["REQUEST_METHOD"]来检测表单是否被提交 。如果 REQUEST_METHOD 是 POST, 表单将被提交 - 数据将被验证。如果表单未提交将跳过验证并显示空白。

                在以上实例中使用输入项都是可选的，即使用户不输入任何数据也可以正常显示。

                在接下来的章节中我们将介绍如何对用户输入的数据进行验证。

-------------------------------------------------------------------------------------------------------------------------------------------


二十二、PHP 表单 - 必需字段

   1、PHP - 必需字段

        在上一章节我们已经介绍了表的验证规则，我们可以看到"名字", "E-mail", 和 "性别" 字段是必需的，各字段不能为空。


                    字段	                      验证规则

                    名字	                      必需。 + 只能包含字母和空格

                    E-mail	                      必需。 + 必需包含一个有效的电子邮件地址（包含"@"和"."）

                    网址	                      可选。 如果存在，它必需包含一个有效的URL

                    备注	                      可选。多行字段（文本域）。

                    性别	                      必需。必需选择一个。

                如果在前面的章节中，所有输入字段都是可选的。

                在以下代码中我们加入了一些新的变量: $nameErr, $emailErr, $genderErr, 和 $websiteErr.。这些错误变量将显示在必需字段上。 我们还为每个$_POST变量增加了一个if else语句。 这些语句将检查 $_POST 变量是 否为空（使用php的 empty() 函数）。如果为空，将显示对应的错误信息。 如果不为空，数据将传递给test_input() 函数：

              <?php
                    // 定义变量并默认设为空值
                    $nameErr = $emailErr = $genderErr = $websiteErr = "";
                    $name = $email = $gender = $comment = $website = "";

                    if ($_SERVER["REQUEST_METHOD"] == "POST") {
                      if (empty($_POST["name"])) {
                        $nameErr = "名字是必需的。";
                      } else {
                        $name = test_input($_POST["name"]);
                      }

                      if (empty($_POST["email"])) {
                        $emailErr = "邮箱是必需的。";
                      } else {
                        $email = test_input($_POST["email"]);
                      }

                      if (empty($_POST["website"])) {
                        $website = "";
                      } else {
                        $website = test_input($_POST["website"]);
                      }

                      if (empty($_POST["comment"])) {
                        $comment = "";
                      } else {
                        $comment = test_input($_POST["comment"]);
                      }

                      if (empty($_POST["gender"])) {
                        $genderErr = "性别是必需的。";
                      } else {
                        $gender = test_input($_POST["gender"]);
                      }
                    }
              ?>


   2、PHP - 显示错误信息

             在以下的HTML实例表单中，我们为每个字段中添加了一些脚本， 各个脚本会在信息输入错误时显示错误信息。(如果用户未填写信息就提交表单则会输出错误信息):

               <form method="post" action="<?php echo htmlspecialchars($_SERVER['PHP_SELF']);?>"> 

                  名字: <input type="text" name="name">
                  <span class="error">* <?php echo $nameErr;?></span>
                  <br><br>

                  E-mail: <input type="text" name="email">
                  <span class="error">* <?php echo $emailErr;?></span>
                  <br><br>

                  网址: <input type="text" name="website">
                  <span class="error"><?php echo $websiteErr;?></span>
                  <br><br>

                  备注: <textarea name="comment" rows="5" cols="40"></textarea>
                  <br><br>

                  性别:
                  <input type="radio" name="gender" value="female">女
                  <input type="radio" name="gender" value="male">男
                  <span class="error">* <?php echo $genderErr;?></span>
                  <br><br>

                  <input type="submit" name="submit" value="Submit"> 
               </form>



-------------------------------------------------------------------------------------------------------------------------------------------


二十三、PHP 表单 - 验证邮件和URL

         本章节我们将介绍如何验证 names(名称), e-mails（邮件）, 和 URLs。

         1、PHP - 验证名称

              以下代码将通过简单的方式来检测 name 字段是否包含字母和空格，如果 name 字段值不合法，将输出错误信息：

                $name = test_input($_POST["name"]);

                if (!preg_match("/^[a-zA-Z ]*$/",$name)) {

                          $nameErr = "只允许字母和空格"; 
                }

	      preg_match ― 进行正则表达式匹配。

                   语法：int preg_match ( string $pattern , string $subject [, array $matches [, int $flags ]] )

                在 subject 字符串中搜索与 pattern 给出的正则表达式相匹配的内容。如果提供了 matches ，则其会被搜索的结果所填充。$matches[0] 将包含与整个模式匹配的文本，$matches[1] 将包含与第一个捕获的括号中的子模式所匹配的文本，以此类推。


         2、PHP - 验证邮件

            以下代码将通过简单的方式来检测 e-mail 地址是否合法。如果 e-mail 地址不合法，将输出错误信息：

                         $email = test_input($_POST["email"]);

                         if (!preg_match("/([\w\-]+\@[\w\-]+\.[\w\-]+)/",$email)) {
 
                                        $emailErr = "非法邮箱格式"; 
                         }


         3、PHP - 验证 URL

            以下代码将检测URL地址是否合法 (以下正则表达式运行URL中含有破折号:"-")， 如果 URL 地址不合法，将输出错误信息：

              $website = test_input($_POST["website"]);

              if (!preg_match("/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&@#\/%?=~_|!:,.;]*[-a-z0-9+&@#\/%=~_|]/i",$website)) {

                                      $websiteErr = "非法的 URL 的地址"; 
              }


         4、PHP - 验证 Name, E-mail, 和 URL

            代码如下所示:

               <?php
                     // 定义变量并默认设置为空值
                     $nameErr = $emailErr = $genderErr = $websiteErr = "";
                     $name = $email = $gender = $comment = $website = "";

                     if ($_SERVER["REQUEST_METHOD"] == "POST") {
                        if (empty($_POST["name"])) {
                           $nameErr = "Name is required";
                           } else {
                              $name = test_input($_POST["name"]);
                              // 检测名字是否只包含字母跟空格
                              if (!preg_match("/^[a-zA-Z ]*$/",$name)) {
                              $nameErr = "只允许字母和空格"; 
                              }
                          }
                        
                        if (empty($_POST["email"])) {
                           $emailErr = "Email is required";
                        } else {
                           $email = test_input($_POST["email"]);
                           // 检测邮箱是否合法
                           if (!preg_match("/([\w\-]+\@[\w\-]+\.[\w\-]+)/",$email)) {
                              $emailErr = "非法邮箱格式"; 
                           }
                        }
                          
                        if (empty($_POST["website"])) {
                           $website = "";
                        } else {
                           $website = test_input($_POST["website"]);
                           // 检测 URL 地址是否合法
                          if (!preg_match("/\b(?:(?:https?|ftp):\/\/|www\.)[-a-z0-9+&@#\/%?=~_|!:,.;]*[-a-z0-9+&@#\/%=~_|]/i",$website)) {
                              $websiteErr = "非法的 URL 的地址"; 
                           }
                        }

                        if (empty($_POST["comment"])) {
                           $comment = "";
                        } else {
                           $comment = test_input($_POST["comment"]);
                        }

                        if (empty($_POST["gender"])) {
                           $genderErr = "性别是必需的";
                        } else {
                           $gender = test_input($_POST["gender"]);
                        }
                     }
               ?>



-------------------------------------------------------------------------------------------------------------------------------------------


二十四、PHP 完整表单实例：http://www.runoob.com/php/php-form-complete.html

     本章节将介绍如何让用户在点击"提交（submit）"按钮提交数据前保证所有字段正确输入。

     1、PHP - 在表单中确保输入值

         在用户点击提交按钮后，为确保字段值是否输入正确，我们在HTML的input元素中插添加PHP脚本， 各字段名为: name, email, 和 website。 在备注中的 textarea 字段中，我们将脚本放于 <textarea> 和 </textarea> 标签之间。

         PHP脚本输出值为： $name, $email, $website, 和 $comment 变量。 

         然后，我们同样需要检查被选中的单选按钮， 对于这一点，我们 必须设置好checked属性(不是radio按钮的 value 属性) :

              <form method="post" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>"> 
                  名字: <input type="text" name="name" value="<?php echo $name;?>">
                  <span class="error">* <?php echo $nameErr;?></span>
                  <br><br>
                  E-mail: <input type="text" name="email" value="<?php echo $email;?>">
                  <span class="error">* <?php echo $emailErr;?></span>
                  <br><br>
                  网址: <input type="text" name="website" value="<?php echo $website;?>">
                  <span class="error"><?php echo $websiteErr;?></span>
                  <br><br>
                  备注: <textarea name="comment" rows="5" cols="40"><?php echo $comment;?></textarea>
                  <br><br>
                  性别:
                  <input type="radio" name="gender" <?php if (isset($gender) && $gender=="female") echo "checked";?>  value="female">女
                  <input type="radio" name="gender" <?php if (isset($gender) && $gender=="male") echo "checked";?>  value="male">男
                  <span class="error">* <?php echo $genderErr;?></span>
                  <br><br>
                  <input type="submit" name="submit" value="Submit"> 
               </form>


-------------------------------------------------------------------------------------------------------------------------------------------


二十五、PHP $_GET 变量

      在 PHP 中，预定义的 $_GET 变量用于收集来自 method="get" 的表单中的值。

      1、$_GET 变量

           预定义的 $_GET 变量用于收集来自 method="get" 的表单中的值。

           从带有 GET 方法的表单发送的信息，对任何人都是可见的（会显示在浏览器的地址栏），并且对发送信息的量也有限制。

           实例
             form.html 文件代码如下：
                  <html>
                  <head>
                  <meta charset="utf-8">
                  <title>菜鸟教程(runoob.com)</title>
                  </head>
                  <body>
                     <form action="welcome.php" method="get">
                     名字: <input type="text" name="fname">
                     年龄: <input type="text" name="age">
                     <input type="submit" value="提交">
                     </form>
                  </body>
                  </html>

          当用户点击 "Submit" 按钮时，发送到服务器的 URL 如下所示：

                               http://www.runoob.com/welcome.php?fname=Runoob&amp;age=3


           "welcome.php" 文件现在可以通过 $_GET 变量来收集表单数据了（请注意，表单域的名称会自动成为 $_GET 数组中的键）：

                               欢迎 <?php echo $_GET["fname"]; ?>!<br>
                              你的年龄是 <?php echo $_GET["age"]; ?>  岁。


      2、何时使用 method="get"？

               在 HTML 表单中使用 method="get" 时，所有的变量名和值都会显示在 URL 中。

               注释：所以在发送密码或其他敏感信息时，不应该使用这个方法！

               然而，正因为变量显示在 URL 中，因此可以在收藏夹中收藏该页面。在某些情况下，这是很有用的。

               注释：HTTP GET 方法不适合大型的变量值。它的值是不能超过 2000 个字符的。


-------------------------------------------------------------------------------------------------------------------------------------------


二十六、PHP $_POST 变量
 
    在 PHP 中，预定义的 $_POST 变量用于收集来自 method="post" 的表单中的值。

    1、$_POST 变量

         预定义的 $_POST 变量用于收集来自 method="post" 的表单中的值。

         从带有 POST 方法的表单发送的信息，对任何人都是不可见的（不会显示在浏览器的地址栏），并且对发送信息的量也没有限制。

         注释：然而，默认情况下，POST 方法的发送信息的量最大值为 8 MB（可通过设置 php.ini 文件中的 post_max_size 进行更改）。

              实例
                form.html 文件代码如下：

                        <html>
                        <head>
                        <meta charset="utf-8">
                        <title>菜鸟教程(runoob.com)</title>
                        </head>
                        <body>

                           <form action="welcome.php" method="post">
                           名字: <input type="text" name="fname">
                           年龄: <input type="text" name="age">
                           <input type="submit" value="提交">
                           </form>

                        </body>
                        </html>

             当用户点击 "提交" 按钮时，URL 类似如下所示：

                               http://www.runoob.com/welcome.php

             "welcome.php" 文件现在可以通过 $_POST 变量来收集表单数据了（请注意，表单域的名称会自动成为 $_POST 数组中的键）：

                                 欢迎 <?php echo $_POST["fname"]; ?>!<br>
                                 你的年龄是 <?php echo $_POST["age"]; ?>  岁。



    2、何时使用 method="post"？

          从带有 POST 方法的表单发送的信息，对任何人都是不可见的，并且对发送信息的量也没有限制。

          然而，由于变量不显示在 URL 中，所以无法把页面加入书签。


    3、PHP $_REQUEST 变量

          预定义的 $_REQUEST 变量包含了 $_GET、$_POST 和 $_COOKIE 的内容。

          $_REQUEST 变量可用来收集通过 GET 和 POST 方法发送的表单数据。

          实例：

             你可以将 "welcome.php" 文件修改为如下代码，它可以接受 $_GET、$_POST等数据。

                                 欢迎 <?php echo $_REQUEST["fname"]; ?>!<br>

                                 你的年龄是 <?php echo $_REQUEST["age"]; ?>  岁。


-------------------------------------------------------------------------------------------------------------------------------------------


二十七、PHP 多维数组

      一个数组中的值可以是另一个数组，另一个数组的值也可以是一个数组。依照这种方式，我们可以创建二维或者三维数组：

      实例
             <?php
               // 二维数组:
               $cars = array
               (
                   array("Volvo",100,96),
                   array("BMW",60,59),
                   array("Toyota",110,100)
               );
             ?>


      1、PHP - 多维数组

           多维数组是包含一个或多个数组的数组。

           在多维数组中，主数组中的每一个元素也可以是一个数组，子数组中的每一个元素也可以是一个数组。


            实例
            在这个实例中，我们创建了一个自动分配 ID 键的多维数组：

            实例
            <?php 
                  $sites = array 
                  ( 
                      "runoob"=>array 
                      ( 
                          "菜鸟教程", 
                          "http://www.runoob.com" 
                      ), 
                      "google"=>array 
                      ( 
                          "Google 搜索", 
                          "http://www.google.com" 
                      ), 
                      "taobao"=>array 
                      ( 
                          "淘宝", 
                          "http://www.taobao.com" 
                      ) 
                  ); 
                  print("<pre>"); // 格式化输出数组    注意： 这里的<pre></pre>标签可以格式化输出数组， 这么神奇？？
                  print_r($sites); 
                  print("</pre>"); 
            ?>

           上面的数组将输出如下：

                  Array
                  (
                      [runoob] => Array
                          (
                              [0] => 菜鸟教程
                              [1] => http://www.runoob.com
                          )

                      [google] => Array
                          (
                              [0] => Google 搜索
                              [1] => http://www.google.com
                          )

                      [taobao] => Array
                          (
                              [0] => 淘宝
                              [1] => http://www.taobao.com
                          )

                  )


            


             实例 2
                 
                 让我们试着显示上面数组中的某个值：

                      echo $sites['runoob'][0] . '地址为：' . $sites['runoob'][1];

                 上面的代码将输出：

                      菜鸟教程地址为：http://www.runoob.com


-------------------------------------------------------------------------------------------------------------------------------------------


二十八、PHP date() 函数

        PHP date() 函数用于格式化时间/日期。

        1、PHP date() 函数

            PHP date() 函数可把时间戳格式化为可读性更好的日期和时间。

            Tip时间戳是一个字符序列，表示一定的事件发生的日期/时间。

            语法：string date ( string $format [, int $timestamp ] )

                    参数	              描述

                    format	              必需。规定时间戳的格式。

                    timestamp	              可选。规定时间戳。默认是当前的日期和时间。


        2、PHP Date() - 格式化日期

            date() 函数的第一个必需参数 format 规定了如何格式化日期/时间。

            这里列出了一些可用的字符：

                         d - 代表月中的天 (01 - 31)
                         m - 代表月 (01 - 12)
                         Y - 代表年 (四位数)

            如需了解 format 参数中可用的所有字符列表，请查阅我们的 PHP Date 参考手册，date() 函数。

            可以在字母之间插入其他字符，比如 "/"、"." 或者 "-"，这样就可以增加附加格式了：

                    <?php
                          echo date("Y/m/d") . "<br>";
                          echo date("Y.m.d") . "<br>";
                          echo date("Y-m-d");
                    ?>

            上面代码的输出如下所示：

                              2016/10/21
                              2016.10.21
                              2016-10-21


           格式字串可以识别以下 format 参数的字符串： http://www.runoob.com/php/php-date.html




-------------------------------------------------------------------------------------------------------------------------------------------


二十九、PHP 包含文件

   1、PHP include 和 require 语句

        在 PHP 中，您可以在服务器执行 PHP 文件之前在该文件中插入一个文件的内容。

        include 和 require 语句用于在执行流中插入写在其他文件中的有用的代码。

             include 和 require 除了处理错误的方式不同之外，在其他方面都是相同的：

                  require 生成一个致命错误（E_COMPILE_ERROR），在错误发生后脚本会停止执行。

                  include 生成一个警告（E_WARNING），在错误发生后脚本会继续执行。

        因此，如果您希望继续执行，并向用户输出结果，即使包含文件已丢失，那么请使用 include。否则，在框架、CMS 或者复杂的 PHP 应用程序编程中，请始终使用 require 向执行流引用关键文件。这有助于提高应用程序的安全性和完整性，在某个关键文件意外丢失的情况下。

        包含文件省去了大量的工作。这意味着您可以为所有网页创建标准页头、页脚或者菜单文件。然后，在页头需要更新时，您只需更新这个页头包含文件即可。

        语法：
             include 'filename';

            或者

             require 'filename';


   2、PHP include 和 require 语句

        基础实例：

            假设您有一个标准的页头文件，名为 "header.php"。如需在页面中引用这个页头文件，请使用 include/require：

                     <html>
                     <head>
                       <meta charset="utf-8">
                       <title>菜鸟教程(runoob.com)</title>
                     </head>
                     <body>

                        <?php include 'header.php'; ?>
                        <h1>欢迎来到我的主页!</h1>
                        <p>一些文本。</p>

                     </body>
                     </html>


        实例 2

            假设我们有一个在所有页面中使用的标准菜单文件。

             "menu.php":
                         echo '<a href="/">主页</a>
                         <a href="/html">HTML 教程</a>
                         <a href="/php">PHP 教程</a>';

             网站中的所有页面均应引用该菜单文件。以下是具体的做法：

                  <html>
                  <head>
                  <meta charset="utf-8">
                  <title>菜鸟教程(runoob.com)</title>
                  </head>
                  <body>
                       <div class="leftmenu">
                              <?php include 'menu.php'; ?>
                       </div>
                       <h1>欢迎来到我的主页!</h1>
                       <p>一些文本。</p>
                  </body>
                  </html>


        实例 3

            假设我们有一个定义变量的包含文件（"vars.php"）：

                               <?php
                                     $color='red';
                                     $car='BMW';
                               ?>     

            这些变量可用在调用文件中：

                     <html>
                     <head>
                     <meta charset="utf-8">
                     <title>菜鸟教程(runoob.com)</title>
                     </head>
                        <body>
                              <h1>欢迎来到我的主页!</h1>
                              <?php 
                                 include 'vars.php';
                                 echo "I have a $color $car"; // I have a red BMW
                              ?>
                        </body>
                     </html>


            注意：include 和 require 的区别：

                       require 一般放在 PHP 文件的最前面，程序在执行前就会先导入要引用的文件；

                       include 一般放在程序的流程控制中，当程序执行时碰到才会引用，简化程序的执行流程。

                       require 引入的文件有错误时，执行会中断，并返回一个致命错误；

                       include 引入的文件有错误时，会继续执行，并返回一个警告。



-------------------------------------------------------------------------------------------------------------------------------------------


三十、PHP 文件处理
 
     fopen() 函数用于在 PHP 中打开文件。

     1、打开文件

           fopen() 函数用于在 PHP 中打开文件。

           此函数的第一个参数含有要打开的文件的名称，第二个参数规定了使用哪种模式来打开文件：

                     <html>
                        <body>

                        <?php
                        $file=fopen("welcome.txt","r");
                        ?>

                       </body>
                     </html>


           文件可能通过下列模式来打开：

                                    模式	                    描述

                                    r	                            只读。在文件的开头开始。

                                    r+	                            读/写。在文件的开头开始。

                                    w	                            只写。打开并清空文件的内容；如果文件不存在，则创建新文件。

                                    w+	                            读/写。打开并清空文件的内容；如果文件不存在，则创建新文件。

                                    a	                            追加。打开并向文件末尾进行写操作，如果文件不存在，则创建新文件。

                                    a+	                            读/追加。通过向文件末尾写内容，来保持文件内容。

                                    x	                            只写。创建新文件。如果文件已存在，则返回 FALSE 和一个错误。

                                    x+	                            读/写。创建新文件。如果文件已存在，则返回 FALSE 和一个错误。


              注释：如果 fopen() 函数无法打开指定文件，则返回 0 (false)。


        实例：

           如果 fopen() 函数不能打开指定的文件，下面的实例会生成一段消息：

                  <html>
                  <body>
                        <?php
                        $file=fopen("welcome.txt","r") or exit("Unable to open file!");
                        ?>
                  </body>
                  </html>  




     2、关闭文件

              fclose() 函数用于关闭打开的文件：

                        <?php
                             $file = fopen("test.txt","r");

                             //执行一些代码

                             fclose($file);
                        ?>


     3、检测文件末尾（EOF）

             feof() 函数检测是否已到达文件末尾（EOF）。

                在循环遍历未知长度的数据时，feof() 函数很有用。

                注释：在 w 、a 和 x 模式下，您无法读取打开的文件！

                     if (feof($file)) echo "文件结尾";


     4、逐行读取文件

           fgets() 函数用于从文件中逐行读取文件。

           注释：在调用该函数之后，文件指针会移动到下一行。

           实例
               下面的实例逐行读取文件，直到文件末尾为止：

                    <?php
                          $file = fopen("welcome.txt", "r") or exit("无法打开文件!");
                          // 读取文件每一行，直到文件结尾
                          while(!feof($file))
                          {
                              echo fgets($file). "<br>";
                          }
                          fclose($file);
                     ?>

     5、逐字符读取文件

           fgetc() 函数用于从文件中逐字符地读取文件。

           注释：在调用该函数之后，文件指针会移动到下一个字符。

                     实例
                          下面的实例逐字符地读取文件，直到文件末尾为止：

                              <?php
                                    $file=fopen("welcome.txt","r") or exit("无法打开文件!");
                                    while (!feof($file))
                                    {
                                        echo fgetc($file);
                                    }
                                    fclose($file);
                              ?>

            PHP Filesystem 参考手册：  http://www.runoob.com/php/php-file.html


    #############################################################################################

    一、PHP 文件打开/读取/读取

         在本节中，我们向您讲解如何在服务器上打开、读取以及关闭文件。

         1、PHP Open File - fopen()

             打开文件的更好的方法是通过 fopen() 函数。此函数为您提供比 readfile() 函数更多的选项。

             在课程中，我们将使用文本文件 "webdictionary.txt"：

                                         AJAX = Asynchronous JavaScript and XML
                                         CSS = Cascading Style Sheets
                                         HTML = Hyper Text Markup Language
                                         PHP = PHP Hypertext Preprocessor
                                         SQL = Structured Query Language
                                         SVG = Scalable Vector Graphics
                                         XML = EXtensible Markup Language

             （1）、fopen() 的第一个参数包含被打开的文件名，第二个参数规定打开文件的模式。如果 fopen() 函数未能打开指定的文件，下面的例子会生成一段消息：

             实例：
                       <?php
                            $myfile = fopen("webdictionary.txt", "r") or die("Unable to open file!");
                            echo fread($myfile,filesize("webdictionary.txt"));
                            fclose($myfile);
                       ?>

            文件会以如下模式之一打开：

                    模式	描述

                     r	        打开文件为只读。文件指针在文件的开头开始。

                     w	        打开文件为只写。删除文件的内容或创建一个新的文件，如果它不存在。文件指针在文件的开头开始。

                     a	        打开文件为只写。文件中的现有数据会被保留。文件指针在文件结尾开始。创建新的文件，如果文件不存在。

                     x	        创建新文件为只写。返回 FALSE 和错误，如果文件已存在。

                     r+	        打开文件为读/写、文件指针在文件开头开始。

                     w+	        打开文件为读/写。删除文件内容或创建新文件，如果它不存在。文件指针在文件开头开始。

                     a+	        打开文件为读/写。文件中已有的数据会被保留。文件指针在文件结尾开始。创建新文件，如果它不存在。

                     x+	        创建新文件为读/写。返回 FALSE 和错误，如果文件已存在。


             （2）、PHP 读取文件 - fread()

                    fread() 函数读取打开的文件。

                    fread() 的第一个参数包含待读取文件的文件名，第二个参数规定待读取的最大字节数。

                    如下 PHP 代码把 "webdictionary.txt" 文件读至结尾：

                                                    fread($myfile,filesize("webdictionary.txt"));



             （3）、PHP 关闭文件 - fclose()

                    fclose() 函数用于关闭打开的文件。

                    注释：用完文件后把它们全部关闭是一个良好的编程习惯。您并不想打开的文件占用您的服务器资源。

                    fclose() 需要待关闭文件的名称（或者存有文件名的变量）：

                            <?php
                                   $myfile = fopen("webdictionary.txt", "r");
                                   // some code to be executed....
                                   fclose($myfile);
                             ?>


             （4）、PHP 读取单行文件 - fgets()

                    下例输出 "webdictionary.txt" 文件的首行：

                    实例
                    <?php
                            $myfile = fopen("webdictionary.txt", "r") or die("Unable to open file!");
                            echo fgets($myfile);
                            fclose($myfile);
                    ?>

                   注释：调用 fgets() 函数之后，文件指针会移动到下一行。



             （5）、PHP 检查 End-Of-File - feof()

                        feof() 函数检查是否已到达 "end-of-file" (EOF)。

                        feof() 对于遍历未知长度的数据很有用。

                     下例逐行读取 "webdictionary.txt" 文件，直到 end-of-file：

                     实例
                         <?php
                                $myfile = fopen("webdictionary.txt", "r") or die("Unable to open file!");

                                // 输出单行直到 end-of-file
                                while(!feof($myfile)) {

                                  echo fgets($myfile) . "<br>";

                                }
                                fclose($myfile);
                          ?>


             （6）、PHP 读取单字符 - fgetc()

                     fgetc() 函数用于从文件中读取单个字符。

                     下例逐字符读取 "webdictionary.txt" 文件，直到 end-of-file：

                     实例
                     <?php
                              $myfile = fopen("webdictionary.txt", "r") or die("Unable to open file!");

                              // 输出单字符直到 end-of-file
                              while(!feof($myfile)) {
                                 echo fgetc($myfile);
                              }
                              fclose($myfile);
                     ?>

                     注释：在调用 fgetc() 函数之后，文件指针会移动到下一个字符。


        ###################################################################################


       二、PHP 文件创建/写入

            在本节中，我们将为您讲解如何在服务器上创建并写入文件。

            1、PHP 创建文件 - fopen()

                 fopen() 函数也用于创建文件。也许有点混乱，但是在 PHP 中，创建文件所用的函数与打开文件的相同。

                 如果您用 fopen() 打开并不存在的文件，此函数会创建文件，假定文件被打开为写入（w）或增加（a）。

                 下面的例子创建名为 "testfile.txt" 的新文件。此文件将被创建于 PHP 代码所在的相同目录中：

                                          $myfile = fopen("testfile.txt", "w")


            2、PHP 文件权限

                如果您试图运行这段代码时发生错误，请检查您是否有向硬盘写入信息的 PHP 文件访问权限。


            3、PHP 写入文件 - fwrite()

                fwrite() 函数用于写入文件。

                fwrite() 的第一个参数包含要写入的文件的文件名，第二个参数是被写的字符串。

                下面的例子把姓名写入名为 "newfile.txt" 的新文件中：

                       <?php
                             $myfile = fopen("newfile.txt", "w") or die("Unable to open file!");
                             $txt = "Bill Gates\n";
                             fwrite($myfile, $txt);
                             $txt = "Steve Jobs\n";
                             fwrite($myfile, $txt);
                             fclose($myfile);
                        ?>

                 请注意，我们向文件 "newfile.txt" 写了两次。在每次我们向文件写入时，在我们发送的字符串 $txt 中，第一次包含 "Bill Gates"，第二次包含 "Steve Jobs"。在写入完成后，我们使用 fclose() 函数来关闭文件。

                 如果我们打开 "newfile.txt" 文件，它应该是这样的：

                                                       Bill Gates
                                                       Steve Jobs



            4、PHP 覆盖（Overwriting）

                如果现在 "newfile.txt" 包含了一些数据，我们可以展示在写入已有文件时发生的的事情。所有已存在的数据会被擦除并以一个新文件开始。

                在下面的例子中，我们打开一个已存在的文件 "newfile.txt"，并向其中写入了一些新数据：

                                <?php
                                        $myfile = fopen("newfile.txt", "w") or die("Unable to open file!");
                                        $txt = "Mickey Mouse\n";
                                        fwrite($myfile, $txt);
                                        $txt = "Minnie Mouse\n";
                                        fwrite($myfile, $txt);
                                        fclose($myfile);
                                ?>
               如果现在我们打开这个 "newfile.txt" 文件，Bill 和 Steve 都已消失，只剩下我们刚写入的数据：

                                                Mickey Mouse
                                                Minnie Mouse










-------------------------------------------------------------------------------------------------------------------------------------------


三十一、PHP 文件上传

          通过 PHP，可以把文件上传到服务器。

          本章节实例在 test 项目下完成，目录结构为：

                    test
                    |-----upload             # 文件上传的目录
                    |-----form.html          # 表单文件
                    |-----upload_file.php    # php 上传代码


        1、创建一个文件上传表单

               允许用户从表单上传文件是非常有用的。

               请看下面这个供上传文件的 HTML 表单：

                        <html>
                        <head>
                        <meta charset="utf-8">
                        <title>菜鸟教程(runoob.com)</title>
                        </head>
                        <body>
                                 <form action="upload_file.php" method="post" enctype="multipart/form-data">
                                     <label for="file">文件名：</label>
                                     <input type="file" name="file" id="file"><br>
                                     <input type="submit" name="submit" value="提交">
                                 </form>
                        </body>
                        </html>

                将以上代码保存到 form.html 文件中。

                有关上面的 HTML 表单的一些注意项列举如下：

                    <form> 标签的 enctype 属性规定了在提交表单时要使用哪种内容类型。在表单需要二进制数据时，比如文件内容，请使用 "multipart/form-data"。

                    <input> 标签的 type="file" 属性规定了应该把输入作为文件来处理。举例来说，当在浏览器中预览时，会看到输入框旁边有一个浏览按钮。

                    注释：允许用户上传文件是一个巨大的安全风险。请仅仅允许可信的用户执行文件上传操作。



        2、创建上传脚本

              "upload_file.php" 文件含有供上传文件的代码：

                  <?php
                        if ($_FILES["file"]["error"] > 0)
                        {
                            echo "错误：" . $_FILES["file"]["error"] . "<br>";
                        }
                        else
                        {
                            echo "上传文件名: " . $_FILES["file"]["name"] . "<br>";
                            echo "文件类型: " . $_FILES["file"]["type"] . "<br>";
                            echo "文件大小: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
                            echo "文件临时存储的位置: " . $_FILES["file"]["tmp_name"];
                        }
                  ?>

              通过使用 PHP 的全局数组 $_FILES，你可以从客户计算机向远程服务器上传文件。

              第一个参数是表单的 input name，第二个下标可以是 "name"、"type"、"size"、"tmp_name" 或 "error"。如下所示：

                                        $_FILES["file"]["name"] - 上传文件的名称

                                        $_FILES["file"]["type"] - 上传文件的类型

                                        $_FILES["file"]["size"] - 上传文件的大小，以字节计

                                        $_FILES["file"]["tmp_name"] - 存储在服务器的文件的临时副本的名称

                                        $_FILES["file"]["error"] - 由文件上传导致的错误代码

              这是一种非常简单文件上传方式。基于安全方面的考虑，您应当增加有关允许哪些用户上传文件的限制。



        3、上传限制

              在这个脚本中，我们增加了对文件上传的限制。
         
                用户只能上传 .gif、.jpeg、.jpg、.png 文件，文件大小必须小于 200 kB：

                        <?php
                                // 允许上传的图片后缀
                                $allowedExts = array("gif", "jpeg", "jpg", "png");
                                $temp = explode(".", $_FILES["file"]["name"]);
                                $extension = end($temp);        // 获取文件后缀名
                                if ((($_FILES["file"]["type"] == "image/gif")
                                || ($_FILES["file"]["type"] == "image/jpeg")
                                || ($_FILES["file"]["type"] == "image/jpg")
                                || ($_FILES["file"]["type"] == "image/pjpeg")
                                || ($_FILES["file"]["type"] == "image/x-png")
                                || ($_FILES["file"]["type"] == "image/png"))
                                && ($_FILES["file"]["size"] < 204800)    // 小于 200 kb
                                && in_array($extension, $allowedExts))
                                {
                                    if ($_FILES["file"]["error"] > 0)
                                    {
                                        echo "错误：: " . $_FILES["file"]["error"] . "<br>";
                                    }
                                    else
                                    {
                                        echo "上传文件名: " . $_FILES["file"]["name"] . "<br>";
                                        echo "文件类型: " . $_FILES["file"]["type"] . "<br>";
                                        echo "文件大小: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
                                        echo "文件临时存储的位置: " . $_FILES["file"]["tmp_name"];
                                    }
                                }
                                else
                                {
                                    echo "非法的文件格式";
                                }
                        ?>

                  
          额外知识：

            （1）PHP explode() 函数

                 把字符串打散为数组：

                          <?php
                                $str = "Hello world. I love Shanghai!";
                                print_r (explode(" ",$str));
                          ?>


                  运行结果： Array ( [0] => Hello [1] => world. [2] => I [3] => love [4] => Shanghai! )


            （2）PHP end() 函数

                  实例
                  输出数组中的当前元素和最后一个元素的值：

                      <?php
                           $people = array("Peter", "Joe", "Glenn", "Cleveland");

                           echo current($people) . "<br>";
                           echo end($people); 
                      ?>

                  运行结果：
                                  Peter
                                  Cleveland


                  定义和用法：

                       end() 函数将内部指针指向数组中的最后一个元素，并输出。

                         相关的方法：
                                 current() - 返回数组中的当前元素的值。

                                 next() - 将内部指针指向数组中的下一个元素，并输出。

                                 prev() - 将内部指针指向数组中的上一个元素，并输出。

                                 reset() - 将内部指针指向数组中的第一个元素，并输出。

                                 each() - 返回当前元素的键名和键值，并将内部指针向前移动。




        4、保存被上传的文件

             上面的实例在服务器的 PHP 临时文件夹中创建了一个被上传文件的临时副本。

             这个临时的副本文件会在脚本结束时消失。要保存被上传的文件，我们需要把它拷贝到另外的位置：

                    <?php
                            // 允许上传的图片后缀
                            $allowedExts = array("gif", "jpeg", "jpg", "png");
                            $temp = explode(".", $_FILES["file"]["name"]);
                            echo $_FILES["file"]["size"];
                            $extension = end($temp);     // 获取文件后缀名
                            if ((($_FILES["file"]["type"] == "image/gif")
                            || ($_FILES["file"]["type"] == "image/jpeg")
                            || ($_FILES["file"]["type"] == "image/jpg")
                            || ($_FILES["file"]["type"] == "image/pjpeg")
                            || ($_FILES["file"]["type"] == "image/x-png")
                            || ($_FILES["file"]["type"] == "image/png"))
                            && ($_FILES["file"]["size"] < 204800)   // 小于 200 kb
                            && in_array($extension, $allowedExts))
                            {
                                if ($_FILES["file"]["error"] > 0)
                                {
                                    echo "错误：: " . $_FILES["file"]["error"] . "<br>";
                                }
                                else
                                {
                                    echo "上传文件名: " . $_FILES["file"]["name"] . "<br>";
                                    echo "文件类型: " . $_FILES["file"]["type"] . "<br>";
                                    echo "文件大小: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
                                    echo "文件临时存储的位置: " . $_FILES["file"]["tmp_name"] . "<br>";
                                    
                                    // 判断当期目录下的 upload 目录是否存在该文件
                                    // 如果没有 upload 目录，你需要创建它，upload 目录权限为 777
                                    if (file_exists("upload/" . $_FILES["file"]["name"]))
                                    {
                                        echo $_FILES["file"]["name"] . " 文件已经存在。 ";
                                    }
                                    else
                                    {
                                        // 如果 upload 目录不存在该文件则将文件上传到 upload 目录下
                                        move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $_FILES["file"]["name"]);
                                        echo "文件存储在: " . "upload/" . $_FILES["file"]["name"];
                                    }
                                }
                            }
                            else
                            {
                                echo "非法的文件格式";
                            }
                    ?>


          额外知识：

             （1）PHP move_uploaded_file() 函数
               
                      PHP Filesystem 函数

                      定义和用法：
                                 move_uploaded_file() 函数将上传的文件移动到新位置。
   
                                 若成功，则返回 true，否则返回 false。

                      语法：   move_uploaded_file(file,newloc)


                       参数	             描述

                       file	             必需。规定要移动的文件。

                       newloc	             必需。规定文件的新位置。

                       说明：
                            本函数检查并确保由 file 指定的文件是合法的上传文件（即通过 PHP 的 HTTP POST 上传机制所上传的）。如果文件合法，则将其移动为由 newloc 指定的文件。

                            如果 file 不是合法的上传文件，不会出现任何操作，move_uploaded_file() 将返回 false。

                            如果 file 是合法的上传文件，但出于某些原因无法移动，不会出现任何操作，move_uploaded_file() 将返回 false，此外还会发出一条警告。

                            这种检查显得格外重要，如果上传的文件有可能会造成对用户或本系统的其他用户显示其内容的话。

                      提示和注释：

                                 注释：本函数仅用于通过 HTTP POST 上传的文件。

                                 注意：如果目标文件已经存在，将会被覆盖。



             （2）PHP file_exists() 函数

                   定义和用法：
                               file_exists() 函数检查文件或目录是否存在。

                               如果指定的文件或目录存在则返回 true，否则返回 false。

                     语法：    file_exists(path)

                     参数	    描述

                     path	    必需。规定要检查的路径。



             （3）$_FILES name和tmp_name有什么区别

                    $_FILES[字段名][name]保存的文件在上传者机器上的文件名，$_FILES[字段名][tmp_name]保存的是文件上传到服务器临时文件夹之后的文件名
                    一般我们应该从$_FILES[字段名][name]获取文件名、扩展名等信息，和程序规定的文件夹一起组装成为目标文件名，然后把临时文件$_FILES[字段名][tmp_name]移动过去。

                           例子：
                                  else
                                    {
                                        // 如果 upload 目录不存在该文件则将文件上传到 upload 目录下
                                        move_uploaded_file($_FILES["file"]["tmp_name"], "upload/" . $_FILES["file"]["name"]);
                                        echo "文件存储在: " . "upload/" . $_FILES["file"]["name"];
                                    }


-------------------------------------------------------------------------------------------------------------------------------------------


三十二、PHP Cookie

         cookie 常用于识别用户。

        （1）Cookie 是什么？

                 cookie 常用于识别用户。cookie 是一种服务器留在用户计算机上的小文件。每当同一台计算机通过浏览器请求页面时，这台计算机将会发送 cookie。通过 PHP，您能够创建并取回 cookie 的值。


        （2）如何创建 Cookie？

                 setcookie() 函数用于设置 cookie。

                 注释：setcookie() 函数必须位于 <html> 标签之前。

                 语法：setcookie(name, value, expire, path, domain);

                 ①实例 1
                      在下面的例子中，我们将创建名为 "user" 的 cookie，并为它赋值 "runoob"。我们也规定了此 cookie 在一小时后过期：

                               <?php
                                     setcookie("user", "runoob", time()+3600);
                               ?>

                               <html>
                               .....

                 注释：在发送 cookie 时，cookie 的值会自动进行 URL 编码，在取回时进行自动解码。（为防止 URL 编码，请使用 setrawcookie() 取而代之。）

                 ②实例 2

                      您还可以通过另一种方式设置 cookie 的过期时间。这也许比使用秒表示的方式简单。

                               <?php
                                      $expire=time()+60*60*24*30;
                                      setcookie("user", "runoob", $expire);
                               ?>
                               <html>
                               .....

                      在上面的实例中，过期时间被设置为一个月（60 秒 * 60 分 * 24 小时 * 30 天）。



        （3）如何取回 Cookie 的值？

               PHP 的 $_COOKIE 变量用于取回 cookie 的值。

               在下面的实例中，我们取回了名为 "user" 的 cookie 的值，并把它显示在了页面上：

                    <?php

                        // 输出 cookie 值
                        echo $_COOKIE["user"];

                        // 查看所有 cookie
                        print_r($_COOKIE);
                    ?>


               在下面的实例中，我们使用 isset() 函数来确认是否已设置了 cookie：

                        <html>
                        <head>
                        <meta charset="utf-8">
                        <title>菜鸟教程(runoob.com)</title>
                        </head>
                        <body>
                                <?php
                                      if (isset($_COOKIE["user"]))

                                        echo "欢迎 " . $_COOKIE["user"] . "!<br>";

                                      else

                                        echo "普通访客!<br>";
                                ?>
                        </body>
                        </html>


        （4）如何删除 Cookie？

               当删除 cookie 时，您应当使过期日期变更为过去的时间点。

               删除的实例：
                           <?php

                                 // 设置 cookie 过期时间为过去 1 小时

                                    setcookie("user", "", time()-3600);
                           ?>


        （5）如果浏览器不支持 Cookie 该怎么办？

               如果您的应用程序需要与不支持 cookie 的浏览器打交道，那么您不得不使用其他的办法在您的应用程序中的页面之间传递信息。

               ①、一种方式是通过表单传递数据（有关表单和用户输入的内容，在本教程的前面章节中我们已经介绍过了）。

                     下面的表单在用户单点击 "Submit" 按钮时，向 "welcome.php" 提交了用户输入：

                            <html>
                            <head>
                            <meta charset="utf-8">
                            <title>菜鸟教程(runoob.com)</title>
                            </head>
                            <body>
                                    <form action="welcome.php" method="post">

                                                 名字: <input type="text" name="name">
                                                 年龄: <input type="text" name="age">
                                                 <input type="submit">
                                    </form>
                            </body>
                            </html>

                     取回 "welcome.php" 文件中的值，如下所示：

                            <html>
                            <head>
                              <meta charset="utf-8">
                              <title>菜鸟教程(runoob.com)</title>
                            </head>
                              <body>
                                    欢迎 <?php echo $_POST["name"]; ?>.<br>
                                    你 <?php echo $_POST["age"]; ?> 岁了。
                              </body>
                            </html>


-------------------------------------------------------------------------------------------------------------------------------------------


三十三、PHP Session

     PHP session 变量用于存储关于用户会话（session）的信息，或者更改用户会话（session）的设置。

     Session 变量存储单一用户的信息，并且对于应用程序中的所有页面都是可用的。


     1、PHP Session 变量

          您在计算机上操作某个应用程序时，您打开它，做些更改，然后关闭它。这很像一次对话（Session）。计算机知道您是谁。它清楚您在何时打开和关闭应用程序。然而，在因特网上问题出现了：由于 HTTP 地址无法保持状态，Web 服务器并不知道您是谁以及您做了什么。

          PHP session 解决了这个问题，它通过在服务器上存储用户信息以便随后使用（比如用户名称、购买商品等）。然而，会话信息是临时的，在用户离开网站后将被删除。如果您需要永久存储信息，可以把数据存储在数据库中。

          Session 的工作机制是：为每个访客创建一个唯一的 id (UID)，并基于这个 UID 来存储变量。UID 存储在 cookie 中，或者通过 URL 进行传导。


     2、开始 PHP Session

          在您把用户信息存储到 PHP session 中之前，首先必须启动会话。

          注释：session_start() 函数必须位于 <html> 标签之前：

                       <?php session_start(); ?>

                       <html>
                       <body>
                             ...
                       </body>
                       </html


           上面的代码会向服务器注册用户的会话，以便您可以开始保存用户信息，同时会为用户会话分配一个 UID。


     3、存储 Session 变量

           存储和取回 session 变量的正确方法是使用 PHP $_SESSION 变量：

                        <?php
                                session_start();
                                // 存储 session 数据
                                $_SESSION['views']=1;
                        ?>
                        <html>
                        <head>
                        <meta charset="utf-8">
                        <title>菜鸟教程(runoob.com)</title>
                        </head>
                        <body>
                             <?php
                                    // 检索 session 数据
                                    echo "浏览量：". $_SESSION['views'];
                             ?>
                        </body>
                        </html>

                         输出：    浏览量：1


           在下面的实例中，我们创建了一个简单的 page-view 计数器。isset() 函数检测是否已设置 "views" 变量。如果已设置 "views" 变量，我们累加计数器。如果 "views" 不存在，则创建 "views" 变量，并把它设置为 1：

                            <?php
                                    session_start();

                                    if(isset($_SESSION['views']))
                                    {
                                        $_SESSION['views']=$_SESSION['views']+1;
                                    }
                                    else
                                    {
                                        $_SESSION['views']=1;
                                    }
                                    echo "浏览量：". $_SESSION['views'];
                            ?>



     4、销毁 Session

          如果您希望删除某些 session 数据，可以使用 unset() 或 session_destroy() 函数。

            ①、unset() 函数用于释放指定的 session 变量：

                        <?php
                                session_start();
                                if(isset($_SESSION['views']))
                                {
                                    unset($_SESSION['views']);
                                }
                        ?>


            ②、您也可以通过调用 session_destroy() 函数彻底销毁 session：

                            <?php
                                  session_destroy();
                            ?

           注释：session_destroy() 将重置 session，您将失去所有已存储的 session 数据。


-------------------------------------------------------------------------------------------------------------------------------------------


三十四、PHP 发送电子邮件

       PHP 允许您从脚本直接发送电子邮件。

       1、PHP mail() 函数

            PHP mail() 函数用于从脚本中发送电子邮件。

            语法：mail(to,subject,message,headers,parameters)

                     参数	                  描述

                     to	                          必需。规定 email 接收者。

                     subject	                  必需。规定 email 的主题。注释：该参数不能包含任何新行字符。

                     message	                  必需。定义要发送的消息。应使用 LF (\n) 来分隔各行。每行应该限制在 70 个字符内。

                     headers	                  可选。规定附加的标题，比如 From、Cc 和 Bcc。应当使用 CRLF (\r\n) 分隔附加的标题。

                     parameters	                  可选。对邮件发送程序规定额外的参数。


            注释：PHP 运行邮件函数需要一个已安装且正在运行的邮件系统(如：sendmail、postfix、qmail等)。所用的程序通过在 php.ini 文件中的配置设置进行定义。请在我们的 PHP Mail 参考手册 阅读更多内容。：  http://www.runoob.com/php/php-ref-mail.html



       2、PHP 简易 E-Mail

             通过 PHP 发送电子邮件的最简单的方式是发送一封文本 email。

             在下面的实例中，我们首先声明变量($to, $subject, $message, $from, $headers)，然后我们在 mail() 函数中使用这些变量来发送了一封 E-mail：

                        <?php
                                $to = "someone@example.com";          // 邮件接收者

                                $subject = "参数邮件";                // 邮件标题

                                $message = "Hello! 这是邮件的内容。"; // 邮件正文

                                $from = "someonelse@example.com";     // 邮件发送者

                                $headers = "From:" . $from;           // 头部信息设置

                                mail($to,$subject,$message,$headers);

                                echo "邮件已发送";
                        ?>


       3、PHP Mail 表单

             通过 PHP，您能够在自己的站点制作一个反馈表单。下面的实例向指定的 e-mail 地址发送了一条文本消息：

                            <html>
                            <head>
                            <meta charset="utf-8">
                            <title>菜鸟教程(runoob.com)</title>
                            </head>
                            <body>
                                    <?php
                                        if (isset($_REQUEST['email'])) { // 如果接收到邮箱参数则发送邮件

                                            // 发送邮件
                                            $email = $_REQUEST['email'] ;
                                            $subject = $_REQUEST['subject'] ;
                                            $message = $_REQUEST['message'] ;
                                            mail("someone@example.com", $subject,
                                            $message, "From:" . $email);

                                            echo "邮件发送成功";

                                        } else { // 如果没有邮箱参数则显示表单

                                            echo "<form method='post' action='mailform.php'>

                                            Email: <input name='email' type='text'><br>

                                            Subject: <input name='subject' type='text'><br>

                                            Message:<br>
                                            <textarea name='message' rows='15' cols='40'>
                                            </textarea><br>

                                            <input type='submit'>
                                            </form>";
                                        }
                                    ?>
                            </body>
                            </html>

                 实例解释：
                           首先，检查是否填写了邮件输入框

                           如果未填写（比如在页面被首次访问时），输出 HTML 表单

                           如果已填写（在表单被填写后），从表单发送电子邮件

                           当填写完表单点击提交按钮后，页面重新载入，可以看到邮件输入被重置，同时显示邮件发送成功的消息

                 注释：这个简易发送 e-mail 不安全，在本教程的下一章中，您将阅读到更多关于电子邮件脚本中的安全隐患，我们将为您讲解如何验证用户输入使它更安全。




-------------------------------------------------------------------------------------------------------------------------------------------


三十五、PHP Secure E-mails

      在上一节中的 PHP e-mail 脚本中，存在着一个漏洞。

      1、PHP E-mail 注入
    
         首先，请看上一章中的 PHP 代码：

                            <html>
                            <head>
                            <meta charset="utf-8">
                            <title>菜鸟教程(runoob.com)</title>
                            </head>
                            <body>
                                    <?php
                                        if (isset($_REQUEST['email'])) { // 如果接收到邮箱参数则发送邮件

                                            // 发送邮件
                                            $email = $_REQUEST['email'] ;
                                            $subject = $_REQUEST['subject'] ;
                                            $message = $_REQUEST['message'] ;
                                            mail("someone@example.com", $subject,
                                            $message, "From:" . $email);

                                            echo "邮件发送成功";

                                        } else { // 如果没有邮箱参数则显示表单

                                            echo "<form method='post' action='mailform.php'>

                                            Email: <input name='email' type='text'><br>

                                            Subject: <input name='subject' type='text'><br>

                                            Message:<br>
                                            <textarea name='message' rows='15' cols='40'>
                                            </textarea><br>

                                            <input type='submit'>
                                            </form>";
                                        }
                                    ?>
                            </body>
                            </html>


                      以上代码存在的问题是，未经授权的用户可通过输入表单在邮件头部插入数据。

                      假如用户在表单中的输入框内加入如下文本到电子邮件中，会出现什么情况呢？

                                   someone@example.com%0ACc:person2@example.com

                                   %0ABcc:person3@example.com,person3@example.com,

                                   anotherperson4@example.com,person5@example.com

                                   %0ABTo:person6@example.com

                      与往常一样，mail() 函数把上面的文本放入邮件头部，那么现在头部有了额外的 Cc:、Bcc: 和 To: 字段。当用户点击提交按钮时，这封 e-mail 会被发送到上面所有的地址！



      2、PHP 防止 E-mail 注入

          防止 e-mail 注入的最好方法是对输入进行验证。

          下面的代码与上一章中的类似，不过这里我们已经增加了检测表单中 email 字段的输入验证程序：

                        <html>
                        <head>
                        <meta charset="utf-8">
                        <title>菜鸟教程(runoob.com)</title>
                        </head>
                        <body>
                                <?php
                                        function spamcheck($field)
                                        {
                                            // filter_var() 过滤 e-mail
                                            // 使用 FILTER_SANITIZE_EMAIL
                                            $field=filter_var($field, FILTER_SANITIZE_EMAIL);

                                            //filter_var() 过滤 e-mail
                                            // 使用 FILTER_VALIDATE_EMAIL
                                            if(filter_var($field, FILTER_VALIDATE_EMAIL))
                                            {
                                                return TRUE;
                                            }
                                            else
                                            {
                                                return FALSE;
                                            }
                                        }

                                        if (isset($_REQUEST['email']))
                                        {
                                            // 如果接收到邮箱参数则发送邮件

                                            // 判断邮箱是否合法
                                            $mailcheck = spamcheck($_REQUEST['email']);
                                            if ($mailcheck==FALSE)
                                            {
                                                echo "非法输入";
                                            }
                                            else
                                            {    
                                                // 发送邮件
                                                $email = $_REQUEST['email'] ;
                                                $subject = $_REQUEST['subject'] ;
                                                $message = $_REQUEST['message'] ;
                                                mail("someone@example.com", "Subject: $subject",
                                                $message, "From: $email" );
                                                echo "Thank you for using our mail form";
                                            }
                                        }
                                        else
                                        { 
                                            // 如果没有邮箱参数则显示表单
                                            echo "<form method='post' action='mailform.php'>
                                            Email: <input name='email' type='text'><br>
                                            Subject: <input name='subject' type='text'><br>
                                            Message:<br>
                                            <textarea name='message' rows='15' cols='40'>
                                            </textarea><br>
                                            <input type='submit'>
                                            </form>";
                                        }
                                ?>

                        </body>
                        </html>

             在上面的代码中，我们使用了 PHP 过滤器来对输入进行验证：

                        FILTER_SANITIZE_EMAIL 过滤器从字符串中删除电子邮件的非法字符

                        FILTER_VALIDATE_EMAIL 过滤器验证电子邮件地址的值

          额外知识：

           （1）、PHP filter_var() 函数  ：获取一个变量，并进行过滤。

                   PHP Filter 函数： 所有的Filter函数  ---  http://www.w3school.com.cn/php/php_ref_filter.asp

                   定义和用法：

                         filter_var() 函数通过指定的过滤器过滤变量。

                         如果成功，则返回已过滤的数据，如果失败，则返回 false。

                   语法：  filter_var(variable, filter, options)

                           参数             	描述

                           variable	        必需。规定要过滤的变量。

                           filter	        可选。规定要使用的过滤器的 ID。

                           options	        规定包含标志/选项的数组。检查每个过滤器可能的标志和选项。


           （2）PHP FILTER_SANITIZE_EMAIL 过滤器   ------ 作为filter_var() 函数等Filter函数的一个参数，过滤字符串中所有非法的 e-mail 字符

                  定义和用法：

                           FILTER_SANITIZE_EMAIL 过滤器删除字符串中所有非法的 e-mail 字符。

                           该过滤器允许所有的字符、数字以及 $-_.+!*'{}|^~[]`#%/?@&=。

                                              Name: "email"
                                              ID-number: 517

                      例子：
                               <?php

                                   $var="some(one)@exa\\mple.com";

                                   var_dump(filter_var($var, FILTER_SANITIZE_EMAIL));
                               ?>

                               输出：string(19) "someone@example.com"



-------------------------------------------------------------------------------------------------------------------------------------------


三十六、PHP 错误处理

      在 PHP 中，默认的错误处理很简单。一条错误消息会被发送到浏览器，这条消息带有文件名、行号以及描述错误的消息。

      1、PHP 错误处理

          在创建脚本和 Web 应用程序时，错误处理是一个重要的部分。如果您的代码缺少错误检测编码，那么程序看上去很不专业，也为安全风险敞开了大门。

          本教程介绍了 PHP 中一些最为重要的错误检测方法。

          我们将为您讲解不同的错误处理方法：

                                   简单的 "die()" 语句

                                   自定义错误和错误触发器

                                   错误报告


      2、基本的错误处理：使用 die() 函数

                第一个实例展示了一个打开文本文件的简单脚本：

                                         <?php
                                                $file=fopen("welcome.txt","r");
                                         ?>

                如果文件不存在，您会得到类似这样的错误：

                        Warning: fopen(welcome.txt) [function.fopen]: failed to open stream:

                                    No such file or directory in /www/runoob/test/test.php on line 2


                为了避免用户得到类似上面的错误消息，我们在访问文件之前检测该文件是否存在：


                           <?php
                                   if(!file_exists("welcome.txt"))
                                   {
                                       die("文件不存在");
                                   }
                                   else
                                   {
                                       $file=fopen("welcome.txt","r");
                                   }
                           ?>

                 现在，如果文件不存在，您会得到类似这样的错误消息：

                                                       文件不存在


                 相比之前的代码，上面的代码更有效，这是由于它采用了一个简单的错误处理机制在错误之后终止了脚本。

                 然而，简单地终止脚本并不总是恰当的方式。让我们研究一下用于处理错误的备选的 PHP 函数。


      3、创建自定义错误处理器

           创建一个自定义的错误处理器非常简单。我们很简单地创建了一个专用函数，可以在 PHP 中发生错误时调用该函数。

           该函数必须有能力处理至少两个参数 (error level 和 error message)，但是可以接受最多五个参数（可选的：file, line-number 和 error context）：

           语法：
                 error_function(error_level,error_message,

                 error_file,error_line,error_context)


           参数                  	描述

           error_level	                必需。为用户定义的错误规定错误报告级别。必须是一个数字。参见下面的表格：错误报告级别。

           error_message	        必需。为用户定义的错误规定错误消息。

           error_file	                可选。规定错误发生的文件名。

           error_line	                可选。规定错误发生的行号。

           error_context	        可选。规定一个数组，包含了当错误发生时在用的每个变量以及它们的值。


      4、错误报告级别

           这些错误报告级别是用户自定义的错误处理程序处理的不同类型的错误：

             值	                  常量	                     描述

             2	                  E_WARNING	             非致命的 run-time 错误。不暂停脚本执行。

             8	                  E_NOTICE	             run-time 通知。在脚本发现可能有错误时发生，但也可能在脚本正常运行时发生。

             256	          E_USER_ERROR	             致命的用户生成的错误。这类似于程序员使用 PHP 函数 trigger_error() 设置的 E_ERROR。

             512	          E_USER_WARNING	     非致命的用户生成的警告。这类似于程序员使用 PHP 函数 trigger_error() 设置的 E_WARNING。

             1024	          E_USER_NOTICE		     用户生成的通知。这类似于程序员使用 PHP 函数 trigger_error() 设置的 E_NOTICE。

             4096	          E_RECOVERABLE_ERROR	     可捕获的致命错误。类似 E_ERROR，但可被用户定义的处理程序捕获。（参见 set_error_handler()）

             8191	          E_ALL	                     所有错误和警告。（在 PHP 5.4 中，E_STRICT 成为 E_ALL 的一部分）


            现在，让我们创建一个处理错误的函数：

              function customError($errno, $errstr)
              {
                  echo "<b>Error:</b> [$errno] $errstr<br>";
                  echo "脚本结束";
                  die();
              }

           上面的代码是一个简单的错误处理函数。当它被触发时，它会取得错误级别和错误消息。然后它会输出错误级别和消息，并终止脚本。

           现在，我们已经创建了一个错误处理函数，我们需要确定在何时触发该函数。



      5、设置错误处理程序

           PHP 的默认错误处理程序是内建的错误处理程序。我们打算把上面的函数改造为脚本运行期间的默认错误处理程序。

           可以修改错误处理程序，使其仅应用到某些错误，这样脚本就能以不同的方式来处理不同的错误。

           然而，在本例中，我们打算针对所有错误来使用我们自定义的错误处理程序：

                                                set_error_handler("customError");

           由于我们希望我们的自定义函数能处理所有错误，set_error_handler() 仅需要一个参数，可以添加第二个参数来规定错误级别。


           实例：
      
                通过尝试输出不存在的变量，来测试这个错误处理程序：

                     <?php
                              // 错误处理函数
                              function customError($errno, $errstr)
                              {                              
                                  echo "<b>Error:</b> [$errno] $errstr";
                              }

                              // 设置错误处理函数
                              set_error_handler("customError");

                              // 触发错误
                              echo($test);
                     ?>

               以上代码的输出如下所示：   Error: [8] Undefined variable: test


      6、触发错误

           在脚本中用户输入数据的位置，当用户的输入无效时触发错误是很有用的。在 PHP 中，这个任务由 trigger_error() 函数完成。

           实例：
           在本例中，如果 "test" 变量大于 "1"，就会发生错误：

                      <?php
                                     $test=2;
                                     if ($test>1)
                                     {
                                         trigger_error("变量值必须小于等于 1");
                                     }
                      ?>

            以上代码的输出如下所示：
                                    Notice: 变量值必须小于等于 1

                                    in /www/test/runoob.php on line 5


            您可以在脚本中任何位置触发错误，通过添加的第二个参数，您能够规定所触发的错误级别。

                   可能的错误类型：

                                E_USER_ERROR - 致命的用户生成的 run-time 错误。错误无法恢复。脚本执行被中断。

                                E_USER_WARNING - 非致命的用户生成的 run-time 警告。脚本执行不被中断。

                                E_USER_NOTICE - 默认。用户生成的 run-time 通知。在脚本发现可能有错误时发生，但也可能在脚本正常运行时发生。


            实例：

              在本例中，如果 "test" 变量大于 "1"，则发生 E_USER_WARNING 错误。如果发生了 E_USER_WARNING，我们将使用我们自定义的错误处理程序并结束脚本：

                            <?php
                                        // 错误处理函数
                                        function customError($errno, $errstr)
                                        {
                                            echo "<b>Error:</b> [$errno] $errstr<br>";
                                            echo "脚本结束";
                                            die();
                                        }

                                        // 设置错误处理函数
                                        set_error_handler("customError",E_USER_WARNING);

                                        // 触发错误
                                        $test=2;
                                        if ($test>1)
                                        {
                                            trigger_error("变量值必须小于等于 1",E_USER_WARNING);
                                        }
                            ?>

                          以上代码的输出如下所示：

                                       Error: [512] 变量值必须小于等于 1

                                       脚本结束

                 现在，我们已经学习了如何创建自己的 error，以及如何触发它们，接下来我们研究一下错误记录。


      7、错误记录

           在默认的情况下，根据在 php.ini 中的 error_log 配置，PHP 向服务器的记录系统或文件发送错误记录。

           通过使用 error_log() 函数，您可以向指定的文件或远程目的地发送错误记录。

           通过电子邮件向您自己发送错误消息，是一种获得指定错误的通知的好办法。


      8、通过 E-Mail 发送错误消息

           在下面的例子中，如果特定的错误发生，我们将发送带有错误消息的电子邮件，并结束脚本：

                            <?php
                                    // 错误处理函数
                                    function customError($errno, $errstr)
                                    {
                                        echo "<b>Error:</b> [$errno] $errstr<br>";
                                        echo "已通知网站管理员";
                                        error_log("Error: [$errno] $errstr",1,
                                        "someone@example.com","From: webmaster@example.com");
                                     }

                                    // 设置错误处理函数
                                    set_error_handler("customError",E_USER_WARNING);

                                    // 触发错误
                                    $test=2;
                                    if ($test>1)
                                    {
                                        trigger_error("变量值必须小于等于 1",E_USER_WARNING);
                                    }
                            ?>

                以上代码的输出如下所示：

                         Error: [512] 变量值必须小于等于 1

                         已通知网站管理员


                接收自以上代码的邮件如下所示：

                         Error: [512] 变量值必须小于等于 1


                这个方法不适合所有的错误。常规错误应当通过使用默认的 PHP 记录系统在服务器上进行记录。


-------------------------------------------------------------------------------------------------------------------------------------------


三十七、PHP 异常处理

        异常用于在指定的错误发生时改变脚本的正常流程。

        1、异常是什么

             PHP 5 提供了一种新的面向对象的错误处理方法。

             异常处理用于在指定的错误（异常）情况发生时改变脚本的正常流程。这种情况称为异常。


             当异常被触发时，通常会发生：

                               当前代码状态被保存

                               代码执行被切换到预定义（自定义）的异常处理器函数

                               根据情况，处理器也许会从保存的代码状态重新开始执行代码，终止脚本执行，或从代码中另外的位置继续执行脚本


             我们将展示不同的错误处理方法：

                               异常的基本使用

                               创建自定义的异常处理器

                               多个异常

                               重新抛出异常

                               设置顶层异常处理器

             注释：异常应该仅仅在错误情况下使用，而不应该用于在一个指定的点跳转到代码的另一个位置。



        2、异常的基本使用

             当异常被抛出时，其后的代码不会继续执行，PHP 会尝试查找匹配的 "catch" 代码块。

             如果异常没有被捕获，而且又没用使用 set_exception_handler() 作相应的处理的话，那么将发生一个严重的错误（致命错误），并且输出 "Uncaught Exception" （未捕获异常）的错误消息。

             让我们尝试抛出一个异常，同时不去捕获它：

                            <?php
                                    // 创建一个有异常处理的函数
                                    function checkNum($number)
                                    {
                                        if($number>1)
                                        {
                                            throw new Exception("Value must be 1 or below");
                                        }
                                        return true;
                                    }
                                     
                                    // 触发异常
                                    checkNum(2);
                            ?>


             上面的代码会得到类似这样的一个错误：

                 Fatal error: Uncaught exception 'Exception' with message 'Value must be 1 or below' in /www/runoob/test/test.php:7 Stack trace: #0 /www/runoob/test/test.php(13): checkNum(2) #1 {main} thrown in /www/runoob/test/test.php on line 7




        3、Try、throw 和 catch

            要避免上面实例中出现的错误，我们需要创建适当的代码来处理异常。

            适当的处理异常代码应该包括：

              ①、Try - 使用异常的函数应该位于 "try" 代码块内。如果没有触发异常，则代码将照常继续执行。但是如果异常被触发，会抛出一个异常。

              ②、Throw - 里规定如何触发异常。每一个 "throw" 必须对应至少一个 "catch"。

              ③、Catch - "catch" 代码块会捕获异常，并创建一个包含异常信息的对象。

            让我们触发一个异常：

                            <?php
                                    // 创建一个有异常处理的函数
                                    function checkNum($number)
                                    {
                                        if($number>1)
                                        {
                                            throw new Exception("变量值必须小于等于 1");
                                         }
                                            return true;
                                    }
                                        
                                    // 在 try 块 触发异常
                                    try
                                    {
                                        checkNum(2);
                                        // 如果抛出异常，以下文本不会输出
                                        echo '如果输出该内容，说明 $number 变量';
                                    }
                                    // 捕获异常
                                    catch(Exception $e)
                                    {
                                        echo 'Message: ' .$e->getMessage();
                                    }
                            ?>


                上面代码将得到类似这样一个错误： Message: 变量值必须小于等于 1


            实例解释：
                       上面的代码抛出了一个异常，并捕获了它：

                              创建 checkNum() 函数。它检测数字是否大于 1。如果是，则抛出一个异常。

                              在 "try" 代码块中调用 checkNum() 函数。

                              checkNum() 函数中的异常被抛出。

                              "catch" 代码块接收到该异常，并创建一个包含异常信息的对象 ($e)。

                              通过从这个 exception 对象调用 $e->getMessage()，输出来自该异常的错误消息。

                              然而，为了遵循 "每个 throw 必须对应一个 catch" 的原则，可以设置一个顶层的异常处理器来处理漏掉的错误。



        4、创建一个自定义的 Exception 类

             创建自定义的异常处理程序非常简单。我们简单地创建了一个专门的类，当 PHP 中发生异常时，可调用其函数。该类必须是 exception 类的一个扩展。

             这个自定义的 customException 类继承了 PHP 的 exception 类的所有属性，您可向其添加自定义的函数。

             我们开始创建 customException 类：

                            <?php
                                    class customException extends Exception
                                    {
                                        public function errorMessage()
                                        {
                                            // 错误信息
                                            $errorMsg = '错误行号 '.$this->getLine().' in '.$this->getFile()
                                            .': <b>'.$this->getMessage().'</b> 不是一个合法的 E-Mail 地址';
                                            return $errorMsg;
                                        }
                                    }
                                     
                                    $email = "someone@example...com";
                                     
                                    try
                                    {
                                        // 检测邮箱
                                        if(filter_var($email, FILTER_VALIDATE_EMAIL) === FALSE)
                                        {
                                            // 如果是个不合法的邮箱地址，抛出异常
                                            throw new customException($email);
                                        }
                                    }
                                     
                                    catch (customException $e)
                                    {
                                    //display custom message
                                    echo $e->errorMessage();
                                    }
                            ?>

                   这个新的类是旧的 exception 类的副本，外加 errorMessage() 函数。正因为它是旧类的副本，因此它从旧类继承了属性和方法，我们可以使用 exception 类的方法，比如 getLine()、getFile() 和 getMessage()。



        5、实例解释：

             上面的代码抛出了一个异常，并通过一个自定义的 exception 类来捕获它：

                  ①、customException() 类是作为旧的 exception 类的一个扩展来创建的。这样它就继承了旧的 exception 类的所有属性和方法。

                  ②、创建 errorMessage() 函数。如果 e-mail 地址不合法，则该函数返回一条错误消息。

                  ③、把 $email 变量设置为不合法的 e-mail 地址字符串。

                  ④、执行 "try" 代码块，由于 e-mail 地址不合法，因此抛出一个异常。

                  ⑤、"catch" 代码块捕获异常，并显示错误消息。


              额外知识：

                 （1）FILTER_SANITIZE_EMAIL 和  FILTER_VALIDATE_EMAIL  的区别？

                       SANITIZE ：--》 sanitize   净化; 进行消毒; 使清洁; 审查

                       VALIDATE ：--》 validate   证实; 使合法化，使有法律效力; 使生效; 批准，确认


                      ①、 FILTER_SANITIZE_EMAIL过滤器： 
                                                       删除字符串中所有非法的 e-mail 字符。

                                                       该过滤器允许所有的字符、数字以及 $-_.+!*'{}|^~[]`#%/?@&=。

                                    filter_var($email, FILTER_SANITIZE_EMAIL )：将 $email 中所有的非法 e-mail字符删除



                       ②、PHP FILTER_VALIDATE_EMAIL过滤器：
                                                        把值作为电子邮件地址来验证。
                           
                              filter_var($email, FILTER_VALIDATE_EMAIL )：验证 $email 是否为合法的邮箱，若合法，这返回true, 反之返回false。
                         

        6、多个异常

             可以为一段脚本使用多个异常，来检测多种情况。

             可以使用多个 if..else 代码块，或一个 switch 代码块，或者嵌套多个异常。

             这些异常能够使用不同的 exception 类，并返回不同的错误消息：

                                <?php
                                        class customException extends Exception
                                        {
                                        public function errorMessage()
                                        {
                                        //error message
                                        $errorMsg = 'Error on line '.$this->getLine().' in '.$this->getFile()
                                        .': <b>'.$this->getMessage().'</b> is not a valid E-Mail address';
                                        return $errorMsg;
                                        }
                                        }

                                        $email = "someone@example.com";

                                        try
                                         {
                                          //check if 
                                         if(filter_var($email, FILTER_VALIDATE_EMAIL) === FALSE)
                                          {
                                          //throw exception if email is not valid
                                          throw new customException($email);
                                          }
                                          //check for "example" in mail address
                                         if(strpos($email, "example") !== FALSE)
                                          {
                                          throw new Exception("$email is an example e-mail");
                                          }
                                         }

                                        catch (customException $e)
                                         {
                                         echo $e->errorMessage();
                                         }

                                        catch(Exception $e)
                                         {
                                         echo $e->getMessage();
                                         }
                                ?>

                         运行结果：someone@example.com is an example e-mail

                         例子解释：

                           上面的代码测试了两种条件，如何任何条件不成立，则抛出一个异常：

                                  ①、customException() 类是作为旧的 exception 类的一个扩展来创建的。这样它就继承了旧类的所有属性和方法。

                                  ②、创建 errorMessage() 函数。如果 e-mail 地址不合法，则该函数返回一个错误消息。

                                  ③、执行 "try" 代码块，在第一个条件下，不会抛出异常。

                                  ④、由于 e-mail 含有字符串 "example"，第二个条件会触发异常。

                                  ⑤、"catch" 代码块会捕获异常，并显示恰当的错误消息。

                        如果没有捕获 customException，仅仅捕获了 base exception，则在那里处理异常。


        7、重新抛出异常

             有时，当异常被抛出时，您也许希望以不同于标准的方式对它进行处理。可以在一个 "catch" 代码块中再次抛出异常。

             脚本应该对用户隐藏系统错误。对程序员来说，系统错误也许很重要，但是用户对它们并不感兴趣。

             为了让用户更容易使用，您可以再次抛出带有对用户比较友好的消息的异常：

                                <?php
                                        class customException extends Exception
                                         {
                                         public function errorMessage()
                                          {
                                          //error message
                                          $errorMsg = $this->getMessage().' is not a valid E-Mail address.';
                                          return $errorMsg;
                                          }
                                         }

                                        $email = "someone@example.com";

                                        try
                                         {
                                         try
                                          {
                                          //check for "example" in mail address
                                          if(strpos($email, "example") !== FALSE)
                                           {
                                           //throw exception if email is not valid
                                           throw new Exception($email);
                                           }
                                          }
                                         catch(Exception $e)
                                          {
                                          //re-throw exception
                                          throw new customException($email);
                                          }
                                         }

                                        catch (customException $e)
                                         {
                                         //display custom message
                                         echo $e->errorMessage();
                                         }
                                ?>

               额外知识：

                       ①、PHP strpos() 函数

                           定义和用法：
                                      strpos() 函数查找字符串在另一字符串中第一次出现的位置。

                                      注释：strpos() 函数对大小写敏感。

                                      注释：该函数是二进制安全的。

                           语法：     strpos(string,find,start)

                            参数	         描述

                            string	         必需。规定要搜索的字符串。

                            find	         必需。规定要查找的字符串。

                            start	         可选。规定在何处开始搜索。


                           技术细节： 返回字符串在另一字符串中第一次出现的位置，如果没有找到字符串则返回 FALSE。

                               注释： 字符串位置从 0 开始，不是从 1 开始。


                           实例 ---》查找 "php" 在字符串中第一次出现的位置：

                                         <?php
                                               echo strpos("You love php, I love php too!","php");
                                         ?>

                          相关函数：
                                    stripos() - 查找字符串在另一字符串中第一次出现的位置（不区分大小写）

                                    strripos() - 查找字符串在另一字符串中最后一次出现的位置（不区分大小写）

                                    strrpos() - 查找字符串在另一字符串中最后一次出现的位置（区分大小写）

                          例子解释：
                          上面的代码检测在邮件地址中是否含有字符串 "example"。如果有，则再次抛出异常：

                                   ①、customException() 类是作为旧的 exception 类的一个扩展来创建的。这样它就继承了旧类的所有属性和方法。

                                   ②、创建 errorMessage() 函数。如果 e-mail 地址不合法，则该函数返回一个错误消息。

                                   ③、把 $email 变量设置为一个有效的邮件地址，但含有字符串 "example"。

                                   ④、"try" 代码块包含另一个 "try" 代码块，这样就可以再次抛出异常。

                                   ⑤、由于 e-mail 包含字符串 "example"，因此触发异常。

                                   ⑥、"catch" 捕获到该异常，并重新抛出 "customException"。

                                   ⑦、捕获到 "customException"，并显示一条错误消息。

                           如果在其目前的 "try" 代码块中异常没有被捕获，则它将在更高层级上查找 catch 代码块。


        8、设置顶层异常处理器 （Top Level Exception Handler）

               set_exception_handler() 函数可设置处理所有未捕获异常的用户定义函数。

                            <?php
                                    function myException($exception)
                                    {
                                    echo "<b>Exception:</b> " , $exception->getMessage();
                                    }

                                    set_exception_handler('myException');

                                    throw new Exception('Uncaught Exception occurred');
                            ?>

              以上代码的输出应该类似这样：Exception: Uncaught Exception occurred

              在上面的代码中，不存在 "catch" 代码块，而是触发顶层的异常处理程序。应该使用此函数来捕获所有未被捕获的异常。


        9、异常的规则

             ①、需要进行异常处理的代码应该放入 try 代码块内，以便捕获潜在的异常。

             ②、每个 try 或 throw 代码块必须至少拥有一个对应的 catch 代码块。

             ③、使用多个 catch 代码块可以捕获不同种类的异常。

             ④、可以在 try 代码块内的 catch 代码块中再次抛出（re-thrown）异常。

                 简而言之：如果抛出了异常，就必须捕获它。


-------------------------------------------------------------------------------------------------------------------------------------------


三十八、PHP 过滤器（Filter）

         PHP 过滤器用于验证和过滤来自非安全来源的数据，比如用户的输入。


         1、什么是 PHP 过滤器？

              PHP 过滤器用于验证和过滤来自非安全来源的数据。

              测试、验证和过滤用户输入或自定义数据是任何 Web 应用程序的重要组成部分。

              PHP 的过滤器扩展的设计目的是使数据过滤更轻松快捷。


         2、为什么使用过滤器？

              几乎所有的 Web 应用程序都依赖外部的输入。这些数据通常来自用户或其他应用程序（比如 web 服务）。通过使用过滤器，您能够确保应用程序获得正确的输入类型。

              您应该始终对外部数据进行过滤！

              输入过滤是最重要的应用程序安全课题之一。

              什么是外部数据？

                           来自表单的输入数据

                           Cookies

                           Web services data

                           服务器变量

                           数据库查询结果


         3、函数和过滤器

              如需过滤变量，请使用下面的过滤器函数之一：

                              filter_var() - 通过一个指定的过滤器来过滤单一的变量

                              filter_var_array() - 通过相同的或不同的过滤器来过滤多个变量

                              filter_input - 获取一个输入变量，并对它进行过滤

                              filter_input_array - 获取多个输入变量，并通过相同的或不同的过滤器对它们进行过滤


              在下面的实例中，我们用 filter_var() 函数验证了一个整数：

                            <?php
                                        $int = 123;
                                         
                                        if(!filter_var($int, FILTER_VALIDATE_INT))
                                        {
                                            echo("不是一个合法的整数");
                                        }
                                        else
                                        {
                                            echo("是个合法的整数");
                                        }
                            ?>

              上面的代码使用了 "FILTER_VALIDATE_INT" 过滤器来过滤变量。由于这个整数是合法的，因此上面的代码将输出：

                                        是个合法的整数

              如果我们尝试使用一个非整数的变量（比如 "123abc"），则将输出："Integer is not valid"。

              如需查看完整的函数和过滤器列表，请访问我们的 PHP Filter 参考手册：http://www.runoob.com/php/php-ref-filter.html


         4、Validating 和 Sanitizing

              有两种过滤器：

                 Validating 过滤器：

                              用于验证用户输入

                              严格的格式规则（比如 URL 或 E-Mail 验证）

                              如果成功则返回预期的类型，如果失败则返回 FALSE

                 Sanitizing 过滤器：

                              用于允许或禁止字符串中指定的字符

                              无数据格式规则

                              始终返回字符串

         5、选项和标志

              选项和标志用于向指定的过滤器添加额外的过滤选项。

              不同的过滤器有不同的选项和标志。

              在下面的实例中，我们用 filter_var() 和 "min_range" 以及 "max_range" 选项验证了一个整数：

                                <?php
                                        $var=300;
                                         
                                        $int_options = array(
                                            "options"=>array
                                            (
                                                "min_range"=>0,
                                                "max_range"=>256
                                            )
                                        );
                                         
                                        if(!filter_var($var, FILTER_VALIDATE_INT, $int_options))
                                        {
                                            echo("不是一个合法的整数");
                                        }
                                        else
                                        {
                                            echo("是个合法的整数");
                                        }
                                ?>

              就像上面的代码一样，选项必须放入一个名为 "options" 的相关数组中。如果使用标志，则不需在数组内。

              由于整数是 "300"，它不在指定的范围内，以上代码的输出将是：

                                                        不是一个合法的整数

              如需查看完整的函数和过滤器列表，请访问我们的 PHP Filter 参考手册。您可以看到每个过滤器的可用选项和标志。


         6、验证输入

                让我们试着验证来自表单的输入。

                我们需要做的第一件事情是确认是否存在我们正在查找的输入数据。

                然后我们用 filter_input() 函数过滤输入的数据。

                在下面的实例中，输入变量 "email" 被传到 PHP 页

                            <?php
                                    if(!filter_has_var(INPUT_GET, "email"))
                                    {
                                        echo("没有 email 参数");
                                    }
                                    else
                                    {
                                        if (!filter_input(INPUT_GET, "email", FILTER_VALIDATE_EMAIL))
                                        {
                                            echo "不是一个合法的 E-Mail";
                                        }
                                        else
                                        {
                                            echo "是一个合法的 E-Mail";
                                        }
                                    }
                            ?>

                以上实例测试结果如下：

                     两种情况：
                              （1）、http://localhost/github_php/PHPDemo/copy.php

                                          运行结果： 没有 email 参数
                             
                              （2）、http://localhost/github_php/PHPDemo/copy.php?email=test@runoob.com

                                          运行结果： 是一个合法的 E-Mail

         7、实例解释

             上面的实例有一个通过 "GET" 方法传送的输入变量 (email)：

                                  检测是否存在 "GET" 类型的 "email" 输入变量

                                  如果存在输入变量，检测它是否是有效的 e-mail 地址


         8、净化输入

              让我们试着清理一下从表单传来的 URL。

              首先，我们要确认是否存在我们正在查找的输入数据。

              然后，我们用 filter_input() 函数来净化输入数据。

              在下面的实例中，输入变量 "url" 被传到 PHP 页面：

                        <?php
                                if(!filter_has_var(INPUT_GET, "url"))
                                {
                                    echo("没有 url 参数");
                                }
                                else
                                {
                                    $url = filter_input(INPUT_GET, 
                                    "url", FILTER_SANITIZE_URL);
                                    echo $url;
                                }
                        ?>


         9、实例解释

              上面的实例有一个通过 "GET" 方法传送的输入变量 (url)：

                          ①、检测是否存在 "GET" 类型的 "url" 输入变量

                          ②、如果存在此输入变量，对其进行净化（删除非法字符），并将其存储在 $url 变量中

              假如输入变量是一个类似这样的字符串："http://www.runoob.com/"，则净化后的 $url 变量如下所示：

                                               http://www.runoob.com



         10、过滤多个输入

               表单通常由多个输入字段组成。

               为了避免对 filter_var 或 filter_input 函数重复调用，我们可以使用 filter_var_array 或 the filter_input_array 函数。

               在本例中，我们使用 filter_input_array() 函数来过滤三个 GET 变量。

               接收到的 GET 变量是一个名字、一个年龄以及一个 e-mail 地址：

                                <?php
                                        $filters = array
                                        (
                                            "name" => array
                                            (
                                                "filter"=>FILTER_SANITIZE_STRING
                                            ),
                                            "age" => array
                                            (
                                                "filter"=>FILTER_VALIDATE_INT,
                                                "options"=>array
                                                (
                                                    "min_range"=>1,
                                                    "max_range"=>120
                                                )
                                            ),
                                            "email" => FILTER_VALIDATE_EMAIL
                                        );
                                         
                                        $result = filter_input_array(INPUT_GET, $filters);

                                        if (!$result["age"])
                                        {
                                            echo("年龄必须在 1 到 120 之间。<br>");
                                        }
                                        elseif(!$result["email"])
                                        {
                                            echo("E-Mail 不合法<br>");
                                        }
                                        else
                                        {
                                            echo("输入正确");
                                        }
                                ?>

         11、实例解释

               上面的实例有三个通过 "GET" 方法传送的输入变量 (name、age 和 email)：

                      ①、设置一个数组，其中包含了输入变量的名称和用于指定的输入变量的过滤器

                      ②、调用 filter_input_array() 函数，参数包括 GET 输入变量及刚才设置的数组

                      ③、检测 $result 变量中的 "age" 和 "email" 变量是否有非法的输入。（如果存在非法输入，在使用 filter_input_array() 函数之后，输入变量为 FALSE。）


               filter_input_array() 函数的第二个参数可以是数组或单一过滤器的 ID。

               如果该参数是单一过滤器的 ID，那么这个指定的过滤器会过滤输入数组中所有的值。

               如果该参数是一个数组，那么此数组必须遵循下面的规则：

                      ①、必须是一个关联数组，其中包含的输入变量是数组的键（比如 "age" 输入变量）

                      ②、此数组的值必须是过滤器的 ID ，或者是规定了过滤器、标志和选项的数组


         12、使用 Filter Callback

               通过使用 FILTER_CALLBACK 过滤器，可以调用自定义的函数，把它作为一个过滤器来使用。这样，我们就拥有了数据过滤的完全控制权。

               您可以创建自己的自定义函数，也可以使用已存在的 PHP 函数。

               将您准备用到的过滤器的函数，按指定选项的规定方法进行规定。在关联数组中，带有名称 "options"。

                                    <?php
                                                function convertSpace($string)
                                                {
                                                    return str_replace("_", ".", $string);
                                                }
                                                 
                                                $string = "www_runoob_com!";
                                                 
                                                echo filter_var($string, FILTER_CALLBACK,
                                                array("options"=>"convertSpace"));
                                    ?>


                上面代码的结果如下所示：  www.runoob.com!



         13、实例解释

               上面的实例把所有 "_" 转换成 "." ：

                              ①、创建一个把 "_" 替换为 "." 的函数

                              ②、调用 filter_var() 函数，它的参数是 FILTER_CALLBACK 过滤器以及包含我们的函数的数组




-------------------------------------------------------------------------------------------------------------------------------------------


三十九、PHP 高级过滤器


      1、检测一个数字是否在一个范围内

           以下实例使用了 filter_var() 函数来检测一个 INT 型的变量是否在 1 到 200 内:

                                <?php
                                        $int = 122;
                                        $min = 1;
                                        $max = 200;

                                        if (filter_var($int, FILTER_VALIDATE_INT, array("options" => array("min_range"=>$min,                                         "max_range"=>$max))) === false) {

                                            echo("变量值不在合法范围内");  
                                                     
                                        } else {

                                            echo("变量值在合法范围内");
                                        }
                                ?>


      2、检测 IPv6 地址

           以下实例使用了 filter_var() 函数来检测一个 $ip 变量是否是 IPv6 地址:

                                    <?php
                                            $ip = "2001:0db8:85a3:08d3:1319:8a2e:0370:7334";

                                            if (!filter_var($ip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6) === false) {

                                                echo("$ip 是一个 IPv6 地址");

                                            } else {

                                                echo("$ip 不是一个 IPv6 地址");
                                            }
                                    ?>



      3、检测 URL - 必须包含QUERY_STRING（查询字符串）

            以下实例使用了 filter_var() 函数来检测 $url 是否包含查询字符串：

                                <?php
                                            $url = "http://www.runoob.com";

                                            if (!filter_var($url, FILTER_VALIDATE_URL, FILTER_FLAG_QUERY_REQUIRED) === false) {

                                                echo("$url 是一个合法的 URL");

                                            } else {

                                                echo("$url 不是一个合法的 URL");
                                            }
                                ?>


                    以上例子中，filter_var($url, FILTER_VALIDATE_URL, FILTER_FLAG_QUERY_REQUIRED)函数中若包含QUERY_STRING（查询字符串），则返回true，反之则返回false.
                          
                      “http://www.runoob.com?urlid=123”中的“urlid=123”则为查询字符串。



      4、移除 ASCII 值大于 127 的字符

           以下实例使用了 filter_var() 函数来移除字符串中 ASCII 值大于 127 的字符，同样它也能移除 HTML 标签：

                                <?php
                                        $str = "<h1>Hello World???!</h1>";

                                        $newstr = filter_var($str, FILTER_SANITIZE_STRING, FILTER_FLAG_STRIP_HIGH);

                                        echo $newstr;
                                ?>

           PHP 过滤器参考手册：http://www.runoob.com/php/php-ref-filter.html



-------------------------------------------------------------------------------------------------------------------------------------------


四十、PHP JSON

       本章节我们将为大家介绍如何使用 PHP 语言来编码和解码 JSON 对象。

       1、环境配置

            在 php5.2.0 及以上版本已经内置 JSON 扩展。


       2、JSON 函数

            函数	             描述

            json_encode      	     对变量进行 JSON 编码

            json_decode	     	     对 JSON 格式的字符串进行解码，转换为 PHP 变量

            json_last_error	     返回最后发生的错误


       3、json_encode

            PHP json_encode() 用于对变量进行 JSON 编码，该函数如果执行成功返回 JSON 数据，否则返回 FALSE 。

            语法：string json_encode ( $value [, $options = 0 ] )

            参数：
                  value: 要编码的值。该函数只对 UTF-8 编码的数据有效。

                  options:由以下常量组成的二进制掩码：JSON_HEX_QUOT, JSON_HEX_TAG, JSON_HEX_AMP, JSON_HEX_APOS, JSON_NUMERIC_CHECK,JSON_PRETTY_PRINT, JSON_UNESCAPED_SLASHES, JSON_FORCE_OBJECT


            以下实例演示了如何将 PHP 数组转换为 JSON 格式数据：

              <?php
                     $arr = array('a' => 1, 'b' => 2, 'c' => 3, 'd' => 4, 'e' => 5);
                     echo json_encode($arr);
              ?>


            以上代码执行结果为：{"a":1,"b":2,"c":3,"d":4,"e":5}


            以下实例演示了如何将 PHP 对象转换为 JSON 格式数据：

                            <?php
                                   class Emp {
                                       public $name = "";
                                       public $hobbies  = "";
                                       public $birthdate = "";
                                   }
                                   $e = new Emp();
                                   $e->name = "sachin";
                                   $e->hobbies  = "sports";
                                   $e->birthdate = date('m/d/Y h:i:s a', "8/5/1974 12:20:03 p");
                                   $e->birthdate = date('m/d/Y h:i:s a', strtotime("8/5/1974 12:20:03"));

                                   echo json_encode($e);
                            ?>

              以上代码执行结果为：

                           {"name":"sachin","hobbies":"sports","birthdate":"08\/05\/1974 12:20:03 pm"}


       4、json_decode

            PHP json_decode() 函数用于对 JSON 格式的字符串进行解码，并转换为 PHP 变量。

            语法： mixed json_decode ($json_string [,$assoc = false [, $depth = 512 [, $options = 0 ]]])

            参数：
                  json_string: 待解码的 JSON 字符串，必须是 UTF-8 编码数据

                  assoc: 当该参数为 TRUE 时，将返回数组，FALSE 时返回对象。

                  depth: 整数类型的参数，它指定递归深度

                  options: 二进制掩码，目前只支持 JSON_BIGINT_AS_STRING 。

            实例
            以下实例演示了如何解码 JSON 数据：

                        <?php
                           $json = '{"a":1,"b":2,"c":3,"d":4,"e":5}';

                           var_dump(json_decode($json));
                           var_dump(json_decode($json, true));
                        ?>


                以上代码执行结果为：

                        object(stdClass)#1 (5) {
                            ["a"] => int(1)
                            ["b"] => int(2)
                            ["c"] => int(3)
                            ["d"] => int(4)
                            ["e"] => int(5)
                        }

                        array(5) {
                            ["a"] => int(1)
                            ["b"] => int(2)
                            ["c"] => int(3)
                            ["d"] => int(4)
                            ["e"] => int(5)
                        }



-------------------------------------------------------------------------------------------------------------------------------------------


四十一、PHP 7 新特性

          PHP 7+ 版本极大地改进了性能，在一些WordPress基准测试当中，性能可以达到PHP 5.6的3倍。

          PHP 7+ 版本新加特性如下表所示：http://www.runoob.com/php/php7-new-features.html


-------------------------------------------------------------------------------------------------------------------------------------------



四十二、PHP MySQL 简介


         通过 PHP，您可以连接和操作数据库。

         MySQL 是跟 PHP 配套使用的最流行的开源数据库系统。

         如果想学习更多 MySQL 知识可以查看本站 MySQL 教程：http://www.runoob.com/mysql/mysql-tutorial.html


       1、MySQL 是什么？
                        MySQL 是一种在 Web 上使用的数据库系统。
                        MySQL 是一种在服务器上运行的数据库系统。
                        MySQL 不管在小型还是大型应用程序中，都是理想的选择。
                        MySQL 是非常快速，可靠，且易于使用的。
                        MySQL 支持标准的 SQL。
                        MySQL 在一些平台上编译。
                        MySQL 是免费下载使用的。
                        MySQL 是由 Oracle 公司开发、发布和支持的。
                        MySQL 是以公司创始人 Monty Widenius's daughter: My 命名的。


         MySQL 中的数据存储在表中。表格是一个相关数据的集合，它包含了列和行。

         在分类存储信息时，数据库非常有用。一个公司的数据库可能拥有以下表：

                                                 Employees
                                                 Products
                                                 Customers
                                                 Orders


       2、PHP + MySQL

         PHP 与 MySQL 结合是跨平台的。（您可以在 Windows 上开发，在 Unix 平台上应用。）


       3、查询

            查询是一种询问或请求。

            通过 MySQL，我们可以向数据库查询具体的信息，并得到返回的记录集。

            请看下面的查询（使用标准 SQL）：

                    mysql> set names utf8;
                    mysql> SELECT name FROM websites;
                    +---------------+
                    | name          |
                    +---------------+
                    | Google        |
                    | 淘宝        |
                    | 菜鸟教程  |
                    | 微博        |
                    | Facebook      |
                    | stackoverflow |
                    +---------------+
                    6 rows in set (0.00 sec)

             语句 set names utf8;用于设定数据库编码，让中文可以正常显示。

                上面的查询选取了 "websites" 表中 "name" 列的所有数据。

                如需学习更多关于 SQL 的知识，请访问我们的 SQL 教程。



       4、下载 MySQL 数据库

            如果您的 PHP 服务器没有 MySQL 数据库，可以在此免费下载 MySQL： http://www.mysql.com。


       5、关于 MySQL 数据库的事实

            关于 MySQL 的一点很棒的特性是，可以对它进行缩减，来支持嵌入的数据库应用程序。也许正因为如此，许多人认为 MySQL 仅仅能处理中小型的系统。

            事实上，对于那些支持巨大数据和访问量的网站（比如 Friendster、Yahoo、Google），MySQL 是事实上的标准数据库。

            这个地址提供了使用 MySQL 的公司的概览： http://www.mysql.com/customers/。


       6、PHP 连接 MySQL

            PHP 5 及以上版本建议使用以下方式连接 MySQL :

                             MySQLi extension ("i" 意为 improved)

                             PDO (PHP Data Objects)

            在 PHP 早期版本中我们使用 MySQL 扩展。但该扩展在 2012 年开始不建议使用。



       7、我是该用 MySQLi ，还是 PDO?

                如果你需要一个简短的回答，即 "你习惯哪个就用哪个"。

                MySQLi 和 PDO 有它们自己的优势：

                PDO 应用在 12 种不同数据库中， MySQLi 只针对 MySQL 数据库。

                所以，如果你的项目需要在多种数据库中切换，建议使用 PDO ，这样你只需要修改连接字符串和部分查询语句即可。 使用 MySQLi, 如果不同数据库，你需要重新编写所有代码，包括查询。

                两者都是面向对象, 但 MySQLi 还提供了 API 接口。

                两者都支持预处理语句。 预处理语句可以防止 SQL 注入，对于 web 项目的安全性是非常重要的。



       8、MySQLi 和 PDO 连接 MySQL 实例

             在本章节及接下来的章节中，我们会使用以下三种方式来演示 PHP 操作 MySQL:

                                            MySQLi (面向对象)

                                            MySQLi (面向过程)

                                            PDO


       9、MySQLi 安装

            Linux 和 Windows: 在 php5 mysql 包安装时 MySQLi 扩展多数情况下是自动安装的。

            安装详细信息，请查看： http://php.net/manual/en/mysqli.installation.php

            可以通过 phpinfo() 查看是否安装成功：http://www.runoob.com/php/php-mysql-connect.html


       10、PDO 安装

            For 安装详细信息，请查看： http://php.net/manual/en/pdo.installation.php

            可以通过 phpinfo() 查看是否安装成功：http://www.runoob.com/php/php-mysql-connect.html


       11、连接 MySQL

            在我们访问 MySQL 数据库前，我们需要先连接到数据库服务器：

           （1）、实例 (MySQLi - 面向对象)：

                        <?php
                                $servername = "localhost";
                                $username = "username";
                                $password = "password";
                                 
                                // 创建连接
                                $conn = new mysqli($servername, $username, $password);
                                 
                                // 检测连接
                                if ($conn->connect_error) {

                                    die("连接失败: " . $conn->connect_error);
                                } 
                                echo "连接成功";
                        ?>

                      真例子：
                        <?php
                                $servername = "localhost:3306";
                                $username = "root";
                                $password = "123456";
                                 
                                // 创建连接
                                $conn = new mysqli($servername, $username, $password);
                                 
                                // 检测连接
                                if ($conn->connect_error) {

                                    die("连接失败: " . $conn->connect_error);
                                } 
                                echo "连接成功";
                        ?>

                             运行结果： 连接成功

            注意在以上面向对象的实例中 $connect_error 是在 PHP 5.2.9 和 5.3.0 中添加的。如果你需要兼容更早版本 请使用以下代码替换:

            // 检测连接
                   if (mysqli_connect_error()) {

                       die("数据库连接失败: " . mysqli_connect_error());
                   }



           （2）、实例 (MySQLi - 面向过程)

                        <?php
                                    $servername = "localhost";
                                    $username = "username";
                                    $password = "password";
                                     
                                    // 创建连接
                                    $conn = mysqli_connect($servername, $username, $password);
                                     
                                    // 检测连接
                                    if (!$conn) {
                                        die("Connection failed: " . mysqli_connect_error());
                                    }
                                    echo "连接成功";
                        ?>

                      真例子：
                        <?php
                                $servername = "localhost:3306";
                                $username = "root";
                                $password = "123456";
                                 
                               // 创建连接
                                    $conn = mysqli_connect($servername, $username, $password);
                                     
                                    // 检测连接
                                    if (!$conn) {
                                        die("Connection failed: " . mysqli_connect_error());
                                    }
                                    echo "连接成功";
                        ?>

                             运行结果： 连接成功


           （3）、实例 (PDO)

                    <?php
                                $servername = "localhost";
                                $username = "username";
                                $password = "password";
                                 
                                try {
                                    $conn = new PDO("mysql:host=$servername;", $username, $password);
                                    echo "连接成功"; 
                                }
                                catch(PDOException $e)
                                {
                                    echo $e->getMessage();
                                }
                    ?>

	           注意在以上 PDO 实例中我们已经指定了数据库 (myDB)。PDO 在连接过程需要设置数据库名。如果没有指定，则会抛出异常。


           （4）、关闭连接

                      连接在脚本执行完后会自动关闭。你也可以使用以下代码来关闭连接：

                                             实例 (MySQLi - 面向对象):    $conn->close();

                                             实例 (MySQLi - 面向过程):    mysqli_close($conn);

                                             实例 (PDO):      $conn = null;

             额外笔记：

                我们可以用一下办法来测试PHP的MySQL数据库的连接。

                使用函数 parse_ini_file() 解析配置文件 config.ini 来获得数据库连接参数，然后使用 new 关键字对 mysqli 类进行实例化，最后使用函数 mysqli_connect_errno() 来判断是否成功连接上了 MySQL 数据库，实现该过程的代码如下所示：

                            try{
                                    //解析config.ini文件
                                    $config = parse_ini_file(realpath(dirname(__FILE__) . '/config/config.ini'));

                                    //对mysqli类进行实例化
                                    $mysqli = new mysqli($config['host'], $config['username'], $config['password'], $config['dbname']);  
 
                                    if(mysqli_connect_errno()){    //判断是否成功连接上MySQL数据库

                                        throw new Exception('数据库连接错误！');  //如果连接错误，则抛出异常

                                    }else{

                                        echo '数据库连接成功！';   //打印连接成功的提示
                                    }

                             }catch (Exception $e){        //捕获异常

                                    echo $e->getMessage();    //打印异常信息
                             }



-------------------------------------------------------------------------------------------------------------------------------------------


四十三、PHP MySQL 创建数据库

      数据库存有一个或多个表。

      你需要 CREATE 权限来创建或删除 MySQL 数据库。


      1、使用 MySQLi 和 PDO 创建 MySQL 数据库

          CREATE DATABASE 语句用于在 MySQL 中创建数据库。

          在下面的实例中，创建了一个名为 "myDB" 的数据库：

            (1)、 实例 (MySQLi - 面向对象):

                            <?php
                                   $servername = "localhost:3306"; // $servername = "localhost";
                                   $username = "root";             // $username = "username";
                                   $password = "123456";           //$password = "password";
                                     
                                    // 创建连接
                                    $conn = new mysqli($servername, $username, $password);
                                    // 检测连接
                                    if ($conn->connect_error) {
                                        die("连接失败: " . $conn->connect_error);
                                    } 
                                     
                                    // 创建数据库
                                    $sql = "CREATE DATABASE myDB_demophp";

                                    if ($conn->query($sql) === TRUE) {

                                        echo "数据库创建成功";
                                    } else {
                                        echo "Error creating database: " . $conn->error;
                                    }
                                     
                                    $conn->close();
                            ?>

         注意： 当你创建一个新的数据库时，你必须为 mysqli 对象指定三个参数 (servername, username 和 password)。

         Tip: 如果你使用其他端口（默认为3306），为数据库参数添加空字符串，如: new mysqli("localhost", "username", "password", "", port)


            (2)、 实例 (MySQLi Procedural)

                            <?php
                                        $servername = "localhost:3306"; // $servername = "localhost";
                                        $username = "root";             // $username = "username";
                                        $password = "123456";           //$password = "password";
                                         
                                        // 创建连接
                                        $conn = mysqli_connect($servername, $username, $password);

                                        // 检测连接
                                        if (!$conn) {
                                            die("连接失败: " . mysqli_connect_error());
                                        }
                                         
                                        // 创建数据库
                                        $sql = "CREATE DATABASE myDB";
                                        if (mysqli_query($conn, $sql)) {
                                            echo "数据库创建成功";
                                        } else {
                                            echo "Error creating database: " . mysqli_error($conn);
                                        }
                                         
                                        mysqli_close($conn);
                            ?>


            (3)、 注意： 以下使用 PDO 实例创建数据库 myDBPDO :

                  使用 PDO：
                            <?php 
                                    $servername = "localhost"; 
                                    $username = "username"; 
                                    $password = "password"; 

                                    try { 
                                        $conn = new PDO("mysql:host=$servername", $username, $password); 

                                        // 设置 PDO 错误模式为异常 
                                        $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
                                        $sql = "CREATE DATABASE myDBPDO"; 

                                        // 使用 exec() ，因为没有结果返回 
                                        $conn->exec($sql); 

                                        echo "数据库创建成功<br>"; 
                                    } 
                                    catch(PDOException $e) 
                                    { 
                                        echo $sql . "<br>" . $e->getMessage(); 
                                    } 

                                    $conn = null; 
                            ?>


                  提示： 使用 PDO 的最大好处是在数据库查询过程出现问题时可以使用异常类来 处理问题。

                         如果 try{ } 代码块出现异常，脚本会停止执行并会跳到第一个 catch(){ } 代码块执行代码。 在以上捕获的代码块中我们输出了 SQL 语句并生成错误信息。



-------------------------------------------------------------------------------------------------------------------------------------------


四十四、PHP 创建 MySQL 表

        一个数据表有一个唯一名称，并有行和列组成。

        1、使用 MySQLi 和 PDO 创建 MySQL 表

             CREATE TABLE 语句用于创建 MySQL 表。

             创建表前，我们需要使用 use myDB 来选择要操作的数据库：      use myDB;

             我们将创建一个名为 "MyGuests" 的表，有 5 个列： "id", "firstname", "lastname", "email" 和 "reg_date":

                                CREATE TABLE MyGuests (

                                    id INT(6)    UNSIGNED AUTO_INCREMENT PRIMARY KEY,
                                    firstname    VARCHAR(30) NOT NULL,
                                    lastname     VARCHAR(30) NOT NULL,
                                    email        VARCHAR(50),
                                    reg_date     TIMESTAMP
                                )


             上表中的注意事项:  数据类型指定列可以存储什么类型的数据。完整的数据类型请参考我们的 数据类型参考手册。

             在设置了数据类型后，你可以为每个列指定其他选项的属性：

                       ①、NOT NULL - 每一行都必须含有值（不能为空），null 值是不允许的。

                       ②、DEFAULT value - 设置默认值

                       ③、UNSIGNED - 使用无符号数值类型，0 及正数

                       ④、AUTO INCREMENT - 设置 MySQL 字段的值在新增记录时每次自动增长 1

                       ⑤、PRIMARY KEY - 设置数据表中每条记录的唯一标识。 通常列的 PRIMARY KEY 设置为 ID 数值，与 AUTO_INCREMENT 一起使用。


             每个表都应该有一个主键(本列为 "id" 列)，主键必须包含唯一的值。


            以下实例展示了如何在 PHP 中创建表：

                  （1）、实例 (MySQLi - 面向对象)
                                    <?php
                                            $servername = "localhost";
                                            $username = "username";
                                            $password = "password";
                                            $dbname = "myDB";
                                             
                                            // 创建连接
                                            $conn = new mysqli($servername, $username, $password, $dbname);
                                            // 检测连接
                                            if ($conn->connect_error) {
                                                die("连接失败: " . $conn->connect_error);
                                            } 
                                             
                                            // 使用 sql 创建数据表
                                            $sql = "CREATE TABLE MyGuests (
                                            id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
                                            firstname VARCHAR(30) NOT NULL,
                                            lastname VARCHAR(30) NOT NULL,
                                            email VARCHAR(50),
                                            reg_date TIMESTAMP
                                            )";
                                             
                                            if ($conn->query($sql) === TRUE) {

                                                echo "Table MyGuests created successfully";

                                            } else {

                                                echo "创建数据表错误: " . $conn->error;
                                            }
                                             
                                            $conn->close();
                                    ?>


                  （2）、实例 (MySQLi - 面向过程)

                                <?php
                                        $servername = "localhost";
                                        $username = "username";
                                        $password = "password";
                                        $dbname = "myDB";
                                         
                                        // 创建连接
                                        $conn = mysqli_connect($servername, $username, $password, $dbname);

                                        // 检测连接
                                        if (!$conn) {

                                            die("连接失败: " . mysqli_connect_error());
                                        }
                                         
                                        // 使用 sql 创建数据表
                                        $sql = "CREATE TABLE MyGuests (
                                                    id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
                                                    firstname VARCHAR(30) NOT NULL,
                                                    lastname VARCHAR(30) NOT NULL,
                                                    email VARCHAR(50),
                                                    reg_date TIMESTAMP
                                            )";
                                         
                                        if (mysqli_query($conn, $sql)) {

                                            echo "数据表 MyGuests 创建成功";

                                        } else {
                                            
                                            echo "创建数据表错误: " . mysqli_error($conn);
                                        }
                                         
                                        mysqli_close($conn);
                                ?>


                  （3）、实例 (PDO)：
                                    <?php
                                            $servername = "localhost";
                                            $username = "username";
                                            $password = "password";
                                            $dbname = "myDBPDO";
                                             
                                            try {
                                                $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
                                                // 设置 PDO 错误模式，用于抛出异常
                                                $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                                             
                                                // 使用 sql 创建数据表
                                                $sql = "CREATE TABLE MyGuests (
                                                            id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY, 
                                                            firstname VARCHAR(30) NOT NULL,
                                                            lastname VARCHAR(30) NOT NULL,
                                                            email VARCHAR(50),
                                                            reg_date TIMESTAMP
                                                            )";
                                             
                                                // 使用 exec() ，没有结果返回 
                                                $conn->exec($sql);
                                                echo "数据表 MyGuests 创建成功";
                                            }
                                            catch(PDOException $e)
                                            {
                                                echo $sql . "<br>" . $e->getMessage();
                                            }
                                             
                                            $conn = null;
                                    ?>


-------------------------------------------------------------------------------------------------------------------------------------------


四十五、PHP MySQL 插入数据

       1、使用 MySQLi 和 PDO 向 MySQL 插入数据

            在创建完数据库和表后，我们可以向表中添加数据。

                    以下为一些语法规则：
                                        ①、PHP 中 SQL 查询语句必须使用引号

                                        ②、在 SQL 查询语句中的字符串值必须加引号

                                        ③、数值的值不需要引号

                                        ④、NULL 值不需要引号


            INSERT INTO 语句通常用于向 MySQL 表添加新的记录：

                   INSERT INTO table_name (column1, column2, column3,...)
                                                   VALUES (value1, value2, value3,...)


            在前面的几个章节中我们已经创建了表 "MyGuests"，表字段有: "id", "firstname", "lastname", "email" 和 "reg_date"。 

            现在，让我们开始向表填充数据。

                     注意： 如果列设置 AUTO_INCREMENT (如 "id" 列) 或 TIMESTAMP (如 "reg_date" 列)，我们就不需要在 SQL 查询语句中指定值； MySQL 会自动为该列添加值。

            以下实例向 "MyGuests" 表添加了新的记录:

            （1）实例 (MySQLi - 面向对象)
                                    <?php
                                            $servername = "localhost";
                                            $username = "username";
                                            $password = "password";
                                            $dbname = "myDB";

                                            // 创建连接
                                            $conn = new mysqli($servername, $username, $password, $dbname);

                                            // 检测连接
                                            if ($conn->connect_error) {
                                                die("连接失败: " . $conn->connect_error);
                                            } 

                                            $sql = "INSERT INTO MyGuests (firstname, lastname, email)
                                                                 VALUES ('John', 'Doe', 'john@example.com')";

                                            if ($conn->query($sql) === TRUE) {

                                                echo "新记录插入成功";

                                            } else {

                                                echo "Error: " . $sql . "<br>" . $conn->error;
                                            }

                                            $conn->close();
                                    ?>


            （2）实例 (MySQLi - 面向过程)

                                <?php
                                        $servername = "localhost";
                                        $username = "username";
                                        $password = "password";
                                        $dbname = "myDB";
                                         
                                        // 创建连接
                                        $conn = mysqli_connect($servername, $username, $password, $dbname);

                                        // 检测连接
                                        if (!$conn) {
                                            die("Connection failed: " . mysqli_connect_error());
                                        }
                                         
                                        $sql = "INSERT INTO MyGuests (firstname, lastname, email)
                                                                 VALUES ('John', 'Doe', 'john@example.com')";
                                        
                                        if (mysqli_query($conn, $sql)) {

                                            echo "新记录插入成功";

                                        } else {

                                            echo "Error: " . $sql . "<br>" . mysqli_error($conn);
                                        }
                                         
                                        mysqli_close($conn);
                                ?>

            （3）实例 (PDO)
                                <?php
                                        $servername = "localhost";
                                        $username = "username";
                                        $password = "password";
                                        $dbname = "myDBPDO";
                                         
                                        try {
                                            $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
                                            // 设置 PDO 错误模式，用于抛出异常
                                            $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                                            $sql = "INSERT INTO MyGuests (firstname, lastname, email)
                                            VALUES ('John', 'Doe', 'john@example.com')";
                                            // 使用 exec() ，没有结果返回 
                                            $conn->exec($sql);
                                            echo "新记录插入成功";
                                        }
                                        catch(PDOException $e)
                                        {
                                            echo $sql . "<br>" . $e->getMessage();
                                        }
                                         
                                        $conn = null;
                                ?>

                    
                 额外知识：
                         
                     在学习 PDO 创建数据表的时候 ， 我遇到这个报错：SQLSTATE[3D000]: Invalid catalog name: 1046 No database selected

                              最后发现问题在这里：  $conn = new PDO("mysql:host = $servername;dbname = $dbname",$username,$password);

                     因为我写代码的习惯是" = "两边都加上空格 ， 但是在这里 dbname = $dbname 的等号两边却不可以存在空格，所以正确的写法应该是 dbname=$dbname：

                              $conn = new PDO("mysql:host = $servername;dbname=$dbname",$username,$password);

                     这样就没有报错了！



-------------------------------------------------------------------------------------------------------------------------------------------


四十六、PHP MySQL 插入多条数据

      1、使用 MySQLi 和 PDO 向 MySQL 插入多条数据

          mysqli_multi_query() 函数可用来执行多条SQL语句。

          以下实例向 "MyGuests" 表添加了三条新的记录:

         （1）、实例 (MySQLi - 面向对象)：

                            <?php
                                    $servername = "localhost";
                                    $username = "username";
                                    $password = "password";
                                    $dbname = "myDB";
                                     
                                    // 创建链接
                                    $conn = new mysqli($servername, $username, $password, $dbname);

                                    // 检查链接
                                    if ($conn->connect_error) {
                                        die("连接失败: " . $conn->connect_error);
                                    } 
                                     
                                    $sql = "INSERT INTO MyGuests (firstname, lastname, email)
                                                        VALUES ('John', 'Doe', 'john@example.com');";

                                    $sql .= "INSERT INTO MyGuests (firstname, lastname, email)
                                                        VALUES ('Mary', 'Moe', 'mary@example.com');";

                                    $sql .= "INSERT INTO MyGuests (firstname, lastname, email)
                                                        VALUES ('Julie', 'Dooley', 'julie@example.com')";
                                     
                                    if ($conn->multi_query($sql) === TRUE) {

                                        echo "新记录插入成功";

                                    } else {

                                        echo "Error: " . $sql . "<br>" . $conn->error;
                                    }
                                     
                                    $conn->close();
                            ?>

	          请注意，每个SQL语句必须用分号隔开。


         （2）、实例 (MySQLi - 面向过程)：

                                <?php
                                        $servername = "localhost";
                                        $username = "username";
                                        $password = "password";
                                        $dbname = "myDB";
                                         
                                        // 创建链接
                                        $conn = mysqli_connect($servername, $username, $password, $dbname);
                                        // 检查链接
                                        if (!$conn) {
                                            die("连接失败: " . mysqli_connect_error());
                                        }
                                         
                                        $sql = "INSERT INTO MyGuests (firstname, lastname, email)
                                        VALUES ('John', 'Doe', 'john@example.com');";
                                        $sql .= "INSERT INTO MyGuests (firstname, lastname, email)
                                        VALUES ('Mary', 'Moe', 'mary@example.com');";
                                        $sql .= "INSERT INTO MyGuests (firstname, lastname, email)
                                        VALUES ('Julie', 'Dooley', 'julie@example.com')";
                                         
                                        if (mysqli_multi_query($conn, $sql)) {
                                            echo "新记录插入成功";
                                        } else {
                                            echo "Error: " . $sql . "<br>" . mysqli_error($conn);
                                        }
                                         
                                        mysqli_close($conn);
                                ?>


         （3）、实例 (PDO)
                            <?php
                                    $servername = "localhost";
                                    $username = "username";
                                    $password = "password";
                                    $dbname = "myDBPDO";
                                     
                                    try {
                                        $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
                                        // set the PDO error mode to exception
                                        $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                                     
                                        // 开始事务
                                        $conn->beginTransaction();
                                        // SQL 语句
                                        $conn->exec("INSERT INTO MyGuests (firstname, lastname, email) 
                                        VALUES ('John', 'Doe', 'john@example.com')");
                                        $conn->exec("INSERT INTO MyGuests (firstname, lastname, email) 
                                        VALUES ('Mary', 'Moe', 'mary@example.com')");
                                        $conn->exec("INSERT INTO MyGuests (firstname, lastname, email) 
                                        VALUES ('Julie', 'Dooley', 'julie@example.com')");
                                     
                                        // 提交事务
                                        $conn->commit();
                                        echo "新记录插入成功";
                                    }
                                    catch(PDOException $e)
                                    {
                                        // 如果执行失败回滚
                                        $conn->rollback();
                                        echo $sql . "<br>" . $e->getMessage();
                                    }
                                     
                                    $conn = null;
                            ?>



      2、使用预处理语句

           mysqli 扩展提供了第二种方式用于插入语句。

           我们可以预处理语句及绑定参数。

           mysql 扩展可以不带数据发送语句或查询到mysql数据库。 你可以向列关联或 "绑定" 变量。

          （1）、实例 (MySQLi 使用预处理语句)

                                <?php
                                        $servername = "localhost";
                                        $username = "username";
                                        $password = "password";
                                        $dbname = "myDB";
                                         
                                        // 创建连接
                                        $conn = new mysqli($servername, $username, $password, $dbname);
                                        // 检测连接
                                        if ($conn->connect_error) {
                                            die("连接失败: " . $conn->connect_error);
                                        } else {
                                            $sql = "INSERT INTO MyGuests(firstname, lastname, email)  VALUES(?, ?, ?)";
                                         
                                            // 为 mysqli_stmt_prepare() 初始化 statement 对象
                                            $stmt = mysqli_stmt_init($conn);
                                         
                                            //预处理语句
                                            if (mysqli_stmt_prepare($stmt, $sql)) {
                                                // 绑定参数
                                                mysqli_stmt_bind_param($stmt, 'sss', $firstname, $lastname, $email);
                                         
                                                // 设置参数并执行
                                                $firstname = 'John';
                                                $lastname = 'Doe';
                                                $email = 'john@example.com';
                                                mysqli_stmt_execute($stmt);
                                         
                                                $firstname = 'Mary';
                                                $lastname = 'Moe';
                                                $email = 'mary@example.com';
                                                mysqli_stmt_execute($stmt);
                                         
                                                $firstname = 'Julie';
                                                $lastname = 'Dooley';
                                                $email = 'julie@example.com';
                                                mysqli_stmt_execute($stmt);
                                            }
                                        }
                                ?>

            我们可以看到以上实例中使用模块化来处理问题。我们可以通过创建代码块实现更简单的读取和管理。

            注意参数的绑定。让我们看下 mysqli_stmt_bind_param() 中的代码：

                                 mysqli_stmt_bind_param($stmt, 'sss', $firstname, $lastname, $email);

            该函数绑定参数查询并将参数传递给数据库。第二个参数是 "sss" 。以下列表展示了参数的类型。 s 字符告诉 mysql 参数是字符串。

            可以是以下四种参数:
                                i - 整数

                                d - 双精度浮点数

                                s - 字符串

                                b - 布尔值
                                         
               每个参数必须指定类型，来保证数据的安全性。通过类型的判断可以减少SQL注入漏洞带来的风险。


-------------------------------------------------------------------------------------------------------------------------------------------


四十六、PHP MySQL 预处理语句

       预处理语句对于防止 MySQL 注入是非常有用的。

       1、预处理语句及绑定参数

            预处理语句用于执行多个相同的 SQL 语句，并且执行效率更高。

            预处理语句的工作原理如下：

            （1）、预处理：创建 SQL 语句模板并发送到数据库。预留的值使用参数 "?" 标记 。例如：

                               INSERT INTO MyGuests (firstname, lastname, email) VALUES(?, ?, ?)


            （2）、数据库解析，编译，对SQL语句模板执行查询优化，并存储结果不输出。


            （3）、执行：最后，将应用绑定的值传递给参数（"?" 标记），数据库执行语句。应用可以多次执行语句，如果参数的值不一样。

                     相比于直接执行SQL语句，预处理语句有两个主要优点：

                             预处理语句大大减少了分析时间，只做了一次查询（虽然语句多次执行）。

                             绑定参数减少了服务器带宽，你只需要发送查询的参数，而不是整个语句。

                             预处理语句针对SQL注入是非常有用的，因为参数值发送后使用不同的协议，保证了数据的合法性。



       2、MySQLi 预处理语句

           以下实例在 MySQLi 中使用了预处理语句，并绑定了相应的参数:

           （1）实例 (MySQLi 使用预处理语句)

                        <?php
                                $servername = "localhost";
                                $username = "username";
                                $password = "password";
                                $dbname = "myDB";
                                 
                                // 创建连接
                                $conn = new mysqli($servername, $username, $password, $dbname);
                                 
                                // 检测连接
                                if ($conn->connect_error) {
                                    die("连接失败: " . $conn->connect_error);
                                }
                                 
                                // 预处理及绑定
                                $stmt = $conn->prepare("INSERT INTO MyGuests (firstname, lastname, email) VALUES (?, ?, ?)");
                                $stmt->bind_param("sss", $firstname, $lastname, $email);
                                 
                                // 设置参数并执行
                                $firstname = "John";
                                $lastname = "Doe";
                                $email = "john@example.com";
                                $stmt->execute();
                                 
                                $firstname = "Mary";
                                $lastname = "Moe";
                                $email = "mary@example.com";
                                $stmt->execute();
                                 
                                $firstname = "Julie";
                                $lastname = "Dooley";
                                $email = "julie@example.com";
                                $stmt->execute();
                                 
                                echo "新记录插入成功";
                                 
                                $stmt->close();
                                $conn->close();
                        ?>


             解析以下实例的每行代码:
                                     

                "INSERT INTO MyGuests (firstname, lastname, email) VALUES(?, ?, ?)"    

                      ----》  在 SQL 语句中，我们使用了问号 (?)，在此我们可以将问号替换为整型，字符串，双精度浮点型和布尔值。


            接下来，让我们来看下 bind_param() 函数：

                $stmt->bind_param("sss", $firstname, $lastname, $email);

                      ----》  该函数绑定了 SQL 的参数，且告诉数据库参数的值。 "sss" 参数列处理其余参数的数据类型。s 字符告诉数据库该参数为字符串。

                              参数有以下四种类型:
                                                  i - integer（整型）

                                                  d - double（双精度浮点型）

                                                  s - string（字符串）

                                                  b - BLOB（binary large object:二进制大对象）

                每个参数都需要指定类型。

                      通过告诉数据库参数的数据类型，可以降低 SQL 注入的风险。


            注意： 如果你想插入其他数据（用户输入），对数据的验证是非常重要的。



       3、PDO 中的预处理语句

           以下实例我们在 PDO 中使用了预处理语句并绑定参数:

                    <?php
                            $servername = "localhost";
                            $username = "username";
                            $password = "password";
                            $dbname = "myDBPDO";
                             
                            try {
                                $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);

                                // 设置 PDO 错误模式为异常
                                $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                             
                                // 预处理 SQL 并绑定参数
                                $stmt = $conn->prepare("INSERT INTO MyGuests (firstname, lastname, email) 
                                                                     VALUES (:firstname, :lastname, :email)");
                                $stmt->bindParam(':firstname', $firstname);
                                $stmt->bindParam(':lastname', $lastname);
                                $stmt->bindParam(':email', $email);
                             
                                // 插入行
                                $firstname = "John";
                                $lastname = "Doe";
                                $email = "john@example.com";
                                $stmt->execute();
                             
                                // 插入其他行
                                $firstname = "Mary";
                                $lastname = "Moe";
                                $email = "mary@example.com";
                                $stmt->execute();
                             
                                // 插入其他行
                                $firstname = "Julie";
                                $lastname = "Dooley";
                                $email = "julie@example.com";
                                $stmt->execute();
                             
                                echo "新记录插入成功";
                            }
                            catch(PDOException $e)
                            {
                                echo "Error: " . $e->getMessage();
                            }
                            $conn = null;
                    ?>


-------------------------------------------------------------------------------------------------------------------------------------------


四十七、PHP MySQL 读取数据

     1、从 MySQL 数据库读取数据

          SELECT 语句用于从数据表中读取数据:   SELECT column_name(s) FROM table_name

     2、我们可以使用 * 号来读取所有数据表中的字段：  

          SELECT * FROM table_name

     3、使用 MySQLi

          以下实例中我们从 myDB 数据库的 MyGuests 表读取了 id, firstname 和 lastname 列的数据并显示在页面上：

         （1）、实例 (MySQLi - 面向对象)：

                        <?php
                                $servername = "localhost";
                                $username = "username";
                                $password = "password";
                                $dbname = "myDB";
                                 
                                // 创建连接
                                $conn = new mysqli($servername, $username, $password, $dbname);
                                // Check connection
                                if ($conn->connect_error) {
                                    die("连接失败: " . $conn->connect_error);
                                } 
                                 
                                $sql = "SELECT id, firstname, lastname FROM MyGuests";
                                $result = $conn->query($sql);
                                 
                                if ($result->num_rows > 0) {

                                    // 输出数据
                                    while($row = $result->fetch_assoc()) {
                                        echo "id: " . $row["id"]. " - Name: " . $row["firstname"]. " " . $row["lastname"]. "<br>";
                                    }
                                } else {
                                    echo "0 结果";
                                }
                                $conn->close();
                        ?>

        以上代码解析如下:

             首先，我们设置了 SQL 语句从 MyGuests数据表中读取 id, firstname 和 lastname 三个字段。之后我们使用改 SQL 语句从数据库中取出结果集并赋给复制给变量 $result。

             函数 num_rows() 判断返回的数据。

             如果返回的是多条数据，函数 fetch_assoc() 将结合集放入到关联数组并循环输出。 while() 循环出结果集，并输出 id, firstname 和 lastname 三个字段值。




         （2）、以下实例使用 MySQLi 面向过程的方式，效果类似以上代码:

                实例 (MySQLi - 面向过程)

                            <?php
                                    $servername = "localhost";
                                    $username = "username";
                                    $password = "password";
                                    $dbname = "myDB";
                                     
                                    // 创建连接
                                    $conn = mysqli_connect($servername, $username, $password, $dbname);

                                    // Check connection
                                    if (!$conn) {
                                        die("连接失败: " . mysqli_connect_error());
                                    }
                                     
                                    $sql = "SELECT id, firstname, lastname FROM MyGuests";
                                    $result = mysqli_query($conn, $sql);
                                     
                                    if (mysqli_num_rows($result) > 0) {

                                        // 输出数据
                                        while($row = mysqli_fetch_assoc($result)) {
                                            echo "id: " . $row["id"]. " - Name: " . $row["firstname"]. " " . $row["lastname"]. "<br>";
                                        }
                                    } else {
                                        echo "0 结果";
                                    }
                                     
                                    mysqli_close($conn);
                            ?>



         （2）、使用 PDO (+ 预处理)

                  以下实例使用了预处理语句。

                  选取了 MyGuests 表中的 id, firstname 和 lastname 字段，并放到 HTML 表格中：

                  实例 (PDO)：
                            <?php
                                    echo "<table style='border: solid 1px black;'>";
                                    echo "<tr><th>Id</th><th>Firstname</th><th>Lastname</th></tr>";
                                     
                                    class TableRows extends RecursiveIteratorIterator {
                                        function __construct($it) { 
                                            parent::__construct($it, self::LEAVES_ONLY); 
                                        }
                                     
                                        function current() {
                                            return "<td style='width:150px;border:1px solid black;'>" . parent::current(). "</td>";
                                        }
                                     
                                        function beginChildren() { 
                                            echo "<tr>"; 
                                        } 
                                     
                                        function endChildren() { 
                                            echo "</tr>" . "\n";
                                        } 
                                    } 
                                     
                                    $servername = "localhost";
                                    $username = "username";
                                    $password = "password";
                                    $dbname = "myDBPDO";
                                     
                                    try {
                                        $conn = new PDO("mysql:host=$servername;dbname=$dbname", $username, $password);
                                        $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
                                        $stmt = $conn->prepare("SELECT id, firstname, lastname FROM MyGuests"); 
                                        $stmt->execute();
                                     
                                        // 设置结果集为关联数组
                                        $result = $stmt->setFetchMode(PDO::FETCH_ASSOC); 
                                        foreach(new TableRows(new RecursiveArrayIterator($stmt->fetchAll())) as $k=>$v) { 
                                            echo $v;
                                        }
                                    }
                                    catch(PDOException $e) {
                                        echo "Error: " . $e->getMessage();
                                    }
                                    $conn = null;
                                    echo "</table>";
                            ?>



-------------------------------------------------------------------------------------------------------------------------------------------


四十八、PHP MySQL Where 子句

         WHERE 子句用于过滤记录。

         1、WHERE 子句

             WHERE 子句用于提取满足指定标准的的记录。

             语法：
                    SELECT column_name(s)
                             FROM table_name
                                       WHERE column_name operator value

             如需学习更多关于 SQL 的知识，请访问我们的 SQL 教程。

             为了让 PHP 执行上面的语句，我们必须使用 mysqli_query() 函数。该函数用于向 MySQL 连接发送查询或命令。

             实例：
             下面的实例将从 "Persons" 表中选取所有 FirstName='Peter' 的行：

                    <?php
                            $con=mysqli_connect("localhost","username","password","database");
                            // 检测连接
                            if (mysqli_connect_errno())
                            {
                                echo "连接失败: " . mysqli_connect_error();
                            }

                            $result = mysqli_query($con,"SELECT * FROM Persons
                            WHERE FirstName='Peter'");

                            while($row = mysqli_fetch_array($result))
                            {
                                echo $row['FirstName'] . " " . $row['LastName'];
                                echo "<br>";
                            }
                    ?>

                以上代码将输出：
                                Peter Griffin




-------------------------------------------------------------------------------------------------------------------------------------------


四十九、PHP MySQL Order By 关键词

      ORDER BY 关键词用于对记录集中的数据进行排序。

      1、ORDER BY 关键词

            ORDER BY 关键词用于对记录集中的数据进行排序。

            ORDER BY 关键词默认对记录进行升序排序。

            如果你想降序排序，请使用 DESC 关键字。

            语法：
                  SELECT column_name(s)
                              FROM table_name
                                        ORDER BY column_name(s) ASC|DESC

            实例：
                 下面的实例选取 "Persons" 表中存储的所有数据，并根据 "Age" 列对结果进行排序：

                             <?php
                                    $con=mysqli_connect("localhost","username","password","database");

                                    // 检测连接
                                    if (mysqli_connect_errno())
                                    {
                                        echo "连接失败: " . mysqli_connect_error();
                                    }

                                    $result = mysqli_query($con,"SELECT * FROM Persons ORDER BY age");

                                    while($row = mysqli_fetch_array($result))
                                    {
                                        echo $row['FirstName'];
                                        echo " " . $row['LastName'];
                                        echo " " . $row['Age'];
                                        echo "<br>";
                                     }

                                    mysqli_close($con);
                              ?>

                     以上结果将输出：
                                      Glenn Quagmire 33
                                      Peter Griffin 35



      2、根据两列进行排序

           可以根据多个列进行排序。当按照多个列进行排序时，只有第一列的值相同时才使用第二列：

                                 SELECT column_name(s)
                                              FROM table_name
                                                    ORDER BY column1, column2



-------------------------------------------------------------------------------------------------------------------------------------------


四十九、PHP MySQL Update

     UPDATE 语句用于中修改数据库表中的数据。

     1、更新数据库中的数据

          UPDATE 语句用于更新数据库表中已存在的记录。


     2、语法：
             UPDATE table_name
                      SET column1=value, column2=value2,...
                                         WHERE some_column=some_value


         注释：请注意 UPDATE 语法中的 WHERE 子句。WHERE 子句规定了哪些记录需要更新。如果您想省去 WHERE 子句，所有的记录都会被更新！

               如需学习更多关于 SQL 的知识，请访问我们的 SQL 教程。

               为了让 PHP 执行上面的语句，我们必须使用 mysqli_query() 函数。该函数用于向 MySQL 连接发送查询或命令。


         实例：

               在本教程的前面章节中，我们创建了一个名为 "Persons" 的表，如下所示：

                       FirstName	  LastName	     Age

                       Peter	          Griffin	     35

                       Glenn	          Quagmire	     33

               下面的例子更新 "Persons" 表的一些数据：

                            <?php
                                    $con=mysqli_connect("localhost","username","password","database");

                                    // 检测连接
                                    if (mysqli_connect_errno())
                                    {
                                        echo "连接失败: " . mysqli_connect_error();
                                    }

                                    mysqli_query($con,"UPDATE Persons SET Age=36
                                                                WHERE FirstName='Peter' AND LastName='Griffin'");

                                    mysqli_close($con);
                            ?>

               在这次更新后，"Persons" 表如下所示：

                          FirstName	         LastName	        Age

                            Peter	         Griffin	        36

                            Glenn	         Quagmire	        33



-------------------------------------------------------------------------------------------------------------------------------------------


四十九、PHP MySQL Delete

       DELETE 语句用于从数据库表中删除行。

       1、删除数据库中的数据

            DELETE FROM 语句用于从数据库表中删除记录。


       2、语法

            DELETE FROM table_name
                               WHERE some_column = some_value。


           注释：请注意 DELETE 语法中的 WHERE 子句。WHERE 子句规定了哪些记录需要删除。如果您想省去 WHERE 子句，所有的记录都会被删除！

                 如需学习更多关于 SQL 的知识，请访问我们的 SQL 教程。

                 为了让 PHP 执行上面的语句，我们必须使用 mysqli_query() 函数。该函数用于向 MySQL 连接发送查询或命令。


       3、实例：

            请看下面的 "Persons" 表：

                 FirstName	     LastName	        Age

                   Peter	      Griffin	        35

                   Glenn	      Quagmire	        33

            下面的实例删除 "Persons" 表中所有 LastName='Griffin' 的记录：

                            <?php
                                    $con=mysqli_connect("localhost","username","password","database");

                                    // 检测连接
                                    if (mysqli_connect_errno())
                                    {
                                        echo "连接失败: " . mysqli_connect_error();
                                     }

                                    mysqli_query($con,"DELETE FROM Persons WHERE LastName='Griffin'");

                                    mysqli_close($con);
                            ?>


            在这次删除后，"Persons" 表如下所示：

                       FirstName	   LastName	     Age

                         Glenn	           Quagmire	      33


-------------------------------------------------------------------------------------------------------------------------------------------


五十、PHP 数据库 ODBC

       开放数据库连接（Open Database Connectivity，ODBC）

       ODBC 是一种应用程序编程接口（Application Programming Interface，API），使我们有能力连接到某个数据源（比如一个 MS Access 数据库）。

       1、创建 ODBC 连接

            通过一个 ODBC 连接，您可以连接到您的网络中的任何计算机上的任何数据库，只要 ODBC 连接是可用的。

            这是创建到达 MS Access 数据库的 ODBC 连接的方法：

                                            ①、在控制面板中打开管理工具图标。
                                            ②、双击其中的数据源(ODBC)图标。
                                            ③、选择系统 DSN 选项卡。
                                            ④、点击系统 DSN 选项卡中的添加。
                                            ⑤、选择Microsoft Access Driver。点击完成。
                                            ⑥、在下一个界面，点击选择来定位数据库。
                                            ⑦、为数据库起一个数据源名(DSN)。
                                            ⑧、点击确定。

            请注意，必须在您的网站所在的计算机上完成这个配置。如果您的计算机上正在运行 Internet 信息服务(IIS)，上面的指令将会生效，但是如果您的网站位于远程服务器，您必须拥有对该服务器的物理访问权限，或者请您的主机提供商为您建立 DSN。



       2、连接到 ODBC

              odbc_connect() 函数用于连接到 ODBC 数据源。该函数有四个参数：数据源名、用户名、密码以及可选的指针类型。

              odbc_exec() 函数用于执行 SQL 语句。

              实例：
              下面的实例创建了到达名为 northwind 的 DSN 的连接，没有用户名和密码。然后创建并执行一条 SQL 语句：

                                          $conn=odbc_connect('northwind','','');

                                          $sql= "SELECT * FROM customers";

                                          $rs= odbc_exec($conn,$sql);


       3、取回记录

              odbc_fetch_row() 函数用于从结果集中返回记录。如果能够返回行，则函数返回 true，否则返回 false。

              该函数有两个参数：ODBC 结果标识符和可选的行号：

                                                       odbc_fetch_row($rs)


       4、从记录中取回字段

              odbc_result() 函数用于从记录中读取字段。该函数有两个参数：ODBC 结果标识符和字段编号或名称。

              下面的代码行从记录中返回第一个字段的值：

                                          $compname=odbc_result($rs,1);


              下面的代码行返回名为 "CompanyName" 的字段的值：

                                          $compname=odbc_result($rs,"CompanyName");


       5、关闭 ODBC 连接

              odbc_close() 函数用于关闭 ODBC 连接。

                                          odbc_close($conn);


       6、ODBC 实例

              下面的实例展示了如何首先创建一个数据库连接，接着创建一个结果集，然后在 HTML 表格中显示数据。

                                <html>
                                <body>

                                <?php
                                        $conn=odbc_connect('northwind','','');
                                        if (!$conn)
                                        {
                                            exit("连接失败: " . $conn);
                                        }

                                        $sql="SELECT * FROM customers";
                                        $rs=odbc_exec($conn,$sql);

                                        if (!$rs)
                                        {
                                            exit("SQL 语句错误");
                                        }
                                        echo "<table><tr>";
                                        echo "<th>Companyname</th>";
                                        echo "<th>Contactname</th></tr>";

                                        while (odbc_fetch_row($rs))
                                        {
                                            $compname=odbc_result($rs,"CompanyName");
                                            $conname=odbc_result($rs,"ContactName");
                                            echo "<tr><td>$compname</td>";
                                            echo "<td>$conname</td></tr>";
                                        }
                                        odbc_close($conn);
                                        echo "</table>";
                                 ?>

                                </body>
                                </html>


-------------------------------------------------------------------------------------------------------------------------------------------


五十、PHP XML Expat 解析器

       内建的 Expat 解析器使在 PHP 中处理 XML 文档成为可能。

       1、XML 是什么？

              XML 用于描述数据，其焦点是数据是什么。XML 文件描述了数据的结构。

              在 XML 中，没有预定义的标签。您必须定义自己的标签。

              如需学习更多关于 XML 的知识，请访问我们的 XML 教程。


       2、Expat 是什么？

              如需读取和更新 - 创建和处理 - 一个 XML 文档，您需要 XML 解析器。

              有两种基本的 XML 解析器类型：

                  基于树的解析器：这种解析器把 XML 文档转换为树型结构。它分析整篇文档，并提供了对树中元素的访问，例如文档对象模型 (DOM)。

                  基于事件的解析器：将 XML 文档视为一系列的事件。当某个具体的事件发生时，解析器会调用函数来处理。


              Expat 解析器是基于事件的解析器。

                  基于事件的解析器集中在 XML 文档的内容，而不是它们的结构。正因为如此，基于事件的解析器能够比基于树的解析器更快地访问数据。


              请看下面的 XML 片段：
                                      <from>Jani</from>

              基于事件的解析器把上面的 XML 报告为一连串的三个事件：

                                                        开始元素：from

                                                        开始 CDATA 部分，值：Jani

                                                        关闭元素：from


               上面的 XML 实例包含了形式良好的 XML。不过这个实例是无效的 XML，因为没有与它关联的文档类型声明 (DTD)。

               然而，在使用 Expat 解析器时，这没有区别。Expat 是不检查有效性的解析器，忽略任何 DTD。

               作为一款基于事件、非验证的 XML 解析器，Expat 快速且轻巧，十分适合 PHP 的 Web 应用程序。

               注释：XML 文档必须形式良好，否则 Expat 会生成错误。


       3、安装

            XML Expat 解析器函数是 PHP 核心的组成部分。无需安装就可以使用这些函数。


       4、XML 文件

            下面的 XML 文件将应用在我们的实例中：

                                <?xml version="1.0" encoding="ISO-8859-1"?>
                                <note>
                                <to>Tove</to>
                                <from>Jani</from>
                                <heading>Reminder</heading>
                                <body>Don't forget me this weekend!</body>
                                </note>


       5、初始化 XML 解析器

            我们要在 PHP 中初始化 XML 解析器，为不同的 XML 事件定义处理器，然后解析这个 XML 文件。




-------------------------------------------------------------------------------------------------------------------------------------------

五十一、PHP XML Parser 函数

       PHP XML Parser 简介

          XML 函数允许您解析 XML 文档，但无法对其进行验证。

          XML 是一种用于标准结构化文档交换的数据格式。您可以在我们的 XML 教程 中找到更多有关 XML 的信息。

          该扩展使用 Expat XML 解析器。

          Expat 是一种基于事件的解析器，它把 XML 文档视为一系列事件。当某个事件发生时，它调用一个指定的函数处理它。

          Expat 是无验证的解析器，忽略任何链接到文档的 DTD。但是，如果文档的形式不好，则会以一个错误消息结束。

          由于它是一种基于事件，且无验证的解析器，Expat 具有快速并适合 Web 应用程序的特性。

          XML 解析器函数允许您创建 XML 解析器，并为 XML 事件定义句柄。


    1、安装

         XML Parser 函数是 PHP 核心的组成部分。无需安装即可使用这些函数。

    2、PHP XML Parser 函数

         PHP：指示支持该函数的最早的 PHP 版本。

                   实例
                         <?php
                                //Initialize the XML parser
                                $parser=xml_parser_create();

                                //Function to use at the start of an element
                                function start($parser,$element_name,$element_attrs)
                                {
                                switch($element_name)
                                {
                                    case "NOTE":
                                        echo "-- Note --<br>";
                                        break;
                                    case "TO":
                                        echo "To: ";
                                        break;
                                    case "FROM":
                                        echo "From: ";
                                        break;
                                    case "HEADING":
                                        echo "Heading: ";
                                        break;
                                    case "BODY":
                                        echo "Message: ";
                                }
                                }

                                //Function to use at the end of an element
                                function stop($parser,$element_name)
                                {
                                echo "<br>";
                                }

                                //Function to use when finding character data
                                function char($parser,$data)
                                {
                                echo $data;
                                }

                                //Specify element handler
                                xml_set_element_handler($parser,"start","stop");

                                //Specify data handler
                                xml_set_character_data_handler($parser,"char");

                                //Open XML file
                                $fp=fopen("test.xml","r");

                                //Read data
                                while ($data=fread($fp,4096))
                                {
                                xml_parse($parser,$data,feof($fp)) or 
                                die (sprintf("XML Error: %s at line %d", 
                                          xml_error_string(xml_get_error_code($parser)),xml_get_current_line_number($parser)));
                                }

                                //Free the XML parser
                                xml_parser_free($parser);
                          ?>

                        以上代码将输出：

                                -- Note --
                                To: Tove
                                From: Jani
                                Heading: Reminder
                                Message: Don't forget me this weekend!


                      工作原理：
                                 ①、通过 xml_parser_create() 函数初始化 XML 解析器

                                 ②、创建配合不同事件处理程序的的函数

                                 ③、添加 xml_set_element_handler() 函数来定义，当解析器遇到开始和结束标签时执行哪个函数

                                 ④、添加 xml_set_character_data_handler() 函数来定义，当解析器遇到字符数据时执行哪个函数

                                 ⑤、通过 xml_parse() 函数来解析文件 "test.xml"

                                 ⑥、万一有错误的话，添加 xml_error_string() 函数把 XML 错误转换为文本说明

                                 ⑦、调用 xml_parser_free() 函数来释放分配给 xml_parser_create() 函数的内存


             更多 PHP Expat 解析器的信息：http://www.runoob.com/php/php-ref-xml.html


-------------------------------------------------------------------------------------------------------------------------------------------

五十二、PHP XML DOM

       内建的 DOM 解析器使在 PHP 中处理 XML 文档成为可能。

       1、DOM 是什么？

           W3C DOM 提供了针对 HTML 和 XML 文档的标准对象集，以及用于访问和操作这些文档的标准接口。

           W3C DOM 被分为不同的部分（Core, XML 和 HTML）和不同的级别（DOM Level 1/2/3）：

                                 * Core DOM - 为任何结构化文档定义标准的对象集

                                 * XML DOM - 为 XML 文档定义标准的对象集

                                 * HTML DOM - 为 HTML 文档定义标准的对象集

           如需学习更多关于 XML DOM 的知识，请访问我们的 XML DOM 教程：http://www.runoob.com/php/php-xml-dom.html#


       2、XML 解析

           如需读取和更新 - 创建和处理 - 一个 XML 文档，您需要 XML 解析器。

           有两种基本的 XML 解析器类型：

                  基于树的解析器：这种解析器把 XML 文档转换为树型结构。它分析整篇文档，并提供了对树中元素的访问，例如文档对象模型 (DOM)。

                  基于事件的解析器：将 XML 文档视为一系列的事件。当某个具体的事件发生时，解析器会调用函数来处理。

           DOM 解析器是基于树的解析器。

              请看下面的 XML 文档片段：

                    <?xml version="1.0" encoding="ISO-8859-1"?>
                    <from>Jani</from>

              XML DOM 把上面的 XML 视为一个树形结构：

                                         Level 1: XML 文档

                                         Level 2: 根元素： <from>

                                         Level 3: 文本元素： "Jani"


       3、安装

           DOM XML 解析器函数是 PHP 核心的组成部分。无需安装就可以使用这些函数。


       4、XML 文件

           下面的 XML 文件将应用在我们的实例中：

                                    <?xml version="1.0" encoding="ISO-8859-1"?>
                                    <note>
                                    <to>Tove</to>
                                    <from>Jani</from>
                                    <heading>Reminder</heading>
                                    <body>Don't forget me this weekend!</body>
                                    </note>


       5、加载和输出 XML

             我们需要初始化 XML 解析器，加载 XML，并把它输出：

                        实例：
                                <?php
                                      $xmlDoc = new DOMDocument();
                                      $xmlDoc->load("note.xml");

                                      print $xmlDoc->saveXML();
                                ?>

             以上代码将输出：    ToveJaniReminder Don't forget me this weekend!


             如果您在浏览器窗口中查看源代码，会看到下面的 HTML：

                            <?xml version="1.0" encoding="ISO-8859-1"?>
                            <note>
                            <to>Tove</to>
                            <from>Jani</from>
                            <heading>Reminder</heading>
                            <body>Don't forget me this weekend!</body>
                            </note>

             上面的实例创建了一个 DOMDocument-Object，并把 "note.xml" 中的 XML 载入这个文档对象中。

             saveXML() 函数把内部 XML 文档放入一个字符串，这样我们就可以输出它。


       6、遍历 XML

             我们要初始化 XML 解析器，加载 XML，并遍历 <note> 元素的所有元素：

                 实例：
                        <?php
                                $xmlDoc = new DOMDocument();
                                $xmlDoc->load("note.xml");

                                $x = $xmlDoc->documentElement;
                                foreach ($x->childNodes AS $item)
                                {
                                   print $item->nodeName . " = " . $item->nodeValue . "<br>";
                                }
                        ?>

               以上代码将输出：

                            #text = 
                            to = Tove
                            #text = 
                            from = Jani
                            #text = 
                            heading = Reminder
                            #text = 
                            body = Don't forget me this weekend!
                            #text =

               在上面的实例中，您看到了每个元素之间存在空的文本节点。

               当 XML 生成时，它通常会在节点之间包含空白。XML DOM 解析器把它们当作普通的元素，如果您不注意它们，有时会产生问题。

               如需学习更多关于 XML DOM 的知识，请访问我们的 XML DOM 教程。http://www.runoob.com/php/php-xml-dom.html#



-------------------------------------------------------------------------------------------------------------------------------------------

五十三、PHP SimpleXML

        PHP SimpleXML 处理最普通的 XML 任务，其余的任务则交由其它扩展处理。
 
        1、什么是 PHP SimpleXML？

               SimpleXML 是 PHP 5 中的新特性。

               SimpleXML 扩展提供了一种获取 XML 元素的名称和文本的简单方式。

               与 DOM 或 Expat 解析器相比，SimpleXML 仅仅用几行代码就可以从 XML 元素中读取文本数据。


            SimpleXML 可把 XML 文档（或 XML 字符串）转换为对象，比如：

                     ①、元素被转换为 SimpleXMLElement 对象的单一属性。当同一级别上存在多个元素时，它们会被置于数组中。

                     ②、属性通过使用关联数组进行访问，其中的索引对应属性名称。

                     ③、元素内部的文本被转换为字符串。如果一个元素拥有多个文本节点，则按照它们被找到的顺序进行排列。


            当执行类似下列的基础任务时，SimpleXML 使用起来非常快捷：

                     ①、读取/提取 XML 文件/字符串的数据

                     ②、编辑文本节点或属性

            然而，在处理高级 XML 时，比如命名空间，最好使用 Expat 解析器或 XML DOM。


        2、安装

            从 PHP 5 开始，SimpleXML 函数是 PHP 核心的组成部分。无需安装就可以使用这些函数。


        3、PHP SimpleXML 实例

            假设我们有如下的 XML 文件，"note.xml"：

                            <?xml version="1.0" encoding="ISO-8859-1"?>
                            <note>
                            <to>Tove</to>
                                <from>Jani</from>
                                <heading>Reminder</heading>
                                <body>Don't forget me this weekend!</body>
                            </note>


            现在我们想要输出上面的 XML 文件的不同信息：

           （1）、实例 1
                  输出 $xml 变量（是 SimpleXMLElement 对象）的键和元素：

                        <?php
                              $xml=simplexml_load_file("note.xml");
                              print_r($xml);
                        ?>

              以上代码将输出：

                SimpleXMLElement Object ( [to] => Tove [from] => Jani [heading] => Reminder [body] => Don't forget me this weekend! )



           （2）、实例 2
                  输出 XML 文件中每个元素的数据：

                            <?php
                                    $xml=simplexml_load_file("note.xml");
                                    echo $xml->to . "<br>";
                                    echo $xml->from . "<br>";
                                    echo $xml->heading . "<br>";
                                    echo $xml->body;
                            ?>

                        以上代码将输出：
                                        Tove
                                        Jani
                                        Reminder
                                        Don't forget me this weekend!


           （3）、实例 3
                  输出每个子节点的元素名称和数据：

                             <?php
                                    $xml=simplexml_load_file("note.xml");
                                    echo $xml->getName() . "<br>";
                                    
                                    foreach($xml->children() as $child)
                                    {
                                        echo $child->getName() . ": " . $child . "<br>";
                                    }
                             ?>

                    以上代码将输出：
                                     note
                                     to: Tove
                                     from: Jani
                                     heading: Reminder
                                     body: Don't forget me this weekend!


                    更多 PHP SimpleXML 的信息：

                         如需了解更多关于 PHP SimpleXML 函数的信息，请访问我们的 PHP SimpleXML 参考手册。



-------------------------------------------------------------------------------------------------------------------------------------------


五十四、AJAX 简介

        1、AJAX 是一种在无需重新加载整个网页的情况下，能够更新部分网页的技术。

        2、AJAX 是什么？

             AJAX = Asynchronous JavaScript and XML.

             AJAX 是一种用于创建快速动态网页的技术。

             AJAX 通过在后台与服务器进行少量数据交换，使网页实现异步更新。这意味着可以在不重载整个页面的情况下，对网页的某些部分进行更新。

             传统的网页（不使用 AJAX）如果需要更新内容，必须重载整个页面。

             有很多使用 AJAX 的应用程序案例：Google Maps、Gmail、Youtube 和 Facebook。


        3、AJAX 如何工作


        4、AJAX 基于因特网标准

               AJAX 基于因特网标准，并使用以下技术组合：

                            XMLHttpRequest 对象（与服务器异步交互数据）

                            JavaScript/DOM（显示/取回信息）
                            
                            CSS（设置数据的样式）

                            XML（常用作数据传输的格式）

           注意： AJAX 应用程序与浏览器和平台无关的！


        5、谷歌搜索建议（Google Suggest）

              随着谷歌搜索建议功能在 2005 的发布，AJAX 开始流行起来。

              谷歌搜索建议（Google Suggest） 使用 AJAX 创造出动态性极强的 web 界面：当您在谷歌的搜索框中键入内容时，JavaScript 会把字符发送到服务器，服务器则会返回建议列表。


        6、今天就开始使用 AJAX

              在我们的 PHP 教程中，我们将演示 AJAX 如何在不重载整个页面的情况下对网页的某些部分进行更新。服务器脚本我们将采用 PHP 来编写。

如果您想要学习更多关于 AJAX 的知识，请访问我们的 AJAX 教程：http://www.runoob.com/ajax/ajax-tutorial.html



-------------------------------------------------------------------------------------------------------------------------------------------


五十五、PHP - AJAX 与 PHP

       AJAX 被用于创建交互性更强的应用程序。

       1、AJAX PHP 实例

           下面的实例将演示当用户在输入框中键入字符时，网页如何与 Web 服务器进行通信：

                   例子地址：  http://www.runoob.com/php/php-ajax-php.html


       2、当用户在上面的输入框中键入字符时，会执行 "showHint()" 函数。该函数由 "onkeyup" 事件触发：

                <html>
                <head>
                <script>
                        function showHint(str)
                        {
                            if (str.length==0)
                            { 
                                document.getElementById("txtHint").innerHTML="";
                                return;
                            }
                            if (window.XMLHttpRequest)
                            {
                                // IE7+, Firefox, Chrome, Opera, Safari 浏览器执行的代码
                                xmlhttp=new XMLHttpRequest();
                            }
                            else
                            {    
                                //IE6, IE5 浏览器执行的代码
                                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                            }
                            xmlhttp.onreadystatechange=function();
                            {
                                if (xmlhttp.readyState==4 && xmlhttp.status==200)
                                {
                                    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
                                }
                            }
                            xmlhttp.open("GET","gethint.php?q="+str,true);
                            xmlhttp.send();
                        }
                </script>
                </head>
                <body>

                <p><b>在输入框中输入一个姓名:</b></p>
                <form> 
                姓名: <input type="text" onkeyup="showHint(this.value)">
                </form>
                <p>返回值: <span id="txtHint"></span></p>

                </body>
                </html>

                源代码解释：

                        如果输入框是空的（str.length==0），该函数会清空 txtHint 占位符的内容，并退出该函数。

                        如果输入框不是空的，那么 showHint() 会执行以下步骤：

                                                   ①、创建 XMLHttpRequest 对象

                                                   ②、创建在服务器响应就绪时执行的函数

                                                   ③、向服务器上的文件发送请求

                                                   ④、请注意添加到 URL 末端的参数（q）（包含输入框的内容）


       3、PHP 文件

           上面这段通过 JavaScript 调用的服务器页面是名为 "gethint.php" 的 PHP 文件。

           "gethint.php" 中的源代码会检查姓名数组，然后向浏览器返回对应的姓名：

                    <?php
                        // 将姓名填充到数组中
                        $a[]="Anna";
                        $a[]="Brittany";
                        $a[]="Cinderella";
                        $a[]="Diana";
                        $a[]="Eva";
                        $a[]="Fiona";
                        $a[]="Gunda";
                        $a[]="Hege";
                        $a[]="Inga";
                        $a[]="Johanna";
                        $a[]="Kitty";
                        $a[]="Linda";
                        $a[]="Nina";
                        $a[]="Ophelia";
                        $a[]="Petunia";
                        $a[]="Amanda";
                        $a[]="Raquel";
                        $a[]="Cindy";
                        $a[]="Doris";
                        $a[]="Eve";
                        $a[]="Evita";
                        $a[]="Sunniva";
                        $a[]="Tove";
                        $a[]="Unni";
                        $a[]="Violet";
                        $a[]="Liza";
                        $a[]="Elizabeth";
                        $a[]="Ellen";
                        $a[]="Wenche";
                        $a[]="Vicky";

                        //从请求URL地址中获取 q 参数
                        $q=$_GET["q"];

                        //查找是否由匹配值， 如果 q>0
                        if (strlen($q) > 0)
                        {
                            $hint="";
                            for($i=0; $i<count($a); $i++)
                            {
                                if (strtolower($q)==strtolower(substr($a[$i],0,strlen($q))))
                                {
                                    if ($hint=="")
                                    {
                                        $hint=$a[$i];
                                    }
                                    else
                                    {
                                        $hint=$hint." , ".$a[$i];
                                    }
                                }
                            }
                        }

                        // 如果没有匹配值设置输出为 "no suggestion" 
                        if ($hint == "")
                        {
                            $response="no suggestion";
                        }
                        else
                        {
                            $response=$hint;
                        }

                           //输出返回值
                            echo $response;
                    ?>

            解释：如果 JavaScript 发送了任何文本（即 strlen($q) > 0），则会发生：

                                                ①、查找匹配 JavaScript 发送的字符的姓名

                                                ②、如果未找到匹配，则将响应字符串设置为 "no suggestion"

                                                ③、如果找到一个或多个匹配姓名，则用所有姓名设置响应字符串

                                                ④、把响应发送到 "txtHint" 占位符 


       4、PHP Ajax 跨域问题解决方案：

            如果你的异步请求需要跨域可以查看：PHP Ajax 跨域问题解决方案：http://www.runoob.com/w3cnote/php-ajax-cross-border.html
  

-------------------------------------------------------------------------------------------------------------------------------------------


五十六、PHP - AJAX 与 MySQL
  
        AJAX 可用来与数据库进行交互式通信。

        1、AJAX 数据库实例

            下面的实例将演示网页如何通过 AJAX 从数据库读取信息：

            本教程使用到的 Websites 表 SQL 文件：websites.sql。

                DROP TABLE IF EXISTS `websites`;

                CREATE TABLE `websites` (

                   `id` int(11) NOT NULL AUTO_INCREMENT,
                  
                   `name` char(20) NOT NULL DEFAULT '' COMMENT '站点名称',
                     
                   `url` varchar(255) NOT NULL DEFAULT '',

                   `alexa` int(11) NOT NULL DEFAULT '0' COMMENT 'Alexa 排名',
                 
                   `country` char(10) NOT NULL DEFAULT '' COMMENT '国家',

                    PRIMARY KEY (`id`)
                )

                ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;

                NSERT INTO `websites` VALUES ('1', 'Google', 'https://www.google.cm/', '1', 'USA'),

                                               ('2', '淘宝', 'https://www.taobao.com/', '13', 'CN'), 

                                                  ('3', '菜鸟教程', 'http://www.runoob.com/', '4689', 'CN'),

                                                     ('4', '微博', 'http://weibo.com/', '20', 'CN'),

                                                        ('5', 'Facebook', 'https://www.facebook.com/', '3', 'USA');

                COMMIT;

                SET FOREIGN_KEY_CHECKS = 1;



        2、实例解释 - MySQL 数据库

             在上面的实例中，我们使用的数据库表如下所示：

                        mysql> select * from websites;
                        +----+--------------+---------------------------+-------+---------+
                        | id | name         | url                       | alexa | country |
                        +----+--------------+---------------------------+-------+---------+
                        | 1  | Google       | https://www.google.cm/    | 1     | USA     |
                        | 2  | 淘宝       | https://www.taobao.com/   | 13    | CN      |
                        | 3  | 菜鸟教程 | http://www.runoob.com/    | 4689  | CN      |
                        | 4  | 微博       | http://weibo.com/         | 20    | CN      |
                        | 5  | Facebook     | https://www.facebook.com/ | 3     | USA     |
                        +----+--------------+---------------------------+-------+---------+
                        5 rows in set (0.01 sec)



        3、实例解释 - HTML 页面

             当用户在上面的下拉列表中选择某位用户时，会执行名为 "showSite()" 的函数。该函数由 "onchange" 事件触发：

              test.html 文件代码:
                                <!DOCTYPE html> 
                                <html> 
                                <head> 
                                <meta charset="utf-8"> 
                                <title>菜鸟教程(runoob.com)</title> 
                                <script>
                                function showSite(str)
                                {
                                    if (str=="")
                                    {
                                        document.getElementById("txtHint").innerHTML="";
                                        return;
                                    } 
                                    if (window.XMLHttpRequest)
                                    {
                                        // IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
                                        xmlhttp=new XMLHttpRequest();
                                    }
                                    else
                                    {
                                        // IE6, IE5 浏览器执行代码
                                        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                                    }
                                    xmlhttp.onreadystatechange=function()
                                    {
                                        if (xmlhttp.readyState==4 && xmlhttp.status==200)
                                        {
                                            document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
                                        }
                                    }
                                    xmlhttp.open("GET","getsite_mysql.php?q="+str,true);
                                    xmlhttp.send();
                                }
                                </script>
                                </head>
                                <body>
                                 
                                <form>
                                <select name="users" onchange="showSite(this.value)">
                                <option value="">选择一个网站:</option>
                                <option value="1">Google</option>
                                <option value="2">淘宝</option>
                                <option value="3">菜鸟教程</option>
                                <option value="4">微博</option>
                                <option value="5">Facebook</option>
                                </select>
                                </form>
                                <br>
                                <div id="txtHint"><b>网站信息显示在这里……</b></div>
                                 
                                </body>
                                </html>

                    showSite() 函数会执行以下步骤：

                                ①、检查是否有网站被选择
                                ②、创建 XMLHttpRequest 对象
                                ③、创建在服务器响应就绪时执行的函数
                                ④、向服务器上的文件发送请求
                                ⑤、请注意添加到 URL 末端的参数（q）（包含下拉列表的内容）


        4、PHP 文件

            上面这段通过 JavaScript 调用的服务器页面是名为 "getsite_mysql.php" 的 PHP 文件。

            "getsite_mysql.php" 中的源代码会运行一次针对 MySQL 数据库的查询，然后在 HTML 表格中返回结果：

             getsite_mysql.php 文件代码:

                        <?php
                                $q = isset($_GET["q"]) ? intval($_GET["q"]) : '';

                                if(empty($q)) {
                                    echo '请选择一个网站';
                                    exit;
                                }

                                $con = mysqli_connect('localhost','root','123456');
                                if (!$con)
                                {
                                    die('Could not connect: ' . mysqli_error($con));
                                }
                                // 选择数据库
                                mysqli_select_db($con,"test");
                                // 设置编码，防止中文乱码
                                mysqli_set_charset($con, "utf8");

                                $sql="SELECT * FROM Websites WHERE id = '".$q."'";
                                 
                                $result = mysqli_query($con,$sql);
                                 
                                echo "<table border='1'>
                                <tr>
                                <th>ID</th>
                                <th>网站名</th>
                                <th>网站 URL</th>
                                <th>Alexa 排名</th>
                                <th>国家</th>
                                </tr>";
                                 
                                while($row = mysqli_fetch_array($result))
                                {
                                    echo "<tr>";
                                    echo "<td>" . $row['id'] . "</td>";
                                    echo "<td>" . $row['name'] . "</td>";
                                    echo "<td>" . $row['url'] . "</td>";
                                    echo "<td>" . $row['alexa'] . "</td>";
                                    echo "<td>" . $row['country'] . "</td>";
                                    echo "</tr>";
                                }
                                echo "</table>";
                                 
                                mysqli_close($con);
                        ?>

                解释：当查询从 JavaScript 发送到 PHP 文件时，将发生：

                                ①、PHP 打开一个到 MySQL 数据库的连接
                                ②、找到选中的用户
                                ③、创建 HTML 表格，填充数据，并发送回 "txtHint" 占位符


-------------------------------------------------------------------------------------------------------------------------------------------


五十七、PHP 实例 - AJAX 与 XML

       AJAX 可用来与 XML 文件进行交互式通信。

       1、AJAX XML 实例

           下面的实例将演示网页如何通过 AJAX 从 XML 文件读取信息：


       2、实例解释 - HTML 页面

           当用户在上面的下拉列表中选择某张 CD 时，会执行名为 "showCD()" 的函数。该函数由 "onchange" 事件触发：

                        <html>
                        <head>
                        <script>
                        function showCD(str)
                        {
                            if (str=="")
                            {
                                document.getElementById("txtHint").innerHTML="";
                                return;
                            } 
                            if (window.XMLHttpRequest)
                            {
                                // IE7+, Firefox, Chrome, Opera, Safari 浏览器执行
                                xmlhttp=new XMLHttpRequest();
                            }
                            else
                            {
                                // IE6, IE5 浏览器执行
                                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                            }
                            xmlhttp.onreadystatechange=function()
                            {
                                if (xmlhttp.readyState==4 && xmlhttp.status==200)
                                {
                                    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
                                }
                            }
                            xmlhttp.open("GET","getcd.php?q="+str,true);
                            xmlhttp.send();
                        }
                        </script>
                        </head>
                        <body>

                        <form>
                        Select a CD:
                        <select name="cds" onchange="showCD(this.value)">
                        <option value="">Select a CD:</option>
                        <option value="Bob Dylan">Bob Dylan</option>
                        <option value="Bonnie Tyler">Bonnie Tyler</option>
                        <option value="Dolly Parton">Dolly Parton</option>
                        </select>
                        </form>
                        <div id="txtHint"><b>CD info will be listed here...</b></div>

                        </body>
                        </html>


                    showCD() 函数会执行以下步骤：

                                ①、检查是否有 CD 被选择
                                ②、创建 XMLHttpRequest 对象
                                ③、创建在服务器响应就绪时执行的函数
                                ④、向服务器上的文件发送请求
                                ⑤、请注意添加到 URL 末端的参数（q）（包含下拉列表的内容）


       3、PHP 文件

            上面这段通过 JavaScript 调用的服务器页面是名为 "getcd.php" 的 PHP 文件。

            PHP 脚本加载 XML 文档，"cd_catalog.xml"，运行针对 XML 文件的查询，并以 HTML 返回结果：

                                <?php
                                        $q=$_GET["q"];

                                        $xmlDoc = new DOMDocument();
                                        $xmlDoc->load("cd_catalog.xml");

                                        $x=$xmlDoc->getElementsByTagName('ARTIST');

                                        for ($i=0; $i<=$x->length-1; $i++)
                                        {
                                            // 处理元素节点
                                            if ($x->item($i)->nodeType==1)
                                            {
                                                if ($x->item($i)->childNodes->item(0)->nodeValue == $q)
                                                {
                                                    $y=($x->item($i)->parentNode);
                                                }
                                            }
                                        }

                                        $cd=($y->childNodes);

                                        for ($i=0;$i<$cd->length;$i++)
                                        { 
                                            // 处理元素节点
                                            if ($cd->item($i)->nodeType==1)
                                            {
                                                echo("<b>" . $cd->item($i)->nodeName . ":</b> ");
                                                echo($cd->item($i)->childNodes->item(0)->nodeValue);
                                                echo("<br>");
                                            }
                                        }
                                ?>

            当 CD 查询从 JavaScript 发送到 PHP 页面时，将发生：

                        ①、PHP 创建 XML DOM 对象

                        ②、查找所有 <artist> 元素中与 JavaScript 所传数据相匹配的名字

                        ③、输出 album 的信息，并发送回 "txtHint" 占位符


            cd_catalog.xml文件内容：

                        <CATALOG>
                        <CD>
                            <TITLE>Empire Burlesque</TITLE>
                            <ARTIST>Bob Dylan</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>Columbia</COMPANY>
                            <PRICE>10.90</PRICE>
                            <YEAR>1985</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Hide your heart</TITLE>
                            <ARTIST>Bonnie Tyler</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>CBS Records</COMPANY>
                            <PRICE>9.90</PRICE>
                            <YEAR>1988</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Greatest Hits</TITLE>
                            <ARTIST>Dolly Parton</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>RCA</COMPANY>
                            <PRICE>9.90</PRICE>
                            <YEAR>1982</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Still got the blues</TITLE>
                            <ARTIST>Gary Moore</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Virgin records</COMPANY>
                            <PRICE>10.20</PRICE>
                            <YEAR>1990</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Eros</TITLE>
                            <ARTIST>Eros Ramazzotti</ARTIST>
                            <COUNTRY>EU</COUNTRY>
                            <COMPANY>BMG</COMPANY>
                            <PRICE>9.90</PRICE>
                            <YEAR>1997</YEAR>
                        </CD>
                        <CD>
                            <TITLE>One night only</TITLE>
                            <ARTIST>Bee Gees</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Polydor</COMPANY>
                            <PRICE>10.90</PRICE>
                            <YEAR>1998</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Sylvias Mother</TITLE>
                            <ARTIST>Dr.Hook</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>CBS</COMPANY>
                            <PRICE>8.10</PRICE>
                            <YEAR>1973</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Maggie May</TITLE>
                            <ARTIST>Rod Stewart</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Pickwick</COMPANY>
                            <PRICE>8.50</PRICE>
                            <YEAR>1990</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Romanza</TITLE>
                            <ARTIST>Andrea Bocelli</ARTIST>
                            <COUNTRY>EU</COUNTRY>
                            <COMPANY>Polydor</COMPANY>
                            <PRICE>10.80</PRICE>
                            <YEAR>1996</YEAR>
                        </CD>
                        <CD>
                            <TITLE>When a man loves a woman</TITLE>
                            <ARTIST>Percy Sledge</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>Atlantic</COMPANY>
                            <PRICE>8.70</PRICE>
                            <YEAR>1987</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Black angel</TITLE>
                            <ARTIST>Savage Rose</ARTIST>
                            <COUNTRY>EU</COUNTRY>
                            <COMPANY>Mega</COMPANY>
                            <PRICE>10.90</PRICE>
                            <YEAR>1995</YEAR>
                        </CD>
                        <CD>
                            <TITLE>1999 Grammy Nominees</TITLE>
                            <ARTIST>Many</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>Grammy</COMPANY>
                            <PRICE>10.20</PRICE>
                            <YEAR>1999</YEAR>
                        </CD>
                        <CD>
                            <TITLE>For the good times</TITLE>
                            <ARTIST>Kenny Rogers</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Mucik Master</COMPANY>
                            <PRICE>8.70</PRICE>
                            <YEAR>1995</YEAR>
                            </CD>
                        <CD>
                            <TITLE>Big Willie style</TITLE>
                            <ARTIST>Will Smith</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>Columbia</COMPANY>
                            <PRICE>9.90</PRICE>
                            <YEAR>1997</YEAR>
                            </CD>
                        <CD>
                            <TITLE>Tupelo Honey</TITLE>
                            <ARTIST>Van Morrison</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Polydor</COMPANY>
                            <PRICE>8.20</PRICE>
                            <YEAR>1971</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Soulsville</TITLE>
                            <ARTIST>Jorn Hoel</ARTIST>
                            <COUNTRY>Norway</COUNTRY>
                            <COMPANY>WEA</COMPANY>
                            <PRICE>7.90</PRICE>
                            <YEAR>1996</YEAR>
                        </CD>
                        <CD>
                            <TITLE>The very best of</TITLE>
                            <ARTIST>Cat Stevens</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Island</COMPANY>
                            <PRICE>8.90</PRICE>
                            <YEAR>1990</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Stop</TITLE>
                            <ARTIST>Sam Brown</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>A and M</COMPANY>
                            <PRICE>8.90</PRICE>
                            <YEAR>1988</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Bridge of Spies</TITLE>
                            <ARTIST>T'Pau</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Siren</COMPANY>
                            <PRICE>7.90</PRICE>
                            <YEAR>1987</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Private Dancer</TITLE>
                            <ARTIST>Tina Turner</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>Capitol</COMPANY>
                            <PRICE>8.90</PRICE>
                            <YEAR>1983</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Midt om natten</TITLE>
                            <ARTIST>Kim Larsen</ARTIST>
                            <COUNTRY>EU</COUNTRY>
                            <COMPANY>Medley</COMPANY>
                            <PRICE>7.80</PRICE>
                            <YEAR>1983</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Pavarotti Gala Concert</TITLE>
                            <ARTIST>Luciano Pavarotti</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>DECCA</COMPANY>
                            <PRICE>9.90</PRICE>
                            <YEAR>1991</YEAR>
                        </CD>
                        <CD>
                            <TITLE>The dock of the bay</TITLE>
                            <ARTIST>Otis Redding</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>Atlantic</COMPANY>
                            <PRICE>7.90</PRICE>
                            <YEAR>1987</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Picture book</TITLE>
                            <ARTIST>Simply Red</ARTIST>
                            <COUNTRY>EU</COUNTRY>
                            <COMPANY>Elektra</COMPANY>
                            <PRICE>7.20</PRICE>
                            <YEAR>1985</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Red</TITLE>
                            <ARTIST>The Communards</ARTIST>
                            <COUNTRY>UK</COUNTRY>
                            <COMPANY>London</COMPANY>
                            <PRICE>7.80</PRICE>
                            <YEAR>1987</YEAR>
                        </CD>
                        <CD>
                            <TITLE>Unchain my heart</TITLE>
                            <ARTIST>Joe Cocker</ARTIST>
                            <COUNTRY>USA</COUNTRY>
                            <COMPANY>EMI</COMPANY>
                            <PRICE>8.20</PRICE>
                            <YEAR>1987</YEAR>
                        </CD>
                        </CATALOG>


-------------------------------------------------------------------------------------------------------------------------------------------


五十八、PHP 实例 - AJAX 实时搜索

      AJAX 可为用户提供更友好、交互性更强的搜索体验。

      1、AJAX Live Search

         在下面的实例中，我们将演示一个实时的搜索，在您键入数据的同时即可得到搜索结果。

         实时的搜索与传统的搜索相比，具有很多优势：

                          当键入数据时，就会显示出匹配的结果

                          当继续键入数据时，对结果进行过滤

                          如果结果太少，删除字符就可以获得更宽的范围


         在下面的文本框中输入 "HTML"，搜索包含 HTML 的页面： 实例--》  http://www.runoob.com/php/php-ajax-livesearch.html

         上面实例中的结果在一个 XML 文件（links.xml）中进行查找。为了让这个例子小而简单，我们只提供 6 个结果。

                 <pages>
                        <link>
                        <title>HTML a 标签</title>
                        <url>http://www.runoob.com/tags/tag-a.html</url>
                        </link>
                        <link>
                        <title>HTML br 标签</title>
                        <url>http://www.runoob.com/tags/tag-br.html</url>
                        </link>
                        <link>
                        <title>CSS background 属性</title>
                        <url>
                        http://www.runoob.com/cssref/css3-pr-background.html
                        </url>
                        </link>
                        <link>
                        <title>CSS border 属性</title>
                        <url>http://www.runoob.com/cssref/pr-border.html</url>
                        </link>
                        <link>
                        <title>JavaScript Date 对象</title>
                        <url>http://www.runoob.com/jsref/jsref-obj-date.html</url>
                        </link>
                        <link>
                        <title>JavaScript Array 对象</title>
                        <url>http://www.runoob.com/jsref/jsref-obj-array.html</url>
                        </link>
                </pages>


      2、实例解释 - HTML 页面

           当用户在上面的输入框中键入字符时，会执行 "showResult()" 函数。该函数由 "onkeyup" 事件触发：

                <html>
                <head>
                <script>
                        function showResult(str)
                        {
                            if (str.length==0)
                            { 
                                document.getElementById("livesearch").innerHTML="";
                                document.getElementById("livesearch").style.border="0px";
                                return;
                            }
                            if (window.XMLHttpRequest)
                            {// IE7+, Firefox, Chrome, Opera, Safari 浏览器执行
                                xmlhttp=new XMLHttpRequest();
                            }
                            else
                            {// IE6, IE5 浏览器执行
                                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                            }
                            xmlhttp.onreadystatechange=function()
                            {
                                if (xmlhttp.readyState==4 && xmlhttp.status==200)
                                {
                                    document.getElementById("livesearch").innerHTML=xmlhttp.responseText;
                                    document.getElementById("livesearch").style.border="1px solid #A5ACB2";
                                }
                            }
                            xmlhttp.open("GET","livesearch.php?q="+str,true);
                            xmlhttp.send();
                        }
                </script>
                </head>
                <body>

                <form>
                <input type="text" size="30" onkeyup="showResult(this.value)">
                <div id="livesearch"></div>
                </form>

                </body>
                </html>

                源代码解释：

                    如果输入框是空的（str.length==0），该函数会清空 livesearch 占位符的内容，并退出该函数。

                     如果输入框不是空的，那么 showResult() 会执行以下步骤：

                                ①、创建 XMLHttpRequest 对象
                                ②、创建在服务器响应就绪时执行的函数
                                ③、向服务器上的文件发送请求
                                ④、请注意添加到 URL 末端的参数（q）（包含输入框的内容）


      3、PHP 文件

           上面这段通过 JavaScript 调用的服务器页面是名为 "livesearch.php" 的 PHP 文件。

           "livesearch.php" 中的源代码会搜索 XML 文件中匹配搜索字符串的标题，并返回结果：

                        <?php
                        $xmlDoc=new DOMDocument();
                        $xmlDoc->load("links.xml");

                        $x=$xmlDoc->getElementsByTagName('link');

                        // 从 URL 中获取参数 q 的值
                        $q=$_GET["q"];

                        // 如果 q 参数存在则从 xml 文件中查找数据
                        if (strlen($q)>0)
                        {
                            $hint="";
                            for($i=0; $i<($x->length); $i++)
                            {
                                $y=$x->item($i)->getElementsByTagName('title');
                                $z=$x->item($i)->getElementsByTagName('url');
                                if ($y->item(0)->nodeType==1)
                                {
                                    // 找到匹配搜索的链接
                                    if (stristr($y->item(0)->childNodes->item(0)->nodeValue,$q))
                                    {
                                        if ($hint=="")
                                        {
                                            $hint="<a href='" . 
                                            $z->item(0)->childNodes->item(0)->nodeValue . 
                                            "' target='_blank'>" . 
                                            $y->item(0)->childNodes->item(0)->nodeValue . "</a>";
                                        }
                                        else
                                        {
                                            $hint=$hint . "<br /><a href='" . 
                                            $z->item(0)->childNodes->item(0)->nodeValue . 
                                            "' target='_blank'>" . 
                                            $y->item(0)->childNodes->item(0)->nodeValue . "</a>";
                                        }
                                    }
                                }
                            }
                        }

                        // 如果没找到则返回 "no suggestion"
                        if ($hint=="")
                        {
                            $response="no suggestion";
                        }
                        else
                        {
                            $response=$hint;
                        }

                        // 输出结果
                        echo $response;
                        ?>


           如果 JavaScript 发送了任何文本（即 strlen($q) > 0），则会发生：

                                     ①、加载 XML 文件到新的 XML DOM 对象

                                     ②、遍历所有的 <title> 元素，以便找到匹配 JavaScript 所传文本

                                     ③、在 "$response" 变量中设置正确的 URL 和标题。如果找到多于一个匹配，所有的匹配都会添加到变量。

                                     ④、如果没有找到匹配，则把 $response 变量设置为 "no suggestion"。


            额外知识：

              1、 PHP stristr() 函数

                 （1）、实例
                          查找 "world" 在 "Hello world!" 中的第一次出现，并返回字符串的剩余部分：

                                            <?php
                                                     echo stristr("Hello world!","WORLD");
                                            ?>

                                运行结果：   world!

                 （2）、定义和用法

                              stristr() 函数搜索字符串在另一字符串中的第一次出现。

                              注释：该函数是二进制安全的。

                              注释：该函数是不区分大小写的。如需进行区分大小写的搜索，请使用 strstr() 函数。


                 （3）、语法

                              stristr(string,search,before_search)

                    参数                         描述

                    string                       必需。规定被搜索的字符串。

                    search                       必需。规定要搜索的字符串。
                                                 如果该参数是数字，则搜索匹配该数字对应的 ASCII 值的字符。

                    before_search                可选。默认值为 "false" 的布尔值。
                                                 如果设置为 "true"，它将返回 search 参数第一次出现之前的字符串部分。



              2、 PHP substr() 函数

                 （1）、实例

                        从字符串中返回 "world"：

                                 <?php
                                       echo substr("Hello world",6);
                                 ?>

                                        运行结果：   world

                 （2）、定义和用法

                        substr() 函数返回字符串的一部分。

                        注释：如果 start 参数是负数且 length 小于或等于 start，则 length 为 0。


                 （3）、语法

                             substr(string,start,length)


                        参数                描述

                        string              必需。规定要返回其中一部分的字符串。

                        start               必需。规定在字符串的何处开始。
                                                     正数 - 在字符串的指定位置开始
                                                     负数 - 在从字符串结尾开始的指定位置开始
                                                      0 - 在字符串中的第一个字符处开始

                        length              可选。规定被返回字符串的长度。默认是直到字符串的结尾。
                                                     正数 - 从 start 参数所在的位置返回的长度
                                                     负数 - 从字符串末端返回的长度


                       实例：
                            <!DOCTYPE html>
                            <html>
                            <body>

                                <?php
                                        echo substr("Hello world",10)."<br>";
                                        echo substr("Hello world",1)."<br>";
                                        echo substr("Hello world",3)."<br>";
                                        echo substr("Hello world",7)."<br><br>";

                                        echo substr("Hello world",-1)."<br>";
                                        echo substr("Hello world",-10)."<br>";
                                        echo substr("Hello world",-8)."<br>";
                                        echo substr("Hello world",-4)."<br>";
                                ?>
                              
                            </body>
                            </html>

                            运行结果：
                                       d
                                       ello world
                                       lo world
                                       orld

                                       d
                                       ello world
                                       lo world
                                       orld



-------------------------------------------------------------------------------------------------------------------------------------------


五十九、PHP 实例 - AJAX RSS 阅读器

          RSS 阅读器用于阅读 RSS Feed。

         1、AJAX RSS 阅读器

              在下面的实例中，我们将演示一个 RSS 阅读器，通过它，来自 RSS 的内容在网页不进行刷新的情况下被载入：

                        实例地址：  http://www.runoob.com/php/php-ajax-rss-reader.html


         2、实例解释 - HTML 页面

              当用户在上面的下拉列表中选择某个 RSS-feed 时，会执行名为 "showRSS()" 的函数。该函数由 "onchange" 事件触发：

                            <html>
                            <head>
                            <meta charset="utf-8">
                            <title>菜鸟教程(runoob.com)</title>
                            <script>
                            function showRSS(str)
                            {
                                if (str.length==0)
                                { 
                                    document.getElementById("rssOutput").innerHTML="";
                                    return;
                                    }
                                if (window.XMLHttpRequest)
                                {
                                    // IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
                                    xmlhttp=new XMLHttpRequest();
                                }
                                else
                                {
                                    // IE6, IE5 浏览器执行代码
                                    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                                }
                                xmlhttp.onreadystatechange=function()
                                {
                                    if (xmlhttp.readyState==4 && xmlhttp.status==200)
                                    {
                                        document.getElementById("rssOutput").innerHTML=xmlhttp.responseText;
                                    }
                                }
                                xmlhttp.open("GET","getrss.php?q="+str,true);
                                xmlhttp.send();
                            }
                            </script>
                            </head>
                            <body>
                             
                            <form>
                            <select onchange="showRSS(this.value)">
                              <option value="">选择一个 RSS-feed:</option>
                              <option value="rss">读取 RSS 数据</option>
                            </select>
                            </form>
                            <br>
                            <div id="rssOutput">RSS-feed 数据列表...</div>
                            </body>
                            </html>


                    showRSS() 函数会执行以下步骤：

                            ①、检查是否有 RSS-feed 被选择
                            ②、创建 XMLHttpRequest 对象
                            ③、创建在服务器响应就绪时执行的函数
                            ④、向服务器上的文件发送请求
                            ⑥请注意添加到 URL 末端的参数（q）（包含下拉列表的内容）


         3、PHP 文件

             文件 rss_demo.xml。

                        <rss version="2.0">
                        <channel>
                        <title>菜鸟教程</title>
                        <link>http://www.runoob.com</link>
                        <description>学的不仅技术，更是梦想！！！</description>
                        <item>
                        <title>RSS 教程</title>
                        <link>http://www.runoob.com/rss/rss-tutorial.html</link>
                        <description>通过使用 RSS，您可以有选择地浏览您感兴趣的以及与您的工作相关的新闻。</description>
                        </item>
                        <item>
                        <title>XML 教程</title>
                        <link>http://www.runoob.com/xml/xml-tutorial.html</link>
                        <description>XML 指可扩展标记语言（eXtensible Markup Language）。</description>
                        </item>
                        </channel>
                        </rss>


             上面这段通过 JavaScript 调用的服务器页面是名为 "getrss.php" 的 PHP 文件：

                        <?php
                        // rss 文件
                        $xml="rss_demo.xml";
                         
                        $xmlDoc = new DOMDocument();
                        $xmlDoc->load($xml);
                         
                        // 从 "<channel>" 中读取元素
                        $channel=$xmlDoc->getElementsByTagName('channel')->item(0);
                        $channel_title = $channel->getElementsByTagName('title')
                                                          ->item(0)->childNodes->item(0)->nodeValue;
                        $channel_link = $channel->getElementsByTagName('link')
                                                          ->item(0)->childNodes->item(0)->nodeValue;
                        $channel_desc = $channel->getElementsByTagName('description')
                                                          ->item(0)->childNodes->item(0)->nodeValue;
                         
                        // 输出 "<channel>" 中的元素
                        echo("<p><a href='" . $channel_link
                                                       . "'>" . $channel_title . "</a>");
                        echo("<br>");
                        echo($channel_desc . "</p>");
                         
                        // 输出 "<item>" 中的元素
                        $x=$xmlDoc->getElementsByTagName('item');

                        for ($i=0; $i<=1; $i++) {

                            $item_title=$x->item($i)->getElementsByTagName('title')
                                                                              ->item(0)->childNodes->item(0)->nodeValue;

                            $item_link=$x->item($i)->getElementsByTagName('link')
                                                                              ->item(0)->childNodes->item(0)->nodeValue;

                            $item_desc=$x->item($i)->getElementsByTagName('description')
                                                                              ->item(0)->childNodes->item(0)->nodeValue;

                            echo ("<p><a href='" . $item_link
                                                                . "'>" . $item_title . "</a>");

                            echo ("<br>");
                            echo ($item_desc . "</p>");
                        }
                        ?>

                        当 RSS feed 的请求从 JavaScript 发送到 PHP 文件时，将发生：

                                        ①、检查哪个 RSS feed 被选中
                                        ②、创建一个新的 XML DOM 对象
                                        ③、在 xml 变量中加载 RSS 文档
                                        ④从 channel 元素中提取并输出元素
                                        ⑤、从 item 元素中提取并输出元素



-------------------------------------------------------------------------------------------------------------------------------------------


六十、PHP 实例 - AJAX 投票

      1、AJAX 投票

         在下面的实例中，我们将演示一个投票程序，通过它，投票结果在网页不进行刷新的情况下被显示。

              实例地址：http://www.runoob.com/php/php-ajax-poll.html


      2、实例解释 - HTML 页面

              当用户选择上面的某个选项时，会执行名为 "getVote()" 的函数。该函数由 "onclick" 事件触发。

              poll.html 文件代码如下：

                        <html>
                        <head>
                        <meta charset="utf-8">
                        <title>菜鸟教程(runoob.com)</title>
                        <script>
                        function getVote(int) {

                          if (window.XMLHttpRequest) {

                            // IE7+, Firefox, Chrome, Opera, Safari 执行代码
                            xmlhttp=new XMLHttpRequest();

                          } else {

                            // IE6, IE5 执行代码
                            xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

                          }
                          xmlhttp.onreadystatechange=function() {

                          if (xmlhttp.readyState==4 && xmlhttp.status==200)
                            {
                              document.getElementById("poll").innerHTML=xmlhttp.responseText;
                            }
                          }

                          xmlhttp.open("GET","poll_vote.php?vote="+int,true);
                          xmlhttp.send();
                        }
                        </script>
                        </head>
                        <body>

                        <div id="poll">
                        <h3>你喜欢 PHP 和 AJAX 吗?</h3>
                        <form>
                        是:
                        <input type="radio" name="vote" value="0" onclick="getVote(this.value)">
                        <br>否:
                        <input type="radio" name="vote" value="1" onclick="getVote(this.value)">
                        </form>
                        </div>

                        </body>
                        </html>


                 getVote() 函数会执行以下步骤：

                        ①、创建 XMLHttpRequest 对象
                        ②、创建在服务器响应就绪时执行的函数
                        ③、向服务器上的文件发送请求
                        ④、请注意添加到 URL 末端的参数（q）（包含下拉列表的内容）



      3、PHP 文件

          上面这段通过 JavaScript 调用的服务器页面是名为 "poll_vote.php" 的 PHP 文件：

                    <?php
                            $vote = htmlspecialchars($_REQUEST['vote']);

                            // 获取文件中存储的数据
                            $filename = "poll_result.txt";
                            $content = file($filename);

                            // 将数据分割到数组中
                            $array = explode("||", $content[0]);
                            $yes = $array[0];
                            $no = $array[1];

                            if ($vote == 0)
                            {
                              $yes = $yes + 1;
                            }

                            if ($vote == 1)
                            {
                              $no = $no + 1;
                            }

                            // 插入投票数据
                            $insertvote = $yes."||".$no;
                            $fp = fopen($filename,"w");
                            fputs($fp,$insertvote);
                            fclose($fp);
                    ?>

                    <h2>结果:</h2>
                    <table>
                      <tr>
                      <td>是:</td>
                      <td>
                      <span style="display: inline-block; background-color:green;
                          width:<?php echo(100*round($yes/($no+$yes),2)); ?>px;
                          height:20px;" ></span>
                      <?php echo(100*round($yes/($no+$yes),2)); ?>%
                      </td>
                      </tr>
                      <tr>
                      <td>否:</td>
                      <td>
                      <span style="display: inline-block; background-color:red;
                          width:<?php echo(100*round($no/($no+$yes),2)); ?>px;
                          height:20px;"></span>
                      <?php echo(100*round($no/($no+$yes),2)); ?>%
                      </td>
                      </tr>
                    </table>

               当所选的值从 JavaScript 发送到 PHP 文件时，将发生：

                                   ①、获取 "poll_result.txt" 文件的内容
                                   ②、把文件内容放入变量，并向被选变量累加 1
                                   ③、把结果写入 "poll_result.txt" 文件
                                   ④、输出图形化的投票结果



      4、文本文件

             文本文件（poll_result.txt）中存储来自投票程序的数据。

                        它存储的数据如下所示：
                                               3||4

                        第一个数字表示 "Yes" 的投票数，第二个数字表示 "No" 的投票数。

                        注释：请记得只允许您的 Web 服务器来编辑该文本文件。不要让其他人获得访问权，除了 Web 服务器 (PHP)。


       5、注意

             这很不安全！攻击者能用简短的代码攻破！

             //无限循环脚本
                       var Vote = 0;//你的票。
                       setInterval(function(){

                           getVote(Vote);

                       },2000);


             怎样更安全？可以用 Cookies 记录下投票，这样攻击者还需清理 Cookies。

                        if(empty($_COOKIE["voted"])) {
                                setcookie("voted","yes!",ime()+60*60*24*365);
                         } else {
                               die("您已经投过票！");
                         }









































